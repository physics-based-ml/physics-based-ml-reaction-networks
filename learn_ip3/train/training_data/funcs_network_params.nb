(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    255405,       6325]
NotebookOptionsPosition[    235050,       5969]
NotebookOutlinePosition[    235509,       5987]
CellTagsIndexPosition[    235466,       5984]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Fourier", "Title",
 CellChangeTimes->{{3.825784351342326*^9, 
  3.8257843649529057`*^9}},ExpressionUUID->"2fc3b0a5-ef81-48e0-ad46-\
2bca4dac5358"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeFourierGraph", "[", 
   RowBox[{
   "freqs_", ",", "sinCoeffsInit_", ",", "cosCoeffsInit_", ",", 
    "offsetFixed_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nFourier", ",", "layerDefns", ",", "layerConn", ",", "graph"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nFourier", "=", 
      RowBox[{"Length", "[", "freqs", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nFourier", "\[NotEqual]", "0"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"layerDefns", "=", 
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "Offset", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<offset\>\"", "\[Rule]", 
            RowBox[{"NetArrayLayer", "[", 
             RowBox[{
              RowBox[{"\"\<Output\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<Array\>\"", "\[Rule]", "offsetFixed"}], ",", 
              RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Freqs", ",", " ", "coeffs"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<cosCoeff\>\"", "\[Rule]", 
            RowBox[{"NetArrayLayer", "[", 
             RowBox[{
              RowBox[{"\"\<Output\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"\"\<Array\>\"", "\[Rule]", "cosCoeffsInit"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<sinCoeff\>\"", "\[Rule]", 
            RowBox[{"NetArrayLayer", "[", 
             RowBox[{
              RowBox[{"\"\<Output\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"\"\<Array\>\"", "\[Rule]", "sinCoeffsInit"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<freqs\>\"", "->", 
            RowBox[{"NetArrayLayer", "[", 
             RowBox[{
              RowBox[{"\"\<Output\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}], ",", 
              RowBox[{"\"\<Array\>\"", "\[Rule]", "freqs"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Norm", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"\"\<range\>\"", "\[Rule]", 
            RowBox[{"FunctionLayer", "[", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"Abs", "[", "#sinCoeff", "]"}], "]"}], "+", 
                 RowBox[{"Total", "[", 
                  RowBox[{"Abs", "[", "#cosCoeff", "]"}], "]"}], "+", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "8"}]]}]}], "]"}], "&"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "FT", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"\"\<ft\>\"", "->", 
            RowBox[{"FunctionLayer", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#offset", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Total", "[", 
                    RowBox[{"#sinCoeff", "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#tpt", "-", "1"}], ")"}], "*", "#freqs"}], 
                    "]"}]}], "]"}], "+", 
                   RowBox[{"Total", "[", 
                    RowBox[{"#cosCoeff", "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#tpt", "-", "1"}], ")"}], "*", "#freqs"}], 
                    "]"}]}], "]"}]}], ")"}], "/", "#range"}]}], "&"}], ",", 
              RowBox[{"\"\<tpt\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<freqs\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"\"\<sinCoeff\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"\"\<cosCoeff\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"\"\<offset\>\"", "\[Rule]", "1"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<ftFlatten\>\"", "\[Rule]", 
            RowBox[{"PartLayer", "[", "1", "]"}]}]}], "\[IndentingNewLine]", 
          "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"layerConn", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "Offset", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<offset\>\"", "->", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<ft\>\"", ",", "\"\<offset\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Norm", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"\"\<sinCoeff\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<range\>\"", ",", "\"\<sinCoeff\>\""}], "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<cosCoeff\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<range\>\"", ",", "\"\<cosCoeff\>\""}], "]"}]}], ",",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Remaining", " ", "FT"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<freqs\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<ft\>\"", ",", "\"\<freqs\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<sinCoeff\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<ft\>\"", ",", "\"\<sinCoeff\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<cosCoeff\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<ft\>\"", ",", "\"\<cosCoeff\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<range\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<ft\>\"", ",", "\"\<range\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<ft\>\"", "->", "\"\<ftFlatten\>\""}]}], 
          "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"layerDefns", "=", 
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "Offset", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<offset\>\"", "\[Rule]", 
            RowBox[{"NetArrayLayer", "[", 
             RowBox[{
              RowBox[{"\"\<Output\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<Array\>\"", "\[Rule]", "offsetFixed"}], ",", 
              RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<ftFlatten\>\"", "\[Rule]", 
            RowBox[{"PartLayer", "[", "1", "]"}]}]}], "\[IndentingNewLine]", 
          "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"layerConn", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "Offset", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\"\<offset\>\"", "->", "\"\<ftFlatten\>\""}], 
          "\[IndentingNewLine]", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "graph", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzk0og3EAx/EHw0FymJeW1DYshJiZUSbJaw4sj1KUnllbslYezVpWWytp
IVPeox7DYS2aMs0KLQeXLTmhlUw5aEkOJK//33P49rl+JYxJo0umKCqfBLVM
VsebPdGs/FjpgQNXQho+hCt4D5/zCt+Jg8I53obcaPUXMdXI1cD077QWOMhO
t8PTifsdGFcX7MLM1Yymb2JMf9cGz0r2aXi+19kPR5KYKegztNrg4/Ur9Uv0
ao+yodP6I4FiT50UhtoiMsj6TsphmZ6rh7UKUyP0D112wIAjRQeF9gcDlM0H
jXDrpYiFjEphhnOzY/dCB/kZlcehtPfzCapdiy+wNBYezyamLh+YYSC0bYXi
8p5NaDsd5qDvYtILo0HBMXT5O0MwsaaMwKpKC28XPcPmELmbYgvUqERu+NfU
zbsgFXUvEd1eug/Kbz3rYaLA4tyA/wwB43M=
  "],
 CellLabel->"In[1]:=",ExpressionUUID->"32543105-d66a-47bc-a629-e0f4a372c52c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"minMax", "[", 
    RowBox[{"x_", ",", "nFourier_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1.0"}], "/", "nFourier"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"1.0", "/", "nFourier"}], ",", "#"}], "]"}]}], "]"}], "&"}],
      ",", "x"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825701156473464*^9, 3.8257011666154757`*^9}, {
  3.825701217058936*^9, 3.825701228851843*^9}, {3.8257198003233843`*^9, 
  3.825719812820507*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"37fb00f8-9dd3-42e3-96b5-c9b0ff2c57e1"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798093301413*^9, 
  3.830798093565435*^9}},ExpressionUUID->"51374f05-a29a-42f7-8f3f-\
15a3f5d8d6f7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"freqsTest", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sinCoeffsInit", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.008"}], ",", "0.03", ",", "0.02", ",", "0.01"}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cosCoeffsInit", "=", 
   RowBox[{"{", 
    RowBox[{"0.001", ",", "0.05", ",", "0.001", ",", "0.005"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"offsetFixed", "=", 
    RowBox[{"{", "1.0", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graph", "=", 
   RowBox[{"makeFourierGraph", "[", 
    RowBox[{
    "freqsTest", ",", "sinCoeffsInit", ",", "cosCoeffsInit", ",", 
     "offsetFixed"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.82570147183919*^9, 3.825701474524246*^9}, {
   3.825701513921007*^9, 3.825701520454009*^9}, {3.8257015609161367`*^9, 
   3.8257015662287197`*^9}, {3.825719979268244*^9, 3.825719983970439*^9}, {
   3.8257219934585037`*^9, 3.8257219951394787`*^9}, {3.8257222178877983`*^9, 
   3.825722218013771*^9}, {3.825722402304886*^9, 3.825722409471209*^9}, {
   3.825770370300054*^9, 3.825770374372892*^9}, {3.825773891627768*^9, 
   3.8257738952793093`*^9}, {3.82603537572339*^9, 3.826035386285133*^9}, {
   3.826128031391354*^9, 3.826128058006873*^9}, 
   3.830798091576511*^9},ExpressionUUID->"bd9e0421-5680-4e96-9edd-\
837bebda45bf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tptsPlt", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"tpt", ",", 
      RowBox[{"{", 
       RowBox[{"tpt", ",", "1", ",", "20", ",", "0.1"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"range", "=", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"Abs", "[", "sinCoeffsInit", "]"}], "+", 
     RowBox[{"Abs", "[", "cosCoeffsInit", "]"}]}], "]"}], "+", 
   SuperscriptBox["10", 
    RowBox[{"-", "8"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"graph", "[", 
       RowBox[{"<|", 
        RowBox[{"\"\<tpt\>\"", "\[Rule]", 
         RowBox[{"{", "tpt", "}"}]}], "|>"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"tpt", ",", "tptsPlt"}], "}"}]}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"offsetFixed", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"sinCoeffsInit", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"freqsTest", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"tpt", "-", "1"}], ")"}]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"cosCoeffsInit", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"freqsTest", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"tpt", "-", "1"}], ")"}]}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "freqsTest", "]"}]}], "}"}]}], "]"}], 
          ")"}], "/", 
         RowBox[{"Max", "[", 
          RowBox[{"range", ",", "1"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"tpt", ",", "tptsPlt"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8256987329661617`*^9, 3.825698769608322*^9}, {
   3.8256988037422943`*^9, 3.82569890346896*^9}, {3.8256991837870007`*^9, 
   3.825699238262608*^9}, {3.825700896775607*^9, 3.8257009066120358`*^9}, {
   3.825701173927011*^9, 3.8257011766276608`*^9}, {3.825701248387903*^9, 
   3.825701285832068*^9}, {3.825701526050044*^9, 3.8257015303340263`*^9}, {
   3.825719992366947*^9, 3.825720005643208*^9}, 3.825720188552627*^9, {
   3.825722044117709*^9, 3.8257220441753893`*^9}, {3.825722124761979*^9, 
   3.825722127506064*^9}, {3.825722176836282*^9, 3.825722197180091*^9}, {
   3.825722389531507*^9, 3.825722392879611*^9}, {3.825725829319957*^9, 
   3.825725877331506*^9}, {3.825726405139352*^9, 3.825726428857703*^9}, {
   3.825726655571878*^9, 3.82572666650074*^9}, {3.825726740135416*^9, 
   3.825726772624181*^9}, {3.825770388941527*^9, 3.825770410800531*^9}, {
   3.825772044619223*^9, 3.825772096553166*^9}, {3.825772134134837*^9, 
   3.825772134337418*^9}, {3.825773519779071*^9, 3.8257735261238203`*^9}, {
   3.825773748733412*^9, 3.825773750169256*^9}, {3.825773898709672*^9, 
   3.8257739011981297`*^9}, {3.8260354228152113`*^9, 3.826035425194265*^9}, {
   3.8261280142749643`*^9, 3.8261280261451273`*^9}},
 CellLabel->
  "In[1334]:=",ExpressionUUID->"8aaca3fa-4328-40a3-a24d-75c36d828599"],

Cell[BoxData["0.12500001`"], "Output",
 CellChangeTimes->{{3.8256987442118073`*^9, 3.825698769891698*^9}, {
   3.825698873236226*^9, 3.8256989037323627`*^9}, {3.825699196519393*^9, 
   3.825699238528603*^9}, {3.825700894098958*^9, 3.825700907236125*^9}, 
   3.825701145369342*^9, 3.8257011769365892`*^9, {3.8257012394942636`*^9, 
   3.8257012553971863`*^9}, 3.825701286232163*^9, {3.825701531194215*^9, 
   3.825701567529331*^9}, {3.825719993268552*^9, 3.825720032048357*^9}, 
   3.8257201888488913`*^9, {3.82572198393953*^9, 3.825721996355691*^9}, 
   3.825722044550745*^9, 3.825722129884944*^9, {3.825722174127101*^9, 
   3.825722220465081*^9}, {3.825722393610094*^9, 3.825722410313593*^9}, 
   3.825725817840096*^9, {3.825725862786921*^9, 3.825725880993181*^9}, 
   3.825725936473981*^9, 3.825726397256732*^9, 3.825726429243436*^9, {
   3.825726656199533*^9, 3.825726666776093*^9}, 3.8257268221772738`*^9, {
   3.825770377881549*^9, 3.8257704113974113`*^9}, 3.8257720183609257`*^9, {
   3.82577208629335*^9, 3.825772096893199*^9}, 3.825772144494507*^9, {
   3.825773513126109*^9, 3.825773526836632*^9}, {3.825773750748349*^9, 
   3.82577375682377*^9}, 3.8257739015296793`*^9, 3.82603542555968*^9, {
   3.826128020226532*^9, 3.8261280593871727`*^9}, 3.826128105987904*^9},
 CellLabel->
  "Out[1335]=",ExpressionUUID->"e8f15ee3-3a4b-4a54-9a13-caa63b15f929"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, {}, 
     {RGBColor[0.9, 0.36, 0.054], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      CapForm["Butt"], 
      StyleBox[LineBox[CompressedData["
1:eJw91gtMllUYB/C3kjLdzDUyXbZOlt8wqRmfZnH7DiCC8JGA3EF6oU8bZvdw
umB7F4s01jJGArLoBfaZrtKSabnVPKtNulCr0WWtoNMGRctrt3VhM9//OX/Y
lP32PM95zjnv+7x6c+MjpVsudxzn5KU/wW/zcz5y6S+98xf8Dn5k4BM3XrCe
G9g5mEMvDOwmV9GJyM+rphcHVpH19FLkD99Ei8D+vp/Zbxnqrx2gb0X9xmI6
hP4lf5yzTkL+gTz6tsAyIX7WOjmwN38RfQfqpwfPWK8KLD4uoe9EvDVEp2D9
8DI6jPV359Crkf9GO70G+aNT9F043wvV7L8W8ePf0ncjfmoz938P1nttnE5F
v9AKnj8N9zGnlk7Hem1P0xnIP9xPZ2L9tiN0BPn6GC2xXvmwtWd85hDjWbi/
832Mw9rvYDwb/S57inHYHXiQ8Rz0b6ln3Hh6E+PrsF5PIeOwHF7HeC7282cG
47A3vYbx9YgnrmQc1plLGc9Dfu9cxmE58QPvNz+wsyNu7cGyIcb4BtTXC8Zh
P3uCz68A5+0esvZgKXYwXoj9FdcyDsuTlYxHsX78YcZh3TzAeBHWf+kc47CX
WcH93Yv9d37O/cHiNO/D2Qj/9RjPD6vJ2edfjH5LfreWsAovt/PpwX4s31qZ
fDU73yU4T2ultYTdxVmsh53t17PeeOh79i9Fv+u62B8WC7O5X+OEb+z5FCzL
VvL8m9CvrsPej4TVcw7vy1h12nlUJn80j/NZhvj8W6wl7Mrl1h7s9ERZb/Kn
ulhfjvi8v1kPu7tmn6eJaz4/ZfzhE9x/BfIzfrOWsL8qhec38e2N1goWC3bz
/ioRLxjk/cEi/y3WwyrhOOthmXyU9VWBva9eZT2sor2sh93P2E/BIrqT9dVY
L9LEeth7to71sF9fynrYrS9gfQ3W68lhPSzfS2c9rEpWs97kTyWxvhbxgiWs
h/3ROayH3cGv+f7Aemo/778O+72qmvcP638SOU+w//YYnx8sJ/ZzPjejf/Kj
fP9g978qPn9YH+b3X5l4ajPr63Ged19nPazSL7Ie9nubuH/Y6f+J+78P8QNr
eX5YHmzl+WE1onh/Jr5thvfnYr2sZDufAvZeiXKejU/VWLuwEOWcb9iPpVn7
rum/gPNu8gu/sP206fdlO/s34D6OhK0FrD44wecB64prrF2TX/Q47wf2x3+1
8+fDTncb59XEJzOttVn/mOD8NiK/doW1gEV3BecZ1j8OWbuwHJvH/rB/tM3a
N/U3XMnnBSt/j7U2/dKu4Pnvx/3+m8rzw7p9dp5gmfu8tWvyu+J8vrDzPufZ
N/mn+X1XsD/2Ju/frN/PeieG/L597A87M8+wv/FgM/vD7tmt7G/q4zXsD3uT
/P+aMvW3b2B/2G/h993ZgvpdaewPizi/fxJ2ukPsbxxexP4m/zuH/U089Cnv
H9ZJe3n/sPdyEednK/IPXW0tYK/pI86jcUentWvyR7bx+cOyjP+e+7BuqOO8
m/y+FmsNuyPvcP4fCKxe5PstYNnSyvcfdi/O8P038Yf4vfRgnbuH54fFk5/w
/mEvlmDnUZt+4ykXIv8DwNqY8Q==
        "]],
       FontSize->24]}}, {{}, {}}}, {{}, {{}, {}, 
     {GrayLevel[0.5], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      Dashing[{Small, Small}], CapForm["Butt"], 
      StyleBox[LineBox[CompressedData["
1:eJw9lgs01Hkbx6nYrd5seUsr7WvWxtJaWbS5+7rkLnfGbYyZMXOUvCpaFrF5
U2JTjnu77aSdXFY2pWJtmW035JZct9wmsWmlRdFG8fae9//knDnOZ77ne57f
8zy/748Pef/2Cl8mJydX/+bzv9///5myuvrsdXfc4ykr5gvIlxU/qv1gmuF3
8WVJ1GyJLfFa6GVVcXXZxOuR5Ro/6BBA/D7Cu4bbreyJN4P3fVfkZXViFkzq
/nE+7xHV00Dosg/7lc8Sb8HH7LZadw9iLURU5M16PP+LYW0od/g3n3cg3goj
01hjBclThnXxx4uRE6tViPXQ0h6jMl48ybA+8tVY6s2exJ8huK9fKUmL2ADn
TEsGDDWIDXFzxXdux2yJjXBuy8xcRRrxdkzc7+xpHSP+HEZxxUVZAVR/B1LE
McNX7xEbg/XDVFlDCJ3fBIqV3c/KB4lNwZ846KClQ/2bYdbmPemKIGJzHBqv
uZ96mNgCJT1i68ozxJaoquj4PvVHYivEHFrVI7tCDGx2m6jxvcxwCiC/u/vn
yTLSraG6qTt+6jTp1vjs4WGZOIN0G7xumdGTTyDdBi/KEzln95Bui/LCxbxE
Dum2uPHPExXj3qTb4XDH9eECF9LtIA1KMLhsR/pOXGmOvjtrQfpOrFu9Knl8
O+n2ENeq1a//hHR7tP3e1G25mXQHHMgcOVr4LukOmMpXtBgapvk6opnVOhUr
YTjFEaWXTNhhAtKd4BQ3fIrDIt0JqZzpbJsh2p8zeuJvueSfYzjlDVdnOLIO
ku6CXiWVyx5BpLugtSHPud6fdFeMYfqAJIp0V+jlaspiz5LuBhXbqvjcv0h3
A+/alwmWfnS+XegdOS6f3UHn24X8p9l6T2gecu442fXb1rl91L876jXt746+
3b8HjF991af6jGF44J3FtgpDTSafKR4QXucWChwZlnqgpunvQenbfHtiS62+
SZI/w/DEN+NH9r5vTX5PmJgfUo7cSH5PTGqnLRUPUH0vRO153LIhh+p7offE
3RVrbei8XihRsvJS6GP6k3phm6fqOp9PqH9vPP9iOjA4g5kPvKGsmttxXI7m
5Y17rJvXpdlMHqXeSNxtxGl1oHz6oMRLvWT1RwzDB62HvNnQZDjFB03yBTP5
ruT3gY4kc2Ash/y+aPcTD6z8m/y+qE53j4t/u09flFbsWCOj/Ul90af1aWfj
ATq/H9okdskWMwzDD+YTz3P0Dah/P9Tsm9sTyWNY6odi2aYPlI7R/Pxx5z9b
PJyLaX7+yC033eRYRX5/DJzNblK4Sn5/NPnsMdS9RH422I6C/T0l5GfjRv1M
h2sh+dlYFpwT0E71pGxEW63c5hpH/gAYPv3N2CqC/AGw/+mbmKPB5A+At7as
lONF/gBkDjWGcJzJH4gumZV6gS35A5E2W21x3Zz8gbjo5CD1NCJ/II6rnWGN
aZM/CBsX7nQ6q5I/COftEgpaV5A/CF0Z9UHFvXR/gtDxp/3EWBHNPxhD2da5
7wTQ/IORt3C69+V6ylMwbkaI6q510f6CsWw2cO1QEeUzBFzv13W60XT/QrCt
tj55gU37D0G7T/9IJb3/0hCoXnThm8aSn4MN5ZP6P1eQn4Osxf115kvk52BS
/4aoMILOz4FbFmfDmT/o/KFwjLlw5PwO6j8U22+sE5QmUf+heGC7v7pRSvML
hWDxgvruVzQ/LhaVTspb6zL5ZHGxpqk09TtXyjMXS/NDmQ2BDHO56NRW3cDy
pXy/8Y9O1wjMGBZzkdz3QKdUifLOhUz/mKbLXaaejIv6osq2rjSqH4a918wC
fzRkmBUGczObpV9raR9hcOhqqfN7j2FuGGaHOAlu+2k+YXgUIo0YnGDyJw5D
VPzKl3mplNcw3LdRKh+1ZFgWhn91X/nlCovyy8PEbcflQToMs3iYHkn3zvej
PPOwJD/Q8+Acw1we4sqjlnetovo8KL7svnUplWExDxfW/LlGTZH2xUNDluET
cTrDMh7UNbYvmC6n/vkQOszz502pfz6k3rsa097miY/5WwteO79mmMvHhRzL
pBwJ7ZcP5Rd7X/5CeRbzwa967vyE3ncpH1GOqYVdF2n+fCw1SLrPkF9OgMmC
pY9O51F9ATKcteVeHaH6AqT+tG9jcSzVF0BvYxL7qZDqC6DmZPO5JJDqC7Dr
K1buKP2/JhXgma/+nK4T1RfgiwHJqUR63+XCEekocY83o/rhMPjBaJOE3j+E
I0ia/jpPi+qHY9VBHSVDFaofjplqBY1+OaofjrVbCzS02mj+4bjNkdRpn6T5
h6M5s4z/rRvlR4i0e9FzpSsZZgmh3/RtWcRtyqMQQwuPjmdkM8wV4uGd+ocN
u2n/QgiapSo+9PdcLER0pdNgWDDlXYja5JyZokSGZULM9WfoNdZQ/kVwU2x7
fIruN0uE1qO6kYlJdP9FGO1cLlh6RfdfhPnNQs299F6miFCe+fjXnenUvwiy
9q+NY1po/iJ4Zt4rFSgweZSJ8PG1Yx2DBtNW/wVAd+Me
        "]],
       FontSize->24]}}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0.9005529681841535},
  BaseStyle->{FontSize -> 24},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{{0}, {0}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->400,
  LabelStyle->{FontFamily -> "Times"},
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->All,
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8256987442118073`*^9, 3.825698769891698*^9}, {
   3.825698873236226*^9, 3.8256989037323627`*^9}, {3.825699196519393*^9, 
   3.825699238528603*^9}, {3.825700894098958*^9, 3.825700907236125*^9}, 
   3.825701145369342*^9, 3.8257011769365892`*^9, {3.8257012394942636`*^9, 
   3.8257012553971863`*^9}, 3.825701286232163*^9, {3.825701531194215*^9, 
   3.825701567529331*^9}, {3.825719993268552*^9, 3.825720032048357*^9}, 
   3.8257201888488913`*^9, {3.82572198393953*^9, 3.825721996355691*^9}, 
   3.825722044550745*^9, 3.825722129884944*^9, {3.825722174127101*^9, 
   3.825722220465081*^9}, {3.825722393610094*^9, 3.825722410313593*^9}, 
   3.825725817840096*^9, {3.825725862786921*^9, 3.825725880993181*^9}, 
   3.825725936473981*^9, 3.825726397256732*^9, 3.825726429243436*^9, {
   3.825726656199533*^9, 3.825726666776093*^9}, 3.8257268221772738`*^9, {
   3.825770377881549*^9, 3.8257704113974113`*^9}, 3.8257720183609257`*^9, {
   3.82577208629335*^9, 3.825772096893199*^9}, 3.825772144494507*^9, {
   3.825773513126109*^9, 3.825773526836632*^9}, {3.825773750748349*^9, 
   3.82577375682377*^9}, 3.8257739015296793`*^9, 3.82603542555968*^9, {
   3.826128020226532*^9, 3.8261280593871727`*^9}, 3.826128106104476*^9},
 CellLabel->
  "Out[1336]=",ExpressionUUID->"bba918a8-8035-4bb0-8dd3-a2eac9d8f69c"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Inverse", "Title",
 CellChangeTimes->{{3.825702835048008*^9, 3.825702835367131*^9}, {
  3.825784369245984*^9, 
  3.825784370147066*^9}},ExpressionUUID->"46f1c9ea-80e8-46a1-860d-\
8b88772d3017"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"inverse1Layer", "[", "]"}], ":=", 
   RowBox[{"FunctionLayer", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["#", 
       RowBox[{"-", "1"}]], "&"}], ",", 
     RowBox[{"\"\<Input\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825703748462631*^9, 3.8257037774693317`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"e76b5b0d-5409-4430-a898-210c268a4eb1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"inverse2Layer", "[", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerConn", ",", "layerDefns"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<denom\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"#mat", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "*", 
              RowBox[{"#mat", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"#mat", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", 
              RowBox[{"#mat", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "2"}], "]"}], "]"}]}]}], "&"}], ",", 
           RowBox[{"\"\<mat\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<inverse\>\"", "->", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"#mat", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "2"}], "]"}], "]"}], "/", "#denom"}], 
                ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"#mat", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "/", 
                 "#denom"}]}], "}"}], ",", "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"#mat", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "/", "#denom"}], 
                ",", 
                RowBox[{
                 RowBox[{"#mat", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "/", "#denom"}]}], 
               "}"}]}], "\[IndentingNewLine]", "}"}], "&"}], ",", 
           RowBox[{"\"\<mat\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<denom\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<inverse\>\"", ",", "\"\<denom\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825703748462631*^9, 3.825703911909864*^9}, {
  3.825703946027437*^9, 3.825704104023498*^9}, {3.8257041776948023`*^9, 
  3.825704197875155*^9}, {3.82570424202286*^9, 3.825704242903153*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"670249c1-759f-4a56-b8c9-e7cc88477bf0"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798098811614*^9, 
  3.830798099166218*^9}},ExpressionUUID->"3f281376-ba3c-4d99-80a0-\
2020fbb7e3c6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"testMat", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4", ",", "5"}], "}"}]}], "}"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inverse2Layer", "[", "]"}], "[", "testMat", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Inverse", "[", "testMat", "]"}]}], "Input",
 CellChangeTimes->{{3.8257040822104816`*^9, 3.8257040836775417`*^9}, {
  3.8257042113344584`*^9, 3.82570423653053*^9}},
 CellLabel->
  "In[452]:=",ExpressionUUID->"b2ae9c8c-9b4f-4790-8cb1-48b228873e24"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7142857313156128`"}], ",", "0.4285714328289032`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5714285969734192`", ",", 
     RowBox[{"-", "0.1428571492433548`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8257040841452312`*^9, {3.825704180553944*^9, 3.825704244530024*^9}},
 CellLabel->
  "Out[453]=",ExpressionUUID->"b3c5e618-8b45-4641-b982-fe2ac1aa8481"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.7142857142857142`"}], ",", "0.42857142857142855`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5714285714285714`", ",", 
     RowBox[{"-", "0.14285714285714285`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8257040841452312`*^9, {3.825704180553944*^9, 3.825704244531431*^9}},
 CellLabel->
  "Out[454]=",ExpressionUUID->"24ffdbda-b494-4391-89e8-0e8b27450d08"]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert params layer", "Title",
 CellChangeTimes->{{3.825704279392277*^9, 
  3.8257042817082033`*^9}},ExpressionUUID->"65ddda7d-81a2-477d-b031-\
9b6318b22c4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convertbLayer", "[", "]"}], ":=", 
  RowBox[{"FunctionLayer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#b1", "+", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", "#wt1", "]"}], ".", "#muh1"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Transpose", "[", "#wt1", "]"}], ".", 
       RowBox[{"Sqrt", "[", "#varh1", "]"}], ".", 
       SuperscriptBox[
        RowBox[{"Sqrt", "[", "#varh2", "]"}], 
        RowBox[{"-", "1"}]], ".", "#muh2"}]}], "&"}], ",", 
    RowBox[{"\"\<b1\>\"", "\[Rule]", "2"}], ",", 
    RowBox[{"\"\<wt1\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], ",", 
    RowBox[{"\"\<muh1\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], ",", 
    RowBox[{"\"\<varh1\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], ",", 
    RowBox[{"\"\<varh2\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], ",", 
    RowBox[{"\"\<muh2\>\"", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825704293704557*^9, 3.825704362162993*^9}, {
  3.825704399722686*^9, 3.825704444589329*^9}, {3.8257045094889183`*^9, 
  3.8257045124095488`*^9}, {3.8257049315377493`*^9, 3.825704934519601*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"d198e94e-ee12-43e3-88de-5392c2de2c03"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convertwtLayer", "[", "]"}], ":=", 
  RowBox[{"FunctionLayer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sqrt", "[", "#varh2", "]"}], 
       RowBox[{"-", "1"}]], ".", 
      RowBox[{"Sqrt", "[", "#varh1", "]"}], ".", "#wt1"}], "&"}], ",", 
    RowBox[{"\"\<wt1\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], ",", 
    RowBox[{"\"\<varh1\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], ",", 
    RowBox[{"\"\<varh2\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825704293704557*^9, 3.825704362162993*^9}, {
  3.825704399722686*^9, 3.825704444589329*^9}, {3.8257045094889183`*^9, 
  3.8257045124095488`*^9}, {3.825704716376679*^9, 3.825704748168625*^9}, {
  3.825704936451956*^9, 3.82570493792344*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"e5f815ec-43ac-45d8-94f8-a417af244ad0"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8307981053298483`*^9, 
  3.830798105612661*^9}},ExpressionUUID->"25b1888a-bac7-4a22-a1c3-\
41b348a745e0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"b1Test", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wt1Test", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muh1Test", "=", 
   RowBox[{"{", "3", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh1Test", "=", 
   RowBox[{"{", 
    RowBox[{"{", "3", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh2Test", "=", 
   RowBox[{"{", 
    RowBox[{"{", "5", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muh2Test", "=", 
   RowBox[{"{", "2", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"b2True", "=", 
  RowBox[{
   RowBox[{"b1Test", "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "wt1Test", "]"}], ".", "muh1Test"}], "-", 
    RowBox[{
     RowBox[{"Transpose", "[", "wt1Test", "]"}], ".", 
     RowBox[{"Sqrt", "[", "varh1Test", "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"Sqrt", "[", "varh2Test", "]"}], "]"}], ".", "muh2Test"}]}], "//",
    "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"b2Actual", "=", 
  RowBox[{
   RowBox[{"convertbLayer", "[", "]"}], "[", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<b1\>\"", "\[Rule]", "b1Test"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"\"\<wt1\>\"", "\[Rule]", "wt1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<muh1\>\"", "\[Rule]", "muh1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh1\>\"", "\[Rule]", "varh1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh2\>\"", "\[Rule]", "varh2Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<muh2\>\"", "\[Rule]", "muh2Test"}]}], "\[IndentingNewLine]",
     "|>"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.825704547918667*^9, 3.825704625860607*^9}, {
   3.825704813372499*^9, 3.825704826223818*^9}, 3.825704864563471*^9, {
   3.825704940466617*^9, 3.8257049414519663`*^9}},
 CellLabel->
  "In[502]:=",ExpressionUUID->"e00ca8e7-ae7b-4a23-8a05-aa4385e2e04a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.3524199845511`", ",", "7.803226646068133`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8257046222135143`*^9, 3.82570462611124*^9}, {
   3.8257048179870358`*^9, 3.8257048265238867`*^9}, 3.825704941753586*^9},
 CellLabel->
  "Out[508]=",ExpressionUUID->"5a2faba5-87f1-4a79-a542-fa7891550a2a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.352420330047607`", ",", "7.803226947784424`"}], "}"}]], "Output",\

 CellChangeTimes->{{3.8257046222135143`*^9, 3.82570462611124*^9}, {
   3.8257048179870358`*^9, 3.8257048265238867`*^9}, 3.825704941965028*^9},
 CellLabel->
  "Out[509]=",ExpressionUUID->"98eb4db7-19b3-4218-9e80-7d9322473ce6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"wt1Test", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh1Test", "=", 
   RowBox[{"{", 
    RowBox[{"{", "3", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh2Test", "=", 
   RowBox[{"{", 
    RowBox[{"{", "5", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"wt2True", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"Sqrt", "[", "varh2Test", "]"}], "]"}], ".", 
    RowBox[{"Sqrt", "[", "varh1Test", "]"}], ".", "wt1Test"}], "//", 
   "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"wt2Actual", "=", 
  RowBox[{
   RowBox[{"convertwtLayer", "[", "]"}], "[", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<wt1\>\"", "\[Rule]", "wt1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh1\>\"", "\[Rule]", "varh1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh2\>\"", "\[Rule]", "varh2Test"}]}], 
    "\[IndentingNewLine]", "|>"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.825704869600503*^9, 3.8257049110809526`*^9}, {
  3.825704944698711*^9, 3.8257049455081778`*^9}},
 CellLabel->
  "In[510]:=",ExpressionUUID->"2baa5183-835a-4ff4-b7b4-45c971cce523"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"2.32379000772445`", ",", "3.0983866769659336`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.825704911323472*^9, 3.8257049457571907`*^9},
 CellLabel->
  "Out[513]=",ExpressionUUID->"8e8c941a-9dfa-44bb-857c-336d4bbbd853"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"2.3237898349761963`", ",", "3.098386526107788`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.825704911323472*^9, 3.825704945811657*^9},
 CellLabel->
  "Out[514]=",ExpressionUUID->"71389ccf-ce87-4b2e-9d0a-de840a3a5939"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert params layer from 0", "Chapter",
 CellChangeTimes->{{3.825704279392277*^9, 3.8257042817082033`*^9}, {
  3.825705486761505*^9, 
  3.825705487520769*^9}},ExpressionUUID->"e1d1d40b-6d25-42e1-bd96-\
0620b2c8a6aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convertbLayerFrom0", "[", "]"}], ":=", 
  RowBox[{"FunctionLayer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"#b1", "-", 
      RowBox[{
       RowBox[{"Transpose", "[", "#wt1", "]"}], ".", 
       SuperscriptBox[
        RowBox[{"Sqrt", "[", "#varh2", "]"}], 
        RowBox[{"-", "1"}]], ".", "#muh2"}]}], "&"}], ",", 
    RowBox[{"\"\<b1\>\"", "\[Rule]", "2"}], ",", 
    RowBox[{"\"\<wt1\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], ",", 
    RowBox[{"\"\<varh2\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}], ",", 
    RowBox[{"\"\<muh2\>\"", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825704293704557*^9, 3.825704362162993*^9}, {
  3.825704399722686*^9, 3.825704444589329*^9}, {3.8257045094889183`*^9, 
  3.8257045124095488`*^9}, {3.8257049315377493`*^9, 3.825704934519601*^9}, {
  3.825705490007474*^9, 3.825705510783823*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"150883d2-624d-40c6-a0fa-fc0a2bc65725"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convertwtLayerFrom0", "[", "]"}], ":=", 
  RowBox[{"FunctionLayer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"Sqrt", "[", "#varh2", "]"}], 
       RowBox[{"-", "1"}]], ".", "#wt1"}], "&"}], ",", 
    RowBox[{"\"\<wt1\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}]}], ",", 
    RowBox[{"\"\<varh2\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825704293704557*^9, 3.825704362162993*^9}, {
  3.825704399722686*^9, 3.825704444589329*^9}, {3.8257045094889183`*^9, 
  3.8257045124095488`*^9}, {3.825704716376679*^9, 3.825704748168625*^9}, {
  3.825704936451956*^9, 3.82570493792344*^9}, {3.8257055166711273`*^9, 
  3.825705524087533*^9}, {3.825705573437446*^9, 3.825705575036976*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"e9f4b641-fa44-417b-88fa-68419485a24f"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798109339985*^9, 
  3.8307981096526814`*^9}},ExpressionUUID->"9d3530b2-1cb3-4676-9150-\
212fee561b5d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"b1Test", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wt1Test", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh2Test", "=", 
   RowBox[{"{", 
    RowBox[{"{", "5", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muh2Test", "=", 
   RowBox[{"{", "2", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"b2True", "=", 
  RowBox[{
   RowBox[{"b1Test", "-", 
    RowBox[{
     RowBox[{"Transpose", "[", "wt1Test", "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"Sqrt", "[", "varh2Test", "]"}], "]"}], ".", "muh2Test"}]}], "//",
    "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"b2Actual", "=", 
  RowBox[{
   RowBox[{"convertbLayerFrom0", "[", "]"}], "[", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<b1\>\"", "\[Rule]", "b1Test"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"\"\<wt1\>\"", "\[Rule]", "wt1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh2\>\"", "\[Rule]", "varh2Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<muh2\>\"", "\[Rule]", "muh2Test"}]}], "\[IndentingNewLine]",
     "|>"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.825704547918667*^9, 3.825704625860607*^9}, {
   3.825704813372499*^9, 3.825704826223818*^9}, 3.825704864563471*^9, {
   3.825704940466617*^9, 3.8257049414519663`*^9}, {3.825705541409809*^9, 
   3.8257055539241123`*^9}, {3.825705590663385*^9, 3.8257055918415537`*^9}},
 CellLabel->
  "In[583]:=",ExpressionUUID->"187cc452-7894-4f66-81c8-e6f36858d9c9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.6832815729997477`"}], ",", 
   RowBox[{"-", "1.5777087639996634`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8257046222135143`*^9, 3.82570462611124*^9}, {
   3.8257048179870358`*^9, 3.8257048265238867`*^9}, 3.825704941753586*^9, 
   3.825705554292243*^9, 3.825705592279253*^9},
 CellLabel->
  "Out[587]=",ExpressionUUID->"ad763a59-ce7b-4238-9be8-23efdfcad6e0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.683281421661377`"}], ",", 
   RowBox[{"-", "1.5777087211608887`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8257046222135143`*^9, 3.82570462611124*^9}, {
   3.8257048179870358`*^9, 3.8257048265238867`*^9}, 3.825704941753586*^9, 
   3.825705554292243*^9, 3.825705592403174*^9},
 CellLabel->
  "Out[588]=",ExpressionUUID->"ef7890d4-855b-4404-b121-a410efa3035b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"wt1Test", "=", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"3", ",", "4"}], "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh2Test", "=", 
   RowBox[{"{", 
    RowBox[{"{", "5", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"wt2True", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"Sqrt", "[", "varh2Test", "]"}], "]"}], ".", "wt1Test"}], "//", 
   "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"wt2Actual", "=", 
  RowBox[{
   RowBox[{"convertwtLayerFrom0", "[", "]"}], "[", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<wt1\>\"", "\[Rule]", "wt1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh2\>\"", "\[Rule]", "varh2Test"}]}], 
    "\[IndentingNewLine]", "|>"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.825704869600503*^9, 3.8257049110809526`*^9}, {
  3.825704944698711*^9, 3.8257049455081778`*^9}, {3.8257055593606453`*^9, 
  3.8257055872130632`*^9}},
 CellLabel->
  "In[589]:=",ExpressionUUID->"7939a27f-2799-4215-9720-b1dd12e1897a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1.3416407864998738`", ",", "1.7888543819998317`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.825704911323472*^9, 3.8257049457571907`*^9, {3.825705582643235*^9, 
   3.825705592901224*^9}},
 CellLabel->
  "Out[591]=",ExpressionUUID->"3dfe4243-6b97-415e-9395-8ba39a8cd6fe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1.3416407108306885`", ",", "1.7888543605804443`"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.825704911323472*^9, 3.8257049457571907`*^9, {3.825705582643235*^9, 
   3.8257055929401913`*^9}},
 CellLabel->
  "Out[592]=",ExpressionUUID->"b4d1a6df-a62e-47fd-b6dc-b31ae308453e"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Make convert params0 to params layer", "Title",
 CellChangeTimes->{{3.825705096992691*^9, 3.8257051019214363`*^9}, {
  3.825705976511894*^9, 
  3.825705980919406*^9}},ExpressionUUID->"fedfaf62-4769-4c23-b2f3-\
e4387ee5439f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertParams0ToParamsLayer", "[", 
   RowBox[{
   "freqs_", ",", "muhCosCoeffsInit_", ",", "muhSinCoeffsInit_", ",", 
    "varhCosCoeffsInit_", ",", "varhSinCoeffsInit_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn", ",", "graph"}], "}"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<layerMuh\>\"", "->", 
         RowBox[{"makeFourierGraph", "[", 
          RowBox[{
          "freqs", ",", "muhSinCoeffsInit", ",", "muhCosCoeffsInit", ",", 
           RowBox[{"{", "0", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<layerVarh\>\"", "->", 
         RowBox[{"makeFourierGraph", "[", 
          RowBox[{
          "freqs", ",", "varhSinCoeffsInit", ",", "varhCosCoeffsInit", ",", 
           RowBox[{"{", "1.01", "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<reshapeMuh\>\"", "->", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", "1", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<reshapeVarh\>\"", "->", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertblayer\>\"", "->", 
         RowBox[{"convertbLayerFrom0", "[", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<convertwtlayer\>\"", "->", 
         RowBox[{"convertwtLayerFrom0", "[", "]"}]}]}], "\[IndentingNewLine]",
        "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<layerMuh\>\"", "->", 
         RowBox[{"\"\<reshapeMuh\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<convertblayer\>\"", ",", "\"\<muh2\>\""}], "]"}]}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<layerVarh\>\"", "->", 
         RowBox[{"\"\<reshapeVarh\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<convertblayer\>\"", ",", "\"\<varh2\>\""}], "]"}]}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertblayer\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<b2\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\"\<reshapeVarh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertwtlayer\>\"", ",", "\"\<varh2\>\""}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertwtlayer\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<wt2\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\"\<reshapeMuh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<muh2\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<reshapeVarh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<varh2\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<sig2\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<sig2\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<sig2\>\"", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "graph", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825705981534645*^9, 3.825706050022122*^9}, {
  3.825718738178441*^9, 3.8257187734076*^9}, {3.8257203687627783`*^9, 
  3.825720455390102*^9}, {3.826035436753889*^9, 3.826035483623488*^9}, {
  3.826043642747409*^9, 3.826043684940377*^9}, {3.826043763118853*^9, 
  3.826043851982929*^9}, {3.8260439051598797`*^9, 3.826043906870182*^9}, {
  3.8261179974707527`*^9, 3.82611802593007*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"a365bf21-ecee-4dcf-93cd-95e4ab038d86"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798116052297*^9, 
  3.830798116355566*^9}},ExpressionUUID->"42575cd4-d749-4992-b806-\
9db5a301b882"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertParams0ToParamsLayer", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0.1", ",", "0.2", ",", "0.3", ",", "0.4"}], "}"}], ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "4"}], "]"}], ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "4"}], "]"}], ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "4"}], "]"}], ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "4"}], "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.825706056651168*^9, 3.8257060644394207`*^9}, {
   3.826035492261265*^9, 3.826035492427899*^9}, {3.826043855615714*^9, 
   3.826043860562415*^9}, {3.8261180415671997`*^9, 3.8261180421572857`*^9}, 
   3.830798114977232*^9},ExpressionUUID->"31b5925e-52e5-48c1-8b2c-\
eda21f54006d"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Moments from params", "Title",
 CellChangeTimes->{{3.825784408131878*^9, 3.825784408509409*^9}, {
  3.825784782569479*^9, 
  3.8257847858322277`*^9}},ExpressionUUID->"6af74424-f4fe-4f07-827d-\
58a5ec887ae3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeVarArrayReshapeLayer", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"FunctionLayer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Catenate", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Catenate", "[", 
           RowBox[{"{", 
            RowBox[{"#varv", ",", "#varvh"}], "}"}], "]"}], "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Catenate", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Transpose", "[", "#varvh", "]"}], ",", "#varh"}], "}"}],
            "]"}], "]"}]}], "}"}], "]"}], "]"}], "&"}], ",", 
    RowBox[{"\"\<varv\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"nv", ",", "nv"}], "}"}]}], ",", 
    RowBox[{"\"\<varvh\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
    RowBox[{"\"\<varh\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"nh", ",", "nh"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8257861609531803`*^9, 3.825786176757854*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"322f1acc-b919-4d84-88f7-721b03c9aef7"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798123289316*^9, 
  3.8307981250703773`*^9}},ExpressionUUID->"8689e181-e4af-47a7-9f24-\
487936e56bd0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lyr", "=", 
    RowBox[{"makeVarArrayReshapeLayer", "[", 
     RowBox[{"nv", ",", "nh"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varvTest", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nv", ",", "nv"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varvhTest", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nh", ",", "nv"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varhTest", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nh", ",", "nh"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrayFlatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"varvTest", ",", 
       RowBox[{"Transpose", "[", "varvhTest", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"varvhTest", ",", "varhTest"}], "}"}]}], "}"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"lyr", "[", 
  RowBox[{"<|", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<varv\>\"", "\[Rule]", "varvTest"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<varvh\>\"", "\[Rule]", "varvhTest"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<varh\>\"", "\[Rule]", "varhTest"}]}], "\[IndentingNewLine]", 
   "|>"}], "]"}]}], "Input",
 CellChangeTimes->{{3.825786182044635*^9, 3.825786196877397*^9}, 
   3.83079812253587*^9},ExpressionUUID->"febff9b1-857e-4a05-87b7-\
e822e6003230"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.5221035458921865`", ",", "0.060886333065448106`", ",", 
     "0.6047093172569231`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.16017326842250545`", ",", "0.32526622294231755`", ",", 
     RowBox[{"-", "0.3287795482798761`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6047093172569231`", ",", 
     RowBox[{"-", "0.3287795482798761`"}], ",", "0.8995746950464394`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.82578618575911*^9, 3.825786197278028*^9}, 
   3.825883121044757*^9},
 CellLabel->
  "Out[482]=",ExpressionUUID->"68bb607b-3537-47da-93a3-f30195addb18"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.5221035480499268`", ",", "0.060886334627866745`", ",", 
     "0.6047093272209167`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.16017326712608337`", ",", "0.3252662122249603`", ",", 
     RowBox[{"-", "0.32877954840660095`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6047093272209167`", ",", 
     RowBox[{"-", "0.32877954840660095`"}], ",", "0.8995746970176697`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.82578618575911*^9, 3.825786197278028*^9}, 
   3.825883121046371*^9},
 CellLabel->
  "Out[483]=",ExpressionUUID->"48a2e079-4a7d-41e9-b857-c224aa6f88b2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Params to moments", "Chapter",
 CellChangeTimes->{{3.830798126889758*^9, 
  3.830798128478427*^9}},ExpressionUUID->"85bb17ec-aad3-4bef-a3cf-\
224630da3b2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGraphConvertParamsToMoments", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<varvh\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#varh", ".", "#wt"}], "&"}], ",", 
           RowBox[{"\"\<varh\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<wt\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<idmat\>\"", "\[Rule]", 
         RowBox[{"NetArrayLayer", "[", 
          RowBox[{
           RowBox[{"\"\<Array\>\"", "->", 
            RowBox[{"IdentityMatrix", "[", "nv", "]"}]}], ",", 
           RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<varv\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "#wt", "]"}], ".", "#varh", ".", 
              "#wt"}], "+", 
             RowBox[{"#sig2", "*", "#idmat"}]}], "&"}], ",", 
           RowBox[{"\"\<wt\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varh\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<sig2\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<idmat\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nv", ",", "nv"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<muv\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#b", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "#wt", "]"}], ".", "#muh"}]}], "&"}], 
           ",", 
           RowBox[{"\"\<b\>\"", "\[Rule]", "nv"}], ",", 
           RowBox[{"\"\<wt\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<muh\>\"", "\[Rule]", "nh"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Catenate", "[", 
             RowBox[{"{", 
              RowBox[{"#muv", ",", "#muh"}], "}"}], "]"}], "&"}], ",", 
           RowBox[{"\"\<muv\>\"", "\[Rule]", "nv"}], ",", 
           RowBox[{"\"\<muh\>\"", "\[Rule]", "nh"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<var\>\"", "\[Rule]", 
         RowBox[{"makeVarArrayReshapeLayer", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "varvh", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varvh\>\"", ",", "\"\<varh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<wt\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varvh\>\"", ",", "\"\<wt\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "varv", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<wt\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varv\>\"", ",", "\"\<wt\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varv\>\"", ",", "\"\<varh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<sig2\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varv\>\"", ",", "\"\<sig2\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<idmat\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varv\>\"", ",", "\"\<idmat\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "muv", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<b\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<muv\>\"", ",", "\"\<b\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<wt\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<muv\>\"", ",", "\"\<wt\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muh\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<muv\>\"", ",", "\"\<muh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "mu", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\"\<muv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mu\>\"", ",", "\"\<muv\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muh\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mu\>\"", ",", "\"\<muh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<mu\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "var", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\"\<varvh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<var\>\"", ",", "\"\<varvh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<var\>\"", ",", "\"\<varv\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<var\>\"", ",", "\"\<varh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<var\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<var\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Misc", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\"\<varvh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<varvh\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825784787348721*^9, 3.825784798783022*^9}, {
  3.825786541731583*^9, 3.825786584948995*^9}, {3.825788099857664*^9, 
  3.825788110676518*^9}, {3.8258830837451878`*^9, 3.82588310845868*^9}, {
  3.825883198588648*^9, 3.825883199021044*^9}, {3.826033313334261*^9, 
  3.826033320843611*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"e07c8541-1179-4820-b811-9b07e9faf697"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798137726054*^9, 
  3.830798138010907*^9}},ExpressionUUID->"28580f4a-eefc-45bd-840e-\
ce4b2c007bd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGraphConvertParamsToMoments", "[", 
   RowBox[{"nv", ",", "nh"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.825788088588971*^9, 3.825788089234741*^9}, 
   3.8307981364722958`*^9},ExpressionUUID->"599aaa96-365b-4503-aafe-\
20aba7d77949"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["NMoments from moments/params", "Title",
 CellChangeTimes->{{3.825787538752645*^9, 
  3.82578754902521*^9}},ExpressionUUID->"c0dd3a22-94d8-4ff8-bb31-\
e0c16d130d7f"],

Cell[CellGroupData[{

Cell["Moments to NMoments", "Chapter",
 CellChangeTimes->{{3.8307981515052347`*^9, 
  3.8307981537805557`*^9}},ExpressionUUID->"37020cd4-70ad-43e5-b30d-\
003205fcf34e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGraphConvertMomentsToNMoments", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<reshapeMu\>\"", "\[Rule]", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<kpv\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#mu", ".", 
             RowBox[{"Transpose", "[", "#mu", "]"}]}], "&"}], ",", 
           RowBox[{"\"\<mu\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<nvar\>\"", "\[Rule]", 
         RowBox[{"TotalLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<mu\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<reshapeMu\>\"", "\[Rule]", 
          RowBox[{"\"\<kpv\>\"", "\[Rule]", "\"\<nvar\>\""}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<var\>\"", "]"}], "\[Rule]", 
         "\"\<nvar\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<mu\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<mu\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<nvar\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<nvar\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825787551905673*^9, 3.82578768332721*^9}, {
  3.8257877375949097`*^9, 3.825787752213188*^9}, {3.825788124057631*^9, 
  3.825788142662965*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"03ec8a4e-fc56-4a54-b74e-c41964bd45c8"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798143896349*^9, 
  3.83079814419492*^9}},ExpressionUUID->"e8b9d4e8-f8c9-46f1-ba07-\
57fe87c76d9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGraphConvertMomentsToNMoments", "[", 
   RowBox[{"nv", ",", "nh"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.825787691011198*^9, 3.8257876946428127`*^9}, 
   3.830798143076754*^9},ExpressionUUID->"bd587b45-36b0-4af1-899f-\
ba028755ef42"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Params to NMoments", "Chapter",
 CellChangeTimes->{{3.830798145877008*^9, 
  3.8307981483011847`*^9}},ExpressionUUID->"36b95f31-c124-47a8-aa01-\
8835e923f430"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGraphConvertParamsToNMoments", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<paramsToMoments\>\"", "\[Rule]", 
         RowBox[{"makeGraphConvertParamsToMoments", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<momentsToNMoments\>\"", "\[Rule]", 
         RowBox[{"makeGraphConvertMomentsToNMoments", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<paramsToMoments\>\"", ",", "\"\<mu\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<momentsToNMoments\>\"", ",", "\"\<mu\>\""}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<paramsToMoments\>\"", ",", "\"\<var\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<momentsToNMoments\>\"", ",", "\"\<var\>\""}], 
          "]"}]}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8257879966587276`*^9, 3.825788072782784*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"a6d3be3c-8a34-4a91-ba32-0ff75dbe2be1"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8307981564982977`*^9, 
  3.8307981567995872`*^9}},ExpressionUUID->"14008b62-ea26-4540-b23f-\
0eca17c48a4d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGraphConvertParamsToNMoments", "[", 
   RowBox[{"nv", ",", "nh"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.825788073548258*^9, 3.825788078139997*^9}, 
   3.830798155770687*^9},ExpressionUUID->"af0af7bb-f129-48a6-927a-\
9f3a1428346b"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Death rxn", "Title",
 CellChangeTimes->{{3.825788578505666*^9, 
  3.8257885793493547`*^9}},ExpressionUUID->"4c6ecff3-0666-4b86-ac9f-\
f1582aa49833"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeDeathMeans", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{"\"\<f\>\"", "->", 
        RowBox[{"FunctionLayer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"#mu", "[", 
              RowBox[{"[", "iSp", "]"}], "]"}]}], "*", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", "iSp"}], "]"}]}], "&"}], ",", 
          RowBox[{"\"\<mu\>\"", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"nv", "+", "nh"}], ")"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<f\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825797322118442*^9, 3.825797400266646*^9}, {
   3.825805793912661*^9, 3.8258058237500896`*^9}, 3.825805932939825*^9, {
   3.825806215060763*^9, 3.8258062336705008`*^9}, {3.82580654111828*^9, 
   3.825806543069293*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"6020f374-229e-4093-8fdd-4d1cf50728bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeUnitMat", "[", 
   RowBox[{"i0_", ",", "j0_"}], "]"}], ":=", 
  RowBox[{"NetArrayLayer", "[", 
   RowBox[{
    RowBox[{"\"\<Array\>\"", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", "i0"}], "&&", 
          RowBox[{"j", "\[Equal]", "j0"}]}], ",", "1", ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258049274275846`*^9, 3.825804966950613*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"3e9b3d6e-c4ac-4ed7-93cf-033af5f3451e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeUnitMatSymm", "[", 
   RowBox[{"i0_", ",", "j0_"}], "]"}], ":=", 
  RowBox[{"NetArrayLayer", "[", 
   RowBox[{
    RowBox[{"\"\<Array\>\"", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "i0"}], "&&", 
            RowBox[{"j", "\[Equal]", "j0"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "j0"}], "&&", 
            RowBox[{"j", "\[Equal]", "i0"}]}], ")"}]}], ",", "1", ",", "0"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258049274275846`*^9, 3.825804966950613*^9}, {
  3.8258054390348186`*^9, 3.825805451657481*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"c6a2eb84-bf4c-444f-a2fc-c5207627e278"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeDeathNVarDiagMat", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMat", "[", 
          RowBox[{"iSp", ",", "iSp"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], "*", 
               RowBox[{"#nvar", "[", 
                RowBox[{"[", 
                 RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}]}], "+", 
              RowBox[{"#mu", "[", 
               RowBox[{"[", "iSp", "]"}], "]"}]}], ")"}]}], "&"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805023567387*^9, 3.8258051678646584`*^9}, {
   3.825805198830471*^9, 3.825805263798155*^9}, {3.8258055036548758`*^9, 
   3.825805504376256*^9}, 3.825871891032954*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"8c01b497-6d4d-4bc1-a379-921da1e6e19d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeDeathNVarOffDiagMatSymm", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_", ",", "jSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"iSp", ",", "jSp"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}]}], ")"}]}], "&"}], 
          "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805023567387*^9, 3.8258051678646584`*^9}, {
   3.825805198830471*^9, 3.825805263798155*^9}, {3.82580541940361*^9, 
   3.8258055144877768`*^9}, {3.825805611712385*^9, 3.8258056123780317`*^9}, 
   3.8258718931732683`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"016f770d-e3aa-4373-a195-a9dfc825e27f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeDeathNVar", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "layerDefns", ",", "layerName", ",", "layerNames", ",", "layerConn"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerNames", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerDefns", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iSp", "]"}], "<>", 
       RowBox[{"ToString", "[", "iSp", "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeDeathNVarDiagMat", "[", 
       RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"iSp", "\[Equal]", "jSp"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"layerName", "=", 
         RowBox[{"\"\<m\>\"", "<>", 
          RowBox[{"ToString", "[", "iSp", "]"}], "<>", 
          RowBox[{"ToString", "[", "jSp", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
         RowBox[{"makeDeathNVarOffDiagMatSymm", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp", ",", "jSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerNames", ",", "layerName"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "\"\<tot\>\"", "]"}], "=", 
      RowBox[{"TotalLayer", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"layerNames", "\[Rule]", 
        RowBox[{"\"\<tot\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<nvarTE\>\"", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<nvar\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nv", "+", "nh"}], ",", 
           RowBox[{"nv", "+", "nh"}]}], "}"}]}], ",", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"nv", "+", "nh"}]}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805291720524*^9, 3.825805407965281*^9}, {
  3.825805540746076*^9, 3.825805707498351*^9}, {3.825805739741499*^9, 
  3.825805761943439*^9}, {3.8258057976722927`*^9, 3.825805820457033*^9}, {
  3.8258718953406467`*^9, 3.825871900230241*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"1207896e-17be-4e6b-98d3-1eb7faf89c15"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8258061076842203`*^9, 
  3.825806108010344*^9}},ExpressionUUID->"dcb585f8-9fa8-4c1e-a058-\
f698a8de46b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeRxnDeathNMomentsTE", "[", 
   RowBox[{"nMoments_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nv", ",", "nh", ",", "te", ",", "mu", ",", "nvar", ",", "n"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", "3"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Means", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mu", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mu", "[", 
       RowBox[{"[", "iSp", "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "[", 
        RowBox[{"[", "iSp", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Variances", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nvar", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nvar", "[", 
       RowBox[{"[", 
        RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "*", 
        RowBox[{
         RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "[", 
        RowBox[{"[", "iSp", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"iSp", "\[Equal]", "jSp"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"jSp", ",", "iSp"}], "]"}], "]"}], "=", 
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"te", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"te", "[", "\"\<muTE\>\"", "]"}], "=", "mu"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"te", "[", "\"\<nvarTE\>\"", "]"}], "=", "nvar"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "te", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825806105763329*^9, 3.825806116929751*^9}, {
  3.8258065610193157`*^9, 3.825806565421042*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"dcf24204-5757-43bf-8d0f-2518f641618d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMoments", "=", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nv", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nh", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outTrue", "=", 
    RowBox[{"makeRxnDeathNMomentsTE", "[", 
     RowBox[{"nMoments", ",", "2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeDeathMeans", "[", 
    RowBox[{"nv", ",", "nh", ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"muTrue", "=", 
  RowBox[{"outTrue", "[", "\"\<muTE\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"muTest", "=", 
  RowBox[{"lyr", "[", "nMoments", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{"muTest", "-", "muTrue"}], "]"}], "]"}], "<", 
   SuperscriptBox["10", 
    RowBox[{"-", "5"}]]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeDeathNVar", "[", 
    RowBox[{"nv", ",", "nh", ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nvarTrue", "=", 
  RowBox[{"outTrue", "[", "\"\<nvarTE\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nvarTest", "=", 
  RowBox[{"lyr", "[", "nMoments", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"nvarTest", "-", "nvarTrue"}], "]"}], "]"}], "<", 
  SuperscriptBox["10", 
   RowBox[{"-", "5"}]]}]}], "Input",
 CellChangeTimes->{{3.825806122120771*^9, 3.825806158807034*^9}, {
   3.8258062774032707`*^9, 3.825806385537447*^9}, {3.825806570096479*^9, 
   3.825806592426536*^9}, 3.8258719077823687`*^9},
 CellLabel->
  "In[576]:=",ExpressionUUID->"2589dfb4-3720-4ddb-bfc0-1492608a07b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0.7354303897691437`", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.825884424937608*^9},
 CellLabel->
  "Out[583]=",ExpressionUUID->"32de460d-aa76-41bf-b8f5-0fb64698e21b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.7354304194450378`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.8258844249421473`*^9},
 CellLabel->
  "Out[584]=",ExpressionUUID->"be64a8fa-d9e8-479a-83f7-7119a35a54e2"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.825884424943283*^9},
 CellLabel->
  "Out[585]=",ExpressionUUID->"ea6089f3-8bef-4c80-ae84-59ca54bb4dbd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "0.6303740339532351`"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6303740339532351`"}], ",", 
     RowBox[{"-", "0.8922865601672849`"}], ",", 
     RowBox[{"-", "0.22091135996732492`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "0.22091135996732492`"}], ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.825884425207059*^9},
 CellLabel->
  "Out[587]=",ExpressionUUID->"05ee64ef-b6b7-457f-a7c3-17cbe0cb6a1d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "0.630374014377594`"}], ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.630374014377594`"}], ",", 
     RowBox[{"-", "0.8922865986824036`"}], ",", 
     RowBox[{"-", "0.22091135382652283`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "0.22091135382652283`"}], ",", "0.`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.825884425220359*^9},
 CellLabel->
  "Out[588]=",ExpressionUUID->"8c4bbfd1-befd-4d14-b63b-555a77c2fbcd"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.825884425221489*^9},
 CellLabel->
  "Out[589]=",ExpressionUUID->"a31c2dde-2e59-4126-8ddd-7ea494be620f"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Birth rxn", "Title",
 CellChangeTimes->{{3.825788578505666*^9, 3.8257885793493547`*^9}, {
  3.82580590655658*^9, 
  3.825805910986578*^9}},ExpressionUUID->"42f75383-66ed-4961-a102-\
78009944226d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeBirthMeans", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{"\"\<f\>\"", "->", 
        RowBox[{"FunctionLayer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#mu", "[", 
             RowBox[{"[", "iSp", "]"}], "]"}], "*", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", "iSp"}], "]"}]}], "&"}], ",", 
          RowBox[{"\"\<mu\>\"", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"nv", "+", "nh"}], ")"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<f\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825797322118442*^9, 3.825797400266646*^9}, {
  3.825805793912661*^9, 3.8258058237500896`*^9}, {3.825805913517797*^9, 
  3.825805914780362*^9}, {3.82580623951912*^9, 3.8258062633444347`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"108d6b6e-c497-40cf-8664-5610ffdeba77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeBirthNVarDiagMat", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMat", "[", 
          RowBox[{"iSp", ",", "iSp"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"#nvar", "[", 
                RowBox[{"[", 
                 RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}]}], "+", 
              RowBox[{"#mu", "[", 
               RowBox[{"[", "iSp", "]"}], "]"}]}], ")"}]}], "&"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805023567387*^9, 3.8258051678646584`*^9}, {
   3.825805198830471*^9, 3.825805263798155*^9}, {3.8258055036548758`*^9, 
   3.825805504376256*^9}, {3.825805943144033*^9, 3.825805952977646*^9}, 
   3.825871911822729*^9},
 CellLabel->"In[22]:=",ExpressionUUID->"4a06b9d7-318e-4484-abbc-47cd5f35e0f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeBirthNVarOffDiagMatSymm", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_", ",", "jSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"iSp", ",", "jSp"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{"#nvar", "[", 
              RowBox[{"[", 
               RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}], ")"}]}], "&"}], 
          "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805023567387*^9, 3.8258051678646584`*^9}, {
   3.825805198830471*^9, 3.825805263798155*^9}, {3.82580541940361*^9, 
   3.8258055144877768`*^9}, {3.825805611712385*^9, 3.8258056123780317`*^9}, {
   3.825805955293206*^9, 3.825805960743833*^9}, 3.825871914364833*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"ab668816-d09a-476b-8fa8-077b20e21ec8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeBirthNVar", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "layerDefns", ",", "layerName", ",", "layerNames", ",", "layerConn"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerNames", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerDefns", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iSp", "]"}], "<>", 
       RowBox[{"ToString", "[", "iSp", "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeBirthNVarDiagMat", "[", 
       RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"iSp", "\[Equal]", "jSp"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"layerName", "=", 
         RowBox[{"\"\<m\>\"", "<>", 
          RowBox[{"ToString", "[", "iSp", "]"}], "<>", 
          RowBox[{"ToString", "[", "jSp", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
         RowBox[{"makeBirthNVarOffDiagMatSymm", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp", ",", "jSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerNames", ",", "layerName"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "\"\<tot\>\"", "]"}], "=", 
      RowBox[{"TotalLayer", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"layerNames", "\[Rule]", 
        RowBox[{"\"\<tot\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<nvarTE\>\"", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<nvar\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nv", "+", "nh"}], ",", 
           RowBox[{"nv", "+", "nh"}]}], "}"}]}], ",", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"nv", "+", "nh"}]}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805291720524*^9, 3.825805407965281*^9}, {
   3.825805540746076*^9, 3.825805707498351*^9}, {3.825805739741499*^9, 
   3.825805761943439*^9}, {3.8258057976722927`*^9, 3.825805820457033*^9}, {
   3.825805963998415*^9, 3.825805971688965*^9}, 3.825871882254445*^9, {
   3.825871918540702*^9, 3.8258719203530273`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"9e65a4f7-c0fe-4e19-ae6e-6919744b62fb"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8258061076842203`*^9, 
  3.825806108010344*^9}},ExpressionUUID->"16b0cae3-8e63-4cc9-9cd9-\
303c9a37e741"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeRxnBirthNMomentsTE", "[", 
   RowBox[{"nMoments_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nv", ",", "nh", ",", "te", ",", "mu", ",", "nvar", ",", "n"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", "3"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Means", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mu", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mu", "[", 
       RowBox[{"[", "iSp", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "[", 
       RowBox[{"[", "iSp", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Variances", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nvar", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nvar", "[", 
       RowBox[{"[", 
        RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{
         RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "[", 
        RowBox[{"[", "iSp", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"iSp", "\[Equal]", "jSp"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"jSp", ",", "iSp"}], "]"}], "]"}], "=", 
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"te", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"te", "[", "\"\<muTE\>\"", "]"}], "=", "mu"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"te", "[", "\"\<nvarTE\>\"", "]"}], "=", "nvar"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "te", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825806105763329*^9, 3.825806116929751*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"8866315e-af8f-4589-a4db-30c989591f35"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMoments", "=", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nv", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nh", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outTrue", "=", 
    RowBox[{"makeRxnBirthNMomentsTE", "[", 
     RowBox[{"nMoments", ",", "1"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeBirthMeans", "[", 
    RowBox[{"nv", ",", "nh", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"muTrue", "=", 
  RowBox[{"outTrue", "[", "\"\<muTE\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"muTest", "=", 
  RowBox[{"lyr", "[", "nMoments", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{"muTest", "-", "muTrue"}], "]"}], "]"}], "<", 
   SuperscriptBox["10", 
    RowBox[{"-", "5"}]]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeBirthNVar", "[", 
    RowBox[{"nv", ",", "nh", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nvarTrue", "=", 
  RowBox[{"outTrue", "[", "\"\<nvarTE\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nvarTest", "=", 
  RowBox[{"lyr", "[", "nMoments", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"nvarTest", "-", "nvarTrue"}], "]"}], "]"}], "<", 
  SuperscriptBox["10", 
   RowBox[{"-", "5"}]]}]}], "Input",
 CellChangeTimes->{{3.825806122120771*^9, 3.825806158807034*^9}, {
   3.8258062774032707`*^9, 3.825806385537447*^9}, 3.825871925974884*^9},
 CellLabel->
  "In[629]:=",ExpressionUUID->"8a5b8d9b-68ca-46e9-a3f1-34949facc035"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7330052108607172`", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825884473589904*^9},
 CellLabel->
  "Out[636]=",ExpressionUUID->"6490fec2-cdb6-4e4d-816d-f926c101493d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7330052256584167`", ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.8258844735944567`*^9},
 CellLabel->
  "Out[637]=",ExpressionUUID->"f5ee5a4d-ec18-4ead-ab16-fd44728f4f28"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825884473595594*^9},
 CellLabel->
  "Out[638]=",ExpressionUUID->"ff5a8131-60c5-4d7d-a92b-e01629a0ed55"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.1314661881993469`", ",", "0.9993159047344324`", ",", 
     RowBox[{"-", "0.8195775579879956`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9993159047344324`", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.8195775579879956`"}], ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825884473796826*^9},
 CellLabel->
  "Out[640]=",ExpressionUUID->"08dfcdd2-9731-4932-a78e-19030bb308cc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.1314661502838135`", ",", "0.9993159174919128`", ",", 
     RowBox[{"-", "0.8195775747299194`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9993159174919128`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.8195775747299194`"}], ",", "0.`", ",", "0.`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825884473807749*^9},
 CellLabel->
  "Out[641]=",ExpressionUUID->"82be0e0a-0ed7-42a4-a58c-fb0bfd5f70e1"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825884473808962*^9},
 CellLabel->
  "Out[642]=",ExpressionUUID->"e2dffdb9-c22a-43fd-a2b3-0d8711122069"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Eat rxn", "Title",
 CellChangeTimes->{{3.825788578505666*^9, 3.8257885793493547`*^9}, {
  3.82580590655658*^9, 3.825805910986578*^9}, {3.825869481768215*^9, 
  3.82586948215512*^9}},ExpressionUUID->"131d7ff7-98cc-4b34-94f8-\
aec9dac227ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatMeans", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<prey\>\"", "->", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], "*", 
             RowBox[{"UnitVector", "[", 
              RowBox[{
               RowBox[{"nv", "+", "nh"}], ",", "iPrey"}], "]"}]}], "&"}], ",", 
           RowBox[{"\"\<nvar\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", 
              RowBox[{"nv", "+", "nh"}]}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<hunter\>\"", "->", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#nvar", "[", 
              RowBox[{"[", 
               RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}], "*", 
             RowBox[{"UnitVector", "[", 
              RowBox[{
               RowBox[{"nv", "+", "nh"}], ",", "iHunter"}], "]"}]}], "&"}], 
           ",", 
           RowBox[{"\"\<nvar\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", 
              RowBox[{"nv", "+", "nh"}]}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<total\>\"", "\[Rule]", 
         RowBox[{"TotalLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<hunter\>\"", ",", "\"\<prey\>\""}], "}"}], "\[Rule]", 
        RowBox[{"\"\<total\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825797322118442*^9, 3.825797400266646*^9}, {
  3.825805793912661*^9, 3.8258058237500896`*^9}, {3.825805913517797*^9, 
  3.825805914780362*^9}, {3.82580623951912*^9, 3.8258062633444347`*^9}, {
  3.825869483941722*^9, 3.8258695451603737`*^9}, {3.825869646462834*^9, 
  3.825869704163336*^9}, {3.825869747381749*^9, 3.825869752449211*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"7d75e48d-5c95-4ef6-a45c-f2c411223800"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeNMoment3", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  
  RowBox[{"FunctionLayer", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2.0"}], "*", 
       RowBox[{"#mu", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"#mu", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "*", 
       RowBox[{"#mu", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"#mu", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"#nvar", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"#mu", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "*", 
       RowBox[{"#nvar", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "k"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"#mu", "[", 
        RowBox[{"[", "k", "]"}], "]"}], "*", 
       RowBox[{"#nvar", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "&"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"\"\<mu\>\"", "\[Rule]", 
     RowBox[{"nv", "+", "nh"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"\"\<nvar\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nv", "+", "nh"}], ",", 
       RowBox[{"nv", "+", "nh"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258717005482693`*^9, 3.825871833366984*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"9e5ef683-1eab-4a81-a919-674ff23bee7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatNVarPreyPrey", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMat", "[", 
          RowBox[{"iPrey", ",", "iPrey"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{
          "nv", ",", "nh", ",", "iPrey", ",", "iPrey", ",", "iHunter"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2.0"}], "*", "#n3"}], "+", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], ")"}]}], 
           "&"}], "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258718688809843`*^9, 3.825871871956662*^9}, {
  3.8258719294305067`*^9, 3.825872128393684*^9}, {3.8258721587200117`*^9, 
  3.825872172380719*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"d5662e30-11c2-40de-b6e8-853fb16f3fcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatNVarHunterHunter", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMat", "[", 
          RowBox[{"iHunter", ",", "iHunter"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{
          "nv", ",", "nh", ",", "iHunter", ",", "iHunter", ",", "iPrey"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2.0", "*", "#n3"}], "+", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], ")"}]}], 
           "&"}], "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258718688809843`*^9, 3.825871871956662*^9}, {
  3.8258719294305067`*^9, 3.825872128393684*^9}, {3.8258721587200117`*^9, 
  3.825872172380719*^9}, {3.825872204702159*^9, 3.825872229728559*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"07ad98d9-c848-430d-81e7-c5511933e15b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatNVarHunterPrey", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"iHunter", ",", "iPrey"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3hhp\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{
          "nv", ",", "nh", ",", "iHunter", ",", "iHunter", ",", "iPrey"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<n3hpp\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{
          "nv", ",", "nh", ",", "iHunter", ",", "iPrey", ",", "iPrey"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "#n3hhp"}], "+", "#n3hpp", "-", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], ")"}]}], 
           "&"}], "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3hhp\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3hhp\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3hpp\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3hpp\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258718688809843`*^9, 3.825871871956662*^9}, {
  3.8258719294305067`*^9, 3.825872128393684*^9}, {3.8258721587200117`*^9, 
  3.825872172380719*^9}, {3.825872204702159*^9, 3.825872329376462*^9}, {
  3.8258723717230263`*^9, 3.825872374215766*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"d1a35e2b-e044-45f6-9112-201694367147"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatNVarLoop", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_", ",", "jSp_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMatPrey\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"iPrey", ",", "jSp"}], "]"}]}], ",", "\[IndentingNewLine]", 
        
        RowBox[{"\"\<unitMatHunter\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"iHunter", ",", "jSp"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{"nv", ",", "nh", ",", "jSp", ",", "iPrey", ",", "iHunter"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "#unitMatPrey"}], "*", "#n3"}], "+", 
            RowBox[{"#unitMatHunter", "*", "#n3"}]}], "&"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMatPrey\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMatPrey\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<unitMatHunter\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMatHunter\>\""}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258718688809843`*^9, 3.825871871956662*^9}, {
  3.8258719294305067`*^9, 3.825872128393684*^9}, {3.8258721587200117`*^9, 
  3.825872172380719*^9}, {3.825872204702159*^9, 3.825872329376462*^9}, {
  3.8258723717230263`*^9, 3.825872374215766*^9}, {3.825872446784706*^9, 
  3.825872594157295*^9}, {3.8258733857064734`*^9, 3.8258733876952257`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"7b270728-7b0f-4e47-a8cd-76f128e8ee9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatNVar", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "layerDefns", ",", "layerName", ",", "layerNames", ",", "layerConn"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerNames", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerDefns", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Prey", "-", "prey"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iPrey", "]"}], "<>", 
       RowBox[{"ToString", "[", "iPrey", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeEatNVarPreyPrey", "[", 
       RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Hunter", "-", "hunter"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iHunter", "]"}], "<>", 
       RowBox[{"ToString", "[", "iHunter", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeEatNVarHunterHunter", "[", 
       RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Hunter", "-", "prey"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iHunter", "]"}], "<>", 
       RowBox[{"ToString", "[", "iPrey", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeEatNVarHunterPrey", "[", 
       RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Loop", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"iPrey", "!=", "jSp"}], "&&", 
           RowBox[{"iHunter", "!=", "jSp"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"layerName", "=", 
            RowBox[{"\"\<d\>\"", "<>", 
             RowBox[{"ToString", "[", "jSp", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
            RowBox[{"makeEatNVarLoop", "[", 
             RowBox[{
             "nv", ",", "nh", ",", "iHunter", ",", "iPrey", ",", "jSp"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"layerNames", ",", "layerName"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Sum", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "\"\<tot\>\"", "]"}], "=", 
      RowBox[{"TotalLayer", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"layerNames", "\[Rule]", 
        RowBox[{"\"\<tot\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<nvarTE\>\"", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<nvar\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nv", "+", "nh"}], ",", 
           RowBox[{"nv", "+", "nh"}]}], "}"}]}], ",", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"nv", "+", "nh"}]}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805291720524*^9, 3.825805407965281*^9}, {
  3.825805540746076*^9, 3.825805707498351*^9}, {3.825805739741499*^9, 
  3.825805761943439*^9}, {3.8258057976722927`*^9, 3.825805820457033*^9}, {
  3.825805963998415*^9, 3.825805971688965*^9}, {3.825872638970333*^9, 
  3.8258728575302687`*^9}, {3.8258737831488657`*^9, 3.8258738408870068`*^9}, {
  3.825873887087625*^9, 3.825873889056589*^9}, {3.825874182704708*^9, 
  3.825874189649164*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"a7baa09f-8f69-4c0e-aad2-0ca9115dcc53"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8258061076842203`*^9, 
  3.825806108010344*^9}},ExpressionUUID->"f515273b-2640-428a-81f7-\
c4b940d9f28e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getNMoment3", "[", 
   RowBox[{"nMoments3_", ",", "idxs_"}], "]"}], ":=", 
  RowBox[{"nMoments3", "[", 
   RowBox[{"Sort", "[", "idxs", "]"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.818266599399235*^9, 3.818266620193*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"35f8c74d-c25e-4608-b494-d6bccfde8499"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeRxnEatNMomentsTE", "[", 
   RowBox[{"nMoments_", ",", "nMoments3_", ",", "iHunter_", ",", "iPrey_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nv", ",", "nh", ",", "te", ",", "mu", ",", "nvar", ",", "n"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", "3"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Means", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mu", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mu", "[", 
       RowBox[{"[", "iPrey", "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mu", "[", 
       RowBox[{"[", "iHunter", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Variances", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nvar", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nvar", "[", 
       RowBox[{"[", 
        RowBox[{"iPrey", ",", "iPrey"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "*", 
        RowBox[{"getNMoment3", "[", 
         RowBox[{"nMoments3", ",", 
          RowBox[{"{", 
           RowBox[{"iPrey", ",", "iPrey", ",", "iHunter"}], "}"}]}], "]"}]}], 
       "+", 
       RowBox[{
        RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nvar", "[", 
       RowBox[{"[", 
        RowBox[{"iHunter", ",", "iHunter"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{"getNMoment3", "[", 
         RowBox[{"nMoments3", ",", 
          RowBox[{"{", 
           RowBox[{"iHunter", ",", "iHunter", ",", "iPrey"}], "}"}]}], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nvar", "[", 
       RowBox[{"[", 
        RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"getNMoment3", "[", 
         RowBox[{"nMoments3", ",", 
          RowBox[{"{", 
           RowBox[{"iHunter", ",", "iHunter", ",", "iPrey"}], "}"}]}], 
         "]"}]}], "+", 
       RowBox[{"getNMoment3", "[", 
        RowBox[{"nMoments3", ",", 
         RowBox[{"{", 
          RowBox[{"iHunter", ",", "iPrey", ",", "iPrey"}], "}"}]}], "]"}], 
       "-", 
       RowBox[{
        RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
        RowBox[{"[", 
         RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nvar", "[", 
       RowBox[{"[", 
        RowBox[{"iPrey", ",", "iHunter"}], "]"}], "]"}], "=", 
      RowBox[{"nvar", "[", 
       RowBox[{"[", 
        RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"iPrey", "!=", "jSp"}], "&&", 
           RowBox[{"iHunter", "\[NotEqual]", "jSp"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"nvar", "[", 
             RowBox[{"[", 
              RowBox[{"iPrey", ",", "jSp"}], "]"}], "]"}], "=", 
            RowBox[{"-", 
             RowBox[{"getNMoment3", "[", 
              RowBox[{"nMoments3", ",", 
               RowBox[{"{", 
                RowBox[{"jSp", ",", "iPrey", ",", "iHunter"}], "}"}]}], 
              "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nvar", "[", 
             RowBox[{"[", 
              RowBox[{"jSp", ",", "iPrey"}], "]"}], "]"}], "=", 
            RowBox[{"nvar", "[", 
             RowBox[{"[", 
              RowBox[{"iPrey", ",", "jSp"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nvar", "[", 
             RowBox[{"[", 
              RowBox[{"iHunter", ",", "jSp"}], "]"}], "]"}], "=", 
            RowBox[{"getNMoment3", "[", 
             RowBox[{"nMoments3", ",", 
              RowBox[{"{", 
               RowBox[{"jSp", ",", "iPrey", ",", "iHunter"}], "}"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"nvar", "[", 
             RowBox[{"[", 
              RowBox[{"jSp", ",", "iHunter"}], "]"}], "]"}], "=", 
            RowBox[{"nvar", "[", 
             RowBox[{"[", 
              RowBox[{"iHunter", ",", "jSp"}], "]"}], "]"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"te", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"te", "[", "\"\<muTE\>\"", "]"}], "=", "mu"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"te", "[", "\"\<nvarTE\>\"", "]"}], "=", "nvar"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "te", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.818266371165379*^9, 3.81826658543743*^9}, {
   3.8182666288027363`*^9, 3.818266833067251*^9}, {3.818266972075699*^9, 
   3.818266976527244*^9}, 3.818267208238612*^9, {3.8188128353539333`*^9, 
   3.8188128518246937`*^9}, 3.825872962985798*^9, {3.825873773193742*^9, 
   3.825873775949253*^9}, {3.825873811666711*^9, 3.82587383552676*^9}, {
   3.825873893521262*^9, 3.8258738957123737`*^9}, {3.8258741745520983`*^9, 
   3.8258741798423643`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"b9fafd31-93bc-4203-80c8-cce439a97ac9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMoments", "=", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "+=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "3"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", "=", 
   RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nvar", "=", 
    RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nMoments3", "=", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nMoments3Test", "=", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"nMoments3", "[", 
              RowBox[{"{", 
               RowBox[{"in", ",", "jn", ",", "kn"}], "}"}], "]"}], "=", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], "*", 
               RowBox[{"mu", "[", 
                RowBox[{"[", "in", "]"}], "]"}], "*", 
               RowBox[{"mu", "[", 
                RowBox[{"[", "jn", "]"}], "]"}], "*", 
               RowBox[{"mu", "[", 
                RowBox[{"[", "kn", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mu", "[", 
                RowBox[{"[", "in", "]"}], "]"}], "*", 
               RowBox[{"nvar", "[", 
                RowBox[{"[", 
                 RowBox[{"jn", ",", "kn"}], "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mu", "[", 
                RowBox[{"[", "jn", "]"}], "]"}], "*", 
               RowBox[{"nvar", "[", 
                RowBox[{"[", 
                 RowBox[{"in", ",", "kn"}], "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"mu", "[", 
                RowBox[{"[", "kn", "]"}], "]"}], "*", 
               RowBox[{"nvar", "[", 
                RowBox[{"[", 
                 RowBox[{"in", ",", "jn"}], "]"}], "]"}]}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nMoments3Test", "[", 
              RowBox[{"{", 
               RowBox[{"in", ",", "jn", ",", "kn"}], "}"}], "]"}], "=", 
             RowBox[{
              RowBox[{"makeNMoment3", "[", 
               RowBox[{"nv", ",", "nh", ",", "in", ",", "jn", ",", "kn"}], 
               "]"}], "[", "nMoments", "]"}]}], ";"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"kn", ",", "jn", ",", 
             RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"jn", ",", "in", ",", 
          RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}], ";"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"in", ",", 
       RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Ensure", " ", "nMoments3", " ", "are", " ", "the", " ", "same"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"truths", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"nMoments3", "[", "k", "]"}], "-", 
        RowBox[{"nMoments3Test", "[", "k", "]"}]}], "]"}], "<", 
      SuperscriptBox["10", 
       RowBox[{"-", "5"}]]}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Keys", "[", "nMoments3", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"!", 
  RowBox[{"MemberQ", "[", 
   RowBox[{"truths", ",", "False"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8258735400395813`*^9, 3.82587355301689*^9}, {
  3.8258736279531*^9, 3.8258737488377237`*^9}, {3.825874157178917*^9, 
  3.825874166469758*^9}},
 CellLabel->
  "In[599]:=",ExpressionUUID->"10017863-8a3e-4ed4-956e-8299de717488"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.82587372511194*^9, 3.825873752108346*^9}, 
   3.825873807811157*^9, 3.825874169775366*^9, 3.825884429885668*^9},
 CellLabel->
  "Out[609]=",ExpressionUUID->"9b8a4009-2ce0-4ac7-a4d2-c5ae0942a3da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nv", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nh", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iHunter", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iPrey", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outTrue", "=", 
   RowBox[{"makeRxnEatNMomentsTE", "[", 
    RowBox[{"nMoments", ",", "nMoments3", ",", "iHunter", ",", "iPrey"}], 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeEatMeans", "[", 
    RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"muTrue", "=", 
  RowBox[{"outTrue", "[", "\"\<muTE\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"muTest", "=", 
  RowBox[{"lyr", "[", "nMoments", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{"muTest", "-", "muTrue"}], "]"}], "]"}], "<", 
   SuperscriptBox["10", 
    RowBox[{"-", "5"}]]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeEatNVar", "[", 
    RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nvarTrue", "=", 
  RowBox[{"outTrue", "[", "\"\<nvarTE\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nvarTest", "=", 
  RowBox[{"lyr", "[", "nMoments", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"nvarTest", "-", "nvarTrue"}], "]"}], "]"}], "<", 
  SuperscriptBox["10", 
   RowBox[{"-", "5"}]]}]}], "Input",
 CellChangeTimes->{{3.825806122120771*^9, 3.825806158807034*^9}, {
  3.8258062774032707`*^9, 3.825806385537447*^9}, {3.8258695881480227`*^9, 
  3.825869620092243*^9}, {3.825872987227282*^9, 3.825873025987897*^9}, {
  3.82587305757127*^9, 3.825873073265671*^9}, {3.82587353477721*^9, 
  3.825873535795126*^9}},
 CellLabel->
  "In[610]:=",ExpressionUUID->"dee9f6bb-6a9c-4cbe-8d95-14180ef4d6a3"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"muTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1.236239679519663`", ",", 
      RowBox[{"-", "1.236239679519663`"}], ",", "0"}], "}"}]}], ",", 
   RowBox[{"\<\"nvarTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "3.4719984396668933`"}], ",", "4.070276698414523`", ",", 
        
        RowBox[{"-", "0.537763035016075`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"4.070276698414523`", ",", 
        RowBox[{"-", "4.668554957162154`"}], ",", "0.537763035016075`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.537763035016075`"}], ",", "0.537763035016075`", ",", 
        "0"}], "}"}]}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825869620424415*^9, 3.825869710918573*^9, 3.825869755261307*^9, {
   3.8258729956825027`*^9, 3.825873026265738*^9}, 3.825873073448271*^9, 
   3.825873457537591*^9, 3.825873752127921*^9, {3.8258738078320427`*^9, 
   3.825873843961431*^9}, 3.825873898587638*^9, {3.8258741703480453`*^9, 
   3.8258741933988037`*^9}, 3.82588442990973*^9},
 CellLabel->
  "Out[614]=",ExpressionUUID->"2d373fec-1bde-4933-8249-e9022b416b74"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.236239679519663`", ",", 
   RowBox[{"-", "1.236239679519663`"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825869620424415*^9, 3.825869710918573*^9, 3.825869755261307*^9, {
   3.8258729956825027`*^9, 3.825873026265738*^9}, 3.825873073448271*^9, 
   3.825873457537591*^9, 3.825873752127921*^9, {3.8258738078320427`*^9, 
   3.825873843961431*^9}, 3.825873898587638*^9, {3.8258741703480453`*^9, 
   3.8258741933988037`*^9}, 3.8258844300568333`*^9},
 CellLabel->
  "Out[616]=",ExpressionUUID->"333e4bac-0ff5-4d3a-a4a2-78becd84e97d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.2362396717071533`", ",", 
   RowBox[{"-", "1.2362396717071533`"}], ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825869620424415*^9, 3.825869710918573*^9, 3.825869755261307*^9, {
   3.8258729956825027`*^9, 3.825873026265738*^9}, 3.825873073448271*^9, 
   3.825873457537591*^9, 3.825873752127921*^9, {3.8258738078320427`*^9, 
   3.825873843961431*^9}, 3.825873898587638*^9, {3.8258741703480453`*^9, 
   3.8258741933988037`*^9}, 3.825884430068944*^9},
 CellLabel->
  "Out[617]=",ExpressionUUID->"dda594e4-c354-4b2f-b6ef-dac850b684e1"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825869620424415*^9, 3.825869710918573*^9, 3.825869755261307*^9, {
   3.8258729956825027`*^9, 3.825873026265738*^9}, 3.825873073448271*^9, 
   3.825873457537591*^9, 3.825873752127921*^9, {3.8258738078320427`*^9, 
   3.825873843961431*^9}, 3.825873898587638*^9, {3.8258741703480453`*^9, 
   3.8258741933988037`*^9}, 3.825884430070256*^9},
 CellLabel->
  "Out[618]=",ExpressionUUID->"87981f96-9b95-46ce-bdf1-3bd2d847637a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.4719984396668933`"}], ",", "4.070276698414523`", ",", 
     RowBox[{"-", "0.537763035016075`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.070276698414523`", ",", 
     RowBox[{"-", "4.668554957162154`"}], ",", "0.537763035016075`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.537763035016075`"}], ",", "0.537763035016075`", ",", 
     "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825869620424415*^9, 3.825869710918573*^9, 3.825869755261307*^9, {
   3.8258729956825027`*^9, 3.825873026265738*^9}, 3.825873073448271*^9, 
   3.825873457537591*^9, 3.825873752127921*^9, {3.8258738078320427`*^9, 
   3.825873843961431*^9}, 3.825873898587638*^9, {3.8258741703480453`*^9, 
   3.8258741933988037`*^9}, 3.825884431997281*^9},
 CellLabel->
  "Out[620]=",ExpressionUUID->"fc02838d-c837-47cf-baa5-b7278d4731d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.471998453140259`"}], ",", "4.070276260375977`", ",", 
     RowBox[{"-", "0.5377629399299622`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.070276260375977`", ",", 
     RowBox[{"-", "4.668554782867432`"}], ",", "0.5377629399299622`"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.5377629399299622`"}], ",", "0.5377629399299622`", ",", 
     "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825869620424415*^9, 3.825869710918573*^9, 3.825869755261307*^9, {
   3.8258729956825027`*^9, 3.825873026265738*^9}, 3.825873073448271*^9, 
   3.825873457537591*^9, 3.825873752127921*^9, {3.8258738078320427`*^9, 
   3.825873843961431*^9}, 3.825873898587638*^9, {3.8258741703480453`*^9, 
   3.8258741933988037`*^9}, 3.825884432043146*^9},
 CellLabel->
  "Out[621]=",ExpressionUUID->"e562ae58-c875-4c03-a1fa-d77e5c20576d"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825869620424415*^9, 3.825869710918573*^9, 3.825869755261307*^9, {
   3.8258729956825027`*^9, 3.825873026265738*^9}, 3.825873073448271*^9, 
   3.825873457537591*^9, 3.825873752127921*^9, {3.8258738078320427`*^9, 
   3.825873843961431*^9}, 3.825873898587638*^9, {3.8258741703480453`*^9, 
   3.8258741933988037`*^9}, 3.825884432045186*^9},
 CellLabel->
  "Out[622]=",ExpressionUUID->"3217e5a3-bf50-4f65-9a2f-bd6039e5e215"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert NMomentsTE to MomentsTE", "Title",
 CellChangeTimes->{{3.825874426178727*^9, 
  3.8258744349291677`*^9}},ExpressionUUID->"178faf1c-0ac2-49a8-94b0-\
14611eacc4dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertNMomentsTEtoMomentsTE", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<reshapeMu\>\"", "\[Rule]", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<reshapeMuTE\>\"", "\[Rule]", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<negkpv\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"#muTE", ".", 
               RowBox[{"Transpose", "[", "#mu", "]"}]}]}], "-", 
             RowBox[{"#mu", ".", 
              RowBox[{"Transpose", "[", "#muTE", "]"}]}]}], "&"}], ",", 
           RowBox[{"\"\<mu\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}]}], ",", 
           RowBox[{"\"\<muTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varTE\>\"", "\[Rule]", 
         RowBox[{"TotalLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<mu\>\"", "]"}], "->", 
         RowBox[{"\"\<reshapeMu\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<negkpv\>\"", ",", "\"\<mu\>\""}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}], "->", 
         RowBox[{"\"\<reshapeMuTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<negkpv\>\"", ",", "\"\<muTE\>\""}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NetPort", "[", "\"\<nvarTE\>\"", "]"}], ",", 
           "\"\<negkpv\>\""}], "}"}], "->", 
         RowBox[{"\"\<varTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", "\"\<varTE\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<muTEout\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<muTE\>\"", "\[Rule]", 
         RowBox[{"nv", "+", "nh"}]}], ",", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"nv", "+", "nh"}]}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825874436358872*^9, 3.825874460536234*^9}, {
  3.8258744928261347`*^9, 3.8258746723175783`*^9}, {3.825874776474001*^9, 
  3.825874786494669*^9}, {3.825882136384387*^9, 3.825882136803739*^9}, {
  3.825882208118986*^9, 3.8258822103778553`*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"7c1402f3-a929-47a5-b264-de2597d7b25a"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.825874684553235*^9, 
  3.825874684960331*^9}},ExpressionUUID->"80326d67-4470-457c-87de-\
831e19358e86"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convertNMomentsTEtoMomentsTE", "[", 
   RowBox[{"moments_", ",", "rxnNMomentsTE_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rxnMomentsTE", ",", "kpv"}], "}"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rxnMomentsTE", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rxnMomentsTE", "[", "\"\<muTE\>\"", "]"}], "=", 
      RowBox[{"rxnNMomentsTE", "[", "\"\<muTE\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"kpv", "=", 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"rxnNMomentsTE", "[", "\"\<muTE\>\"", "]"}], ",", 
         RowBox[{"moments", "[", "\"\<mu\>\"", "]"}]}], "]"}], "+", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"moments", "[", "\"\<mu\>\"", "]"}], ",", 
         RowBox[{"rxnNMomentsTE", "[", "\"\<muTE\>\"", "]"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rxnMomentsTE", "[", "\"\<varTE\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"rxnNMomentsTE", "[", "\"\<nvarTE\>\"", "]"}], "-", "kpv"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "rxnMomentsTE", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[36]:=",ExpressionUUID->"ccc9551b-6206-4375-932c-2a216f895d4b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"moments", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{"\"\<mu\>\"", "\[Rule]", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"nv", "+", "nh"}]}], "]"}]}], "\[IndentingNewLine]", "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nv", "+", "nh"}], ",", 
       RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnNMomentsTE", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<muTE\>\"", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"nv", "+", "nh"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<nvarTE\>\"", "\[Rule]", 
      RowBox[{"x", "+", 
       RowBox[{"Transpose", "[", "x", "]"}]}]}]}], "\[IndentingNewLine]", 
    "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"momentsTEtrue", "=", 
  RowBox[{"convertNMomentsTEtoMomentsTE", "[", 
   RowBox[{"moments", ",", "rxnNMomentsTE"}], "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"momentsTEtest", "=", 
   RowBox[{
    RowBox[{"makeConvertNMomentsTEtoMomentsTE", "[", 
     RowBox[{"nv", ",", "nh"}], "]"}], "[", 
    RowBox[{"Join", "[", 
     RowBox[{"moments", ",", "rxnNMomentsTE"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Values", "[", "momentsTEtrue", "]"}], "]"}], "-", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Values", "[", "momentsTEtest", "]"}], "]"}]}], "]"}], "]"}], 
  "<", 
  SuperscriptBox["10", 
   RowBox[{"-", "5"}]]}]}], "Input",
 CellChangeTimes->{{3.825874699589093*^9, 3.825874754371224*^9}, {
  3.825874797397565*^9, 3.8258748416577997`*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"e9489f8e-0ae2-4956-a070-ea18e701ccd9"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"muTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "0.18225439605630323`", ",", "0.11449280465662381`", ",", 
      "0.9890096318994499`"}], "}"}]}], ",", 
   RowBox[{"\<\"varTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.4279249010293227`"}], ",", "1.1118891044043182`", ",", 
        RowBox[{"-", "0.5171200554338654`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.1118891044043182`", ",", "0.9288708257424342`", ",", 
        RowBox[{"-", "0.1800592427516471`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5171200554338654`"}], ",", 
        RowBox[{"-", "0.1800592427516471`"}], ",", "1.3990445065403159`"}], 
       "}"}]}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.825874754632194*^9, {3.8258747890021267`*^9, 3.825874810539715*^9}, 
   3.8258748419622307`*^9},
 CellLabel->
  "Out[397]=",ExpressionUUID->"31ced27e-790e-4013-a8fa-a806ec0588e6"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"muTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "0.1822543889284134`", ",", "0.11449280381202698`", ",", 
      "0.9890096187591553`"}], "}"}]}], ",", 
   RowBox[{"\<\"varTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.4279248714447021`"}], ",", "1.111889123916626`", ",", 
        
        RowBox[{"-", "0.5171200633049011`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.111889123916626`", ",", "0.9288707971572876`", ",", 
        RowBox[{"-", "0.18005922436714172`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5171200633049011`"}], ",", 
        RowBox[{"-", "0.18005922436714172`"}], ",", "1.3990445137023926`"}], 
       "}"}]}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.825874754632194*^9, {3.8258747890021267`*^9, 3.825874810539715*^9}, 
   3.8258748421550703`*^9},
 CellLabel->
  "Out[398]=",ExpressionUUID->"61a52916-399f-436c-9b25-cd475a724531"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.825874754632194*^9, {3.8258747890021267`*^9, 3.825874810539715*^9}, 
   3.8258748421562967`*^9},
 CellLabel->
  "Out[399]=",ExpressionUUID->"3ad3acec-a32b-484a-9768-ce1e970205c6"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert MomentsTE to ParamMomentsTE", "Title",
 CellChangeTimes->{{3.825875081467132*^9, 
  3.8258750927691927`*^9}},ExpressionUUID->"e25058ae-c753-4a1b-9594-\
796ef13b9b97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertMomentsTEtoParamMomentsTE", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "name", ",", "layerConn"}], "}"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<muvTE\>\"", "\[Rule]", 
         RowBox[{"PartLayer", "[", 
          RowBox[{"1", ";;", "nv"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<muhTE\>\"", "\[Rule]", 
         RowBox[{"PartLayer", "[", 
          RowBox[{
           RowBox[{"nv", "+", "1"}], ";;"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varvhTE\>\"", "\[Rule]", 
         RowBox[{"PartLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"nv", "+", "1"}], ";;"}], ",", 
            RowBox[{";;", "nv"}]}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varvbarTEpart\>\"", "\[Rule]", 
         RowBox[{"PartLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{";;", "nv"}], ",", 
            RowBox[{";;", "nv"}]}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varvbarTEdiagsum\>\"", "->", 
         RowBox[{"makeSumDiagonal", "[", "nv", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varhTE\>\"", "\[Rule]", 
         RowBox[{"PartLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"nv", "+", "1"}], ";;"}], ",", 
            RowBox[{
             RowBox[{"nv", "+", "1"}], ";;"}]}], "}"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<muvTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", "\"\<muvTE\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<muhTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", "\"\<muhTE\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<varvhTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", "\"\<varvhTE\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<varhTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", "\"\<varhTE\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<varvbarTEpart\>\"", "->", 
          RowBox[{"\"\<varvbarTEdiagsum\>\"", "\[Rule]", 
           RowBox[{"NetPort", "[", "\"\<varvbarTE\>\"", "]"}]}]}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258750932569532`*^9, 3.825875226498475*^9}, {
  3.82587530438533*^9, 3.825875472106812*^9}, {3.825875504285183*^9, 
  3.8258755641201*^9}, {3.825881448716752*^9, 3.825881503625291*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"14a8915c-e374-4633-88f8-32f1ae650868"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798199230728*^9, 
  3.83079819951702*^9}},ExpressionUUID->"74495b95-407c-496e-946d-\
7893d79ec206"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertMomentsTEtoParamMomentsTE", "[", 
   RowBox[{"nv", ",", "nh"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8258754482803173`*^9, 3.825875459771105*^9}, 
   3.830798183017777*^9},ExpressionUUID->"f4475bfb-7978-45cb-b142-\
8af779061fb9"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert ParamMomentsTE to ParamsTE", "Title",
 CellChangeTimes->{{3.8258755910703506`*^9, 
  3.825875597279234*^9}},ExpressionUUID->"31199eb2-30b4-4f5f-b57e-\
7408ae0ae079"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeSumDiagonal", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<diag\>\"", "->", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", "*", 
             RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}], "&"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<tot\>\"", "\[Rule]", 
         RowBox[{"SummationLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<diag\>\"", "\[Rule]", "\"\<tot\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825881142260428*^9, 3.825881223668807*^9}, {
  3.825881340520232*^9, 3.825881394784629*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"f6e3113f-af9b-4d05-9b6a-e7175168b9d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertParamMomentsTEtoParamsTE", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
         RowBox[{"inverse1Layer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<bTE\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#muvTE", "-", 
             RowBox[{
              RowBox[{"Transpose", "[", "#varvhTE", "]"}], ".", "#varhInv", 
              ".", "#muh"}], "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "#varvh", "]"}], ".", "#varhInv", ".",
               "#varhTE", ".", "#varhInv", ".", "#muh"}], "-", 
             RowBox[{
              RowBox[{"Transpose", "[", "#varvh", "]"}], ".", "#varhInv", ".",
               "#muhTE"}]}], "&"}], ",", 
           RowBox[{"\"\<muvTE\>\"", "\[Rule]", "nv"}], ",", 
           RowBox[{"\"\<varvhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<muh\>\"", "\[Rule]", "nh"}], ",", 
           RowBox[{"\"\<varvh\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<muhTE\>\"", "\[Rule]", "nh"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<wtTE\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{
              "#varhInv", ".", "#varhTE", ".", "#varhInv", ".", "#varvh"}]}], 
             "+", 
             RowBox[{"#varhInv", ".", "#varvhTE"}]}], "&"}], ",", 
           RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<varhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<varvh\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varvhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2TEmat\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "#varvhTE", "]"}], ".", "#varhInv", 
              ".", "#varvh"}], "-", 
             RowBox[{
              RowBox[{"Transpose", "[", "#varvh", "]"}], ".", "#varhInv", ".",
               "#varhTE", ".", "#varhInv", ".", "#varvh"}], "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "#varvh", "]"}], ".", "#varhInv", ".",
               "#varvhTE"}]}], "&"}], ",", 
           RowBox[{"\"\<varvhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<varvh\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2TEsumdiag\>\"", "\[Rule]", 
         RowBox[{"makeSumDiagonal", "[", "nv", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2TE\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#varvbarTE", "/", "nv"}], "-", 
            RowBox[{"#sig2TEsumdiag", "/", "nv"}]}], "&"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muhTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<muhTE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varhTE\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", "\"\<varhTE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2TEmat\>\"", "->", 
         RowBox[{"\"\<sig2TEsumdiag\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<sig2TE\>\"", ",", "\"\<sig2TEsumdiag\>\""}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2TE\>\"", "->", 
         RowBox[{"NetPort", "[", "\"\<sig2TE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<bTE\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<bTE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<wtTE\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<wtTE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<bTE\>\"", ",", "\"\<varhInv\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<wtTE\>\"", ",", "\"\<varhInv\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<sig2TEmat\>\"", ",", "\"\<varhInv\>\""}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh\>\"", "]"}], "->", 
         "\"\<varhInv\>\""}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825875598347383*^9, 3.825875619678629*^9}, {
  3.825880835777158*^9, 3.825881093362678*^9}, {3.825881541104669*^9, 
  3.825881852933859*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"7cf64145-d658-4858-a529-49c39d07fdd8"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798190412318*^9, 
  3.8307981906844673`*^9}},ExpressionUUID->"4d29468c-1414-4976-a216-\
e62757ceb110"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertParamMomentsTEtoParamsTE", "[", 
   RowBox[{"nv", ",", "nh"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.82588100602553*^9, 3.825881013455667*^9}, 
   3.8307981897144203`*^9},ExpressionUUID->"d9fcec03-07db-46a2-a77a-\
3eb675b7290d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert ParamsTE to Params0TE", "Title",
 CellChangeTimes->{{3.826031392296721*^9, 
  3.826031399459671*^9}},ExpressionUUID->"bb547e74-d166-4564-93f4-\
e6628f3a91dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertParamsTEtoParams0TE", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<varh1Inv\>\"", "\[Rule]", 
         RowBox[{"inverse1Layer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<b2TE\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#fb1", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "#fwt1", "]"}], ".", "#muh1"}], "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "#wt1", "]"}], ".", "#fmuh1"}]}], 
            "&"}], ",", 
           RowBox[{"\"\<fb1\>\"", "\[Rule]", "nv"}], ",", 
           RowBox[{"\"\<fwt1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<muh1\>\"", "\[Rule]", "nh"}], ",", 
           RowBox[{"\"\<wt1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<fmuh1\>\"", "\[Rule]", "nh"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<wt2TE\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"0.5", "*", 
              RowBox[{
               RowBox[{"Sqrt", "[", "#varh1Inv", "]"}], ".", "#fvarh1", ".", 
               "#wt1"}]}], "+", 
             RowBox[{
              RowBox[{"Sqrt", "[", "#varh1", "]"}], ".", "#fwt1"}]}], "&"}], 
           ",", 
           RowBox[{"\"\<varh1Inv\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<fvarh1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<wt1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varh1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<fwt1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh1\>\"", "]"}], "\[Rule]", 
         "\"\<varh1Inv\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<varh1Inv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<wt2TE\>\"", ",", "\"\<varh1Inv\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<b2TE\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<b2TE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<wt2TE\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<wt2TE\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826031408895294*^9, 3.826031411580204*^9}, 
   3.826031612213122*^9, {3.8260316987798843`*^9, 3.8260318173748837`*^9}, {
   3.826031852890449*^9, 3.8260318672296762`*^9}, {3.826031930583096*^9, 
   3.826032012819419*^9}, {3.826032049907668*^9, 3.8260320812187147`*^9}, {
   3.82603214059099*^9, 3.826032142046898*^9}, {3.826032175304772*^9, 
   3.826032249575116*^9}, {3.8260325825669813`*^9, 3.8260325831830273`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"5841f285-3080-4ef1-8e11-652fe0a21fb4"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.826032354125846*^9, 
  3.826032354489985*^9}},ExpressionUUID->"8dccf02d-0f17-4355-9331-\
8d93182f1320"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convertParamsTELatentSpace", "[", 
   RowBox[{
   "params1_", ",", "params1TE_", ",", "muh2_", ",", "varh2_", ",", "fmuh2_", 
    ",", "fvarh2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fb1", ",", "fwt1", ",", "fmuh1", ",", "fvarh1", ",", "fb2", ",", "muh1",
       ",", "wt1", ",", "varh1", ",", "fwt2"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fb1", "=", 
      RowBox[{"params1TE", "[", "\"\<fb\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fwt1", "=", 
      RowBox[{"params1TE", "[", "\"\<fwt\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fmuh1", "=", 
      RowBox[{"params1TE", "[", "\"\<fmuh\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fvarh1", "=", 
      RowBox[{"params1TE", "[", "\"\<fvarh\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"muh1", "=", 
      RowBox[{"params1", "[", "\"\<muh\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wt1", "=", 
      RowBox[{"params1", "[", "\"\<wt\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"varh1", "=", 
      RowBox[{"params1", "[", "\"\<varh\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fb2", "=", 
      RowBox[{"fb1", "+", 
       RowBox[{
        RowBox[{"Transpose", "[", "fwt1", "]"}], ".", "muh1"}], "+", 
       RowBox[{
        RowBox[{"Transpose", "[", "wt1", "]"}], ".", "fmuh1"}], "-", 
       RowBox[{
        RowBox[{"Transpose", "[", "fwt1", "]"}], ".", 
        RowBox[{"Sqrt", "[", "varh1", "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], ".", "muh2"}], "-", 
       RowBox[{"0.5", "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "wt1", "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"Sqrt", "[", "varh1", "]"}], "]"}], ".", "fvarh1", ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], ".", "muh2"}]}], "+", 
       RowBox[{"0.5", "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "wt1", "]"}], ".", 
         RowBox[{"Sqrt", "[", "varh1", "]"}], ".", 
         SuperscriptBox[
          RowBox[{"Inverse", "[", 
           RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], "3"], ".", "fvarh2", 
         ".", "muh2"}]}], "-", 
       RowBox[{
        RowBox[{"Transpose", "[", "wt1", "]"}], ".", 
        RowBox[{"Sqrt", "[", "varh1", "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], ".", "fmuh2"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fwt2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.5"}], "*", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Inverse", "[", 
           RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], "3"], ".", "fvarh2", 
         ".", 
         RowBox[{"Sqrt", "[", "varh1", "]"}], ".", "wt1"}]}], "+", 
       RowBox[{"0.5", "*", 
        RowBox[{
         RowBox[{"Inverse", "[", 
          RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"Sqrt", "[", "varh1", "]"}], "]"}], ".", "fvarh1", ".", 
         "wt1"}]}], "+", 
       RowBox[{
        RowBox[{"Inverse", "[", 
         RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], ".", 
        RowBox[{"Sqrt", "[", "varh1", "]"}], ".", "fwt1"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"makeParamsTE", "[", 
       RowBox[{"fwt2", ",", "fb2", ",", 
        RowBox[{"params1TE", "[", "\"\<fsig2\>\"", "]"}], ",", "fmuh2", ",", 
        "fvarh2"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[41]:=",ExpressionUUID->"6edff6a5-6791-4af3-b9ed-d8c2d884a2a3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"params1test", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<wt\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nh", ",", "nv"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<b\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "nv"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<muh\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "nh"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nh", ",", "nh"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<sig2\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params1TEtest", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<fwt\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nh", ",", "nv"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fb\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "nv"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fmuh\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "nh"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fvarh\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nh", ",", "nh"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fsig2\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muh2test", "=", 
   RowBox[{"{", "0", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh2test", "=", 
   RowBox[{"{", 
    RowBox[{"{", "1", "}"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fmuh2test", "=", 
   RowBox[{"{", "0", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fvarh2test", "=", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valsTrue", "=", 
   RowBox[{"convertParamsTELatentSpace", "[", 
    RowBox[{
    "params1test", ",", "params1TEtest", ",", "muh2test", ",", "varh2test", 
     ",", "fmuh2test", ",", "fvarh2test"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convertParamsTEtoParams0TE", "=", 
   RowBox[{"makeConvertParamsTEtoParams0TE", "[", 
    RowBox[{"nv", ",", "nh"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valsTest", "=", 
   RowBox[{"convertParamsTEtoParams0TE", "[", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<varh1\>\"", "\[Rule]", 
       RowBox[{"params1test", "[", "\"\<varh\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<fvarh1\>\"", "\[Rule]", 
       RowBox[{"params1TEtest", "[", "\"\<fvarh\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<wt1\>\"", "\[Rule]", 
       RowBox[{"params1test", "[", "\"\<wt\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<fwt1\>\"", "\[Rule]", 
       RowBox[{"params1TEtest", "[", "\"\<fwt\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<muh1\>\"", "\[Rule]", 
       RowBox[{"params1test", "[", "\"\<muh\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<fmuh1\>\"", "\[Rule]", 
       RowBox[{"params1TEtest", "[", "\"\<fmuh\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<fb1\>\"", "\[Rule]", 
       RowBox[{"params1TEtest", "[", "\"\<fb\>\"", "]"}]}]}], 
     "\[IndentingNewLine]", "|>"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valsTrue", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"valsTrue", "[", "\"\<fwt\>\"", "]"}], ",", 
      RowBox[{"valsTrue", "[", "\"\<fb\>\"", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valsTest", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"valsTest", "[", "\"\<wt2TE\>\"", "]"}], ",", 
      RowBox[{"valsTest", "[", "\"\<b2TE\>\"", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"valsTest", "-", "valsTrue"}], "]"}], "]"}], "<", 
  SuperscriptBox["10", 
   RowBox[{"-", "6"}]]}]}], "Input",
 CellChangeTimes->{{3.826032361289361*^9, 3.8260324443248158`*^9}, {
  3.826032536026856*^9, 3.8260325455535097`*^9}, {3.826032642797127*^9, 
  3.826032756126937*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"6412a258-f6c8-4737-ae86-729cd1a2560c"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"fwt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0.38600846129371913`", ",", 
       RowBox[{"-", "0.658030317220932`"}]}], "}"}], "}"}]}], ",", 
   RowBox[{"\<\"fb\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.23153148842478002`"}], ",", 
      RowBox[{"-", "0.10302240937277807`"}]}], "}"}]}], ",", 
   RowBox[{"\<\"fsig2\"\>", "\[Rule]", "0.7586878136699968`"}], ",", 
   RowBox[{"\<\"fmuh\"\>", "\[Rule]", 
    RowBox[{"{", "0", "}"}]}], ",", 
   RowBox[{"\<\"fvarh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.8260324383520937`*^9, 3.826032444835919*^9}, 
   3.826032545792609*^9, {3.82603264317659*^9, 3.8260327013246317`*^9}, {
   3.8260327527064457`*^9, 3.826032756764468*^9}},
 CellLabel->
  "Out[277]=",ExpressionUUID->"d5db4557-276b-4621-8160-91693d2e1795"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"b2TE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.23153147101402283`"}], ",", 
      RowBox[{"-", "0.10302242636680603`"}]}], "}"}]}], ",", 
   RowBox[{"\<\"wt2TE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0.38600847125053406`", ",", 
       RowBox[{"-", "0.6580303311347961`"}]}], "}"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.8260324383520937`*^9, 3.826032444835919*^9}, 
   3.826032545792609*^9, {3.82603264317659*^9, 3.8260327013246317`*^9}, {
   3.8260327527064457`*^9, 3.826032757049921*^9}},
 CellLabel->
  "Out[279]=",ExpressionUUID->"ffbdb438-8b61-4557-8a0a-34921cec75ff"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8260324383520937`*^9, 3.826032444835919*^9}, 
   3.826032545792609*^9, {3.82603264317659*^9, 3.8260327013246317`*^9}, {
   3.8260327527064457`*^9, 3.8260327570510902`*^9}},
 CellLabel->
  "Out[282]=",ExpressionUUID->"44421157-bbbb-4c92-b707-2ec29cf2aa7c"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert NMomentsTE to ParamsTE", "Title",
 CellChangeTimes->{{3.82588190277271*^9, 3.825881908409477*^9}, {
  3.826032445149764*^9, 
  3.826032445807981*^9}},ExpressionUUID->"2b5c0ae5-9a25-49d7-bab4-\
530c7ebb452e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertNMomentsTEtoParams0TE", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<convertNMomentsToMomentsTE\>\"", "->", 
         RowBox[{"makeConvertNMomentsTEtoMomentsTE", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertMomentsTEtoParamMomentsTE\>\"", "->", 
         RowBox[{"makeConvertMomentsTEtoParamMomentsTE", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertParamMomentsToParamsTE\>\"", "\[Rule]", 
         RowBox[{"makeConvertParamMomentsTEtoParamsTE", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", "->", 
         RowBox[{"makeConvertParamsTEtoParams0TE", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertNMomentsToMomentsTE\>\"", ",", "\"\<varTE\>\""}], "]"}],
          "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", "\"\<varTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertNMomentsToMomentsTE\>\"", ",", "\"\<muTEout\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", "\"\<muTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", 
           "\"\<varvhTE\>\""}], "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<varvhTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", 
           "\"\<varvbarTE\>\""}], "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<varvbarTE\>\""}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", "\"\<varhTE\>\""}],
           "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<varhTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", "\"\<muvTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<muvTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", "\"\<muhTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<muhTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<wt\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<wt1\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<varh1\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muh\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<muh1\>\""}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<wtTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<fwt1\>\""}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<varhTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<fvarh1\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<muhTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<fmuh1\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<bTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<fb1\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<wt2TE\>\""}], "]"}],
          "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<wtTE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<b2TE\>\""}],
           "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<bTE\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825881917948443*^9, 3.825882112977564*^9}, {
  3.8258821631211777`*^9, 3.825882192063698*^9}, {3.825882233007422*^9, 
  3.825882262566679*^9}, {3.8260328181922817`*^9, 3.8260328333495617`*^9}, {
  3.826032890401095*^9, 3.826033050379689*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"2f61d3be-008b-4fc5-9873-db08138b0481"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798208922038*^9, 
  3.830798209243051*^9}},ExpressionUUID->"11e8321e-134c-47e1-b21a-\
a751cec7c4e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertNMomentsTEtoParams0TE", "[", 
   RowBox[{"nv", ",", "nh"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.8258819961449747`*^9, 3.825882000177561*^9}, 
   3.826032846251297*^9, 
   3.830798210342513*^9},ExpressionUUID->"134e6634-9a76-40f7-82e0-\
fb2f47e0da82"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rxns", "Title",
 CellChangeTimes->{{3.825882774107902*^9, 
  3.825882774567284*^9}},ExpressionUUID->"75c1fcef-1813-4085-8502-\
bba2286b70fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeRxnParams0TE", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "rxnSpec_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "layerDefns", ",", "layerConn", ",", "iHunter", ",", "iPrey", ",", 
      "iSp"}], "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<convertNMomentsTEtoParams0TE\>\"", "->", 
         RowBox[{"makeConvertNMomentsTEtoParams0TE", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertParamsToNMoments\>\"", "->", 
         RowBox[{"makeGraphConvertParamsToNMoments", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<muTE\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertNMomentsTEtoParams0TE\>\"", ",", "\"\<muTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<nvarTE\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertNMomentsTEtoParams0TE\>\"", ",", "\"\<nvarTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<nvar\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<nvarTE\>\"", ",", "\"\<nvar\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<mu\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<nvarTE\>\"", ",", "\"\<mu\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<mu\>\""}], 
          "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertNMomentsTEtoParams0TE\>\"", ",", "\"\<mu\>\""}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<varvh\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertNMomentsTEtoParams0TE\>\"", ",", "\"\<varvh\>\""}], 
          "]"}]}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Reaction", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rxnSpec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<eat\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iHunter", "=", 
         RowBox[{"rxnSpec", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"iPrey", "=", 
         RowBox[{"rxnSpec", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<muTE\>\"", "]"}], "=", 
         RowBox[{"makeEatMeans", "[", 
          RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<nvarTE\>\"", "]"}], "=", 
         RowBox[{"makeEatNVar", "[", 
          RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerConn", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<nvar\>\""}], 
            "]"}], "\[Rule]", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<muTE\>\"", ",", "\"\<nvar\>\""}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rxnSpec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<birth\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iSp", "=", 
         RowBox[{"rxnSpec", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<muTE\>\"", "]"}], "=", 
         RowBox[{"makeBirthMeans", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<nvarTE\>\"", "]"}], "=", 
         RowBox[{"makeBirthNVar", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerConn", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<mu\>\""}], 
            "]"}], "\[Rule]", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<muTE\>\"", ",", "\"\<mu\>\""}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rxnSpec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<death\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iSp", "=", 
         RowBox[{"rxnSpec", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<muTE\>\"", "]"}], "=", 
         RowBox[{"makeDeathMeans", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<nvarTE\>\"", "]"}], "=", 
         RowBox[{"makeDeathNVar", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerConn", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<mu\>\""}], 
            "]"}], "\[Rule]", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<muTE\>\"", ",", "\"\<mu\>\""}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825882778970386*^9, 3.825882912891568*^9}, {
   3.825883208353478*^9, 3.825883226992317*^9}, {3.825883330093791*^9, 
   3.825883491215111*^9}, {3.8258835291753902`*^9, 3.8258835359165382`*^9}, {
   3.825884399395914*^9, 3.825884404861558*^9}, {3.825884630999447*^9, 
   3.8258846347893143`*^9}, {3.825884841030748*^9, 3.82588484979032*^9}, {
   3.825886253849203*^9, 3.825886447492128*^9}, {3.8258864777681704`*^9, 
   3.8258864900087433`*^9}, {3.8258865686446867`*^9, 3.825886584746963*^9}, {
   3.826033233026527*^9, 3.826033266830673*^9}, {3.826033331617299*^9, 
   3.826033331829741*^9}, 3.8260339129642277`*^9},
 CellLabel->"In[43]:=",ExpressionUUID->"72575f29-5d55-4420-b812-1b2d85d139ce"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.825883832934595*^9, 
  3.82588383486835*^9}},ExpressionUUID->"f5dd0ba6-ceba-4982-8f86-\
5beaf01b3ed4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"momentsTest", "=", 
   RowBox[{
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<mu\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"300", ",", "200", ",", "500"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<var\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"90", ",", "10", ",", "30"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", "80", ",", "20"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"30", ",", "20", ",", "70"}], "}"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "|>"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
   RowBox[{"momentsTest", "[", "\"\<var\>\"", "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"paramsTest", "=", 
  RowBox[{
  "convertMomentsToParams", "[", "momentsTest", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momentsTest", "=", 
   RowBox[{"convertParamsToMoments", "[", "paramsTest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
   RowBox[{"momentsTest", "[", "\"\<var\>\"", "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramMomentsTest", "=", 
   RowBox[{"convertParamsToParamMoments", "[", "paramsTest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nMomentsTest", "=", 
   RowBox[{"convertParamsToNMoments", "[", "paramsTest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nMoments3Test", "=", 
   RowBox[{"convertParamsToNMoments3", "[", "paramsTest", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.82588459315692*^9, 3.825884593815929*^9}, {
  3.825884968931785*^9, 3.825884973498159*^9}},
 CellLabel->
  "In[308]:=",ExpressionUUID->"13dead12-4a1e-416c-9bea-e56414428bd8"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.825884594137239*^9, 3.8258849738188257`*^9, 
  3.826033284136819*^9, 3.826033334868601*^9},
 CellLabel->
  "Out[309]=",ExpressionUUID->"650d6aab-6ed3-4262-8814-c6ce84ededa0"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"sig2\"\>", "\[Rule]", "77.14285714285714`"}], ",", 
   RowBox[{"\<\"muh\"\>", "\[Rule]", 
    RowBox[{"{", "500.`", "}"}]}], ",", 
   RowBox[{"\<\"varh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "70.`", "}"}], "}"}]}], ",", 
   RowBox[{"\<\"wt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0.42857142857142855`", ",", "0.2857142857142857`"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"b\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"85.71428571428572`", ",", "57.14285714285714`"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.825884594137239*^9, 3.8258849738188257`*^9, 
  3.826033284136819*^9, 3.8260333348702707`*^9},
 CellLabel->
  "Out[310]=",ExpressionUUID->"49625c8f-f928-42a5-af67-cc7c3ad59c21"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.825884594137239*^9, 3.8258849738188257`*^9, 
  3.826033284136819*^9, 3.8260333348719788`*^9},
 CellLabel->
  "Out[312]=",ExpressionUUID->"07abb42c-f493-46ff-8e73-1ae1423b6c94"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeParams1TEtest", "[", "rxnParamsTEtest_", "]"}], ":=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<fb\>\"", "->", 
      RowBox[{"rxnParamsTEtest", "[", "\"\<bTE\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fwt\>\"", "->", 
      RowBox[{"rxnParamsTEtest", "[", "\"\<wtTE\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fmuh\>\"", "->", 
      RowBox[{"rxnParamsTEtest", "[", "\"\<muhTE\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fvarh\>\"", "->", 
      RowBox[{"rxnParamsTEtest", "[", "\"\<varhTE\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fsig2\>\"", "->", 
      RowBox[{"rxnParamsTEtest", "[", "\"\<sig2TE\>\"", "]"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8260337264935102`*^9, 3.826033740772251*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"aea80708-cd03-42bd-ba41-6f69eced8442"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeRxnParams0TE", "[", 
    RowBox[{"nv", ",", "nh", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<eat\>\"", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "[", "paramsTest", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnNMomentsTEtest", "=", 
   RowBox[{"makeRxnEatNMomentsTE", "[", 
    RowBox[{"nMomentsTest", ",", "nMoments3Test", ",", "1", ",", "2"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnMomentsTEtest", "=", 
   RowBox[{"convertNMomentsTEtoMomentsTE", "[", 
    RowBox[{"momentsTest", ",", "rxnNMomentsTEtest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnParamMomentsTEtest", "=", 
   RowBox[{"convertMomentsTEtoParamMomentsTE", "[", 
    RowBox[{"paramsTest", ",", "rxnMomentsTEtest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnParamsTEtest", "=", 
   RowBox[{"convertParamMomentsTEtoParamsTE", "[", 
    RowBox[{"paramMomentsTest", ",", "rxnParamMomentsTEtest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params1TEtest", "=", 
   RowBox[{"makeParams1TEtest", "[", "rxnParamsTEtest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"convertParamsTELatentSpace", "[", 
  RowBox[{"paramsTest", ",", "params1TEtest", ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", "1", "}"}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", "0", "}"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.82588394626366*^9, 3.825884055658846*^9}, {
   3.825884316020462*^9, 3.825884317796029*^9}, {3.8258845797219067`*^9, 
   3.8258846153562717`*^9}, {3.825886514633265*^9, 3.8258865220341997`*^9}, {
   3.826033367467607*^9, 3.826033481128817*^9}, {3.826033746110404*^9, 
   3.826033755390357*^9}, 3.826033916547402*^9, 
   3.830798220799255*^9},ExpressionUUID->"0a8e73e6-57f3-4b84-b586-\
5e8aab091a5f"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"sig2TE\"\>", "\[Rule]", "52291.4296875`"}], ",", 
   RowBox[{"\<\"wtTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1434.5133056640625`", ",", 
       RowBox[{"-", "1434.5133056640625`"}]}], "}"}], "}"}]}], ",", 
   RowBox[{"\<\"bTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"60008.5703125`", ",", 
      RowBox[{"-", "60008.5703125`"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.825883979082314*^9, 3.825884055838586*^9}, 
   3.825884318076721*^9, 3.825884411048772*^9, 3.825884619574787*^9, 
   3.825884978990459*^9, 3.825886526222816*^9, 3.825886607278985*^9, 
   3.826033289278319*^9, 3.826033339414671*^9, 3.8260334854052973`*^9, {
   3.826033753583449*^9, 3.826033760179208*^9}, 3.826033921538495*^9},
 CellLabel->
  "Out[366]=",ExpressionUUID->"7ceb1e76-f763-4484-9426-5365b6badca9"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"fwt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1434.2743312017176`", ",", 
       RowBox[{"-", "1434.2743312017176`"}]}], "}"}], "}"}]}], ",", 
   RowBox[{"\<\"fb\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"60008.57142857143`", ",", 
      RowBox[{"-", "60008.57142857143`"}]}], "}"}]}], ",", 
   RowBox[{"\<\"fsig2\"\>", "\[Rule]", "52294.285714290236`"}], ",", 
   RowBox[{"\<\"fmuh\"\>", "\[Rule]", 
    RowBox[{"{", "0", "}"}]}], ",", 
   RowBox[{"\<\"fvarh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.825883979082314*^9, 3.825884055838586*^9}, 
   3.825884318076721*^9, 3.825884411048772*^9, 3.825884619574787*^9, 
   3.825884978990459*^9, 3.825886526222816*^9, 3.825886607278985*^9, 
   3.826033289278319*^9, 3.826033339414671*^9, 3.8260334854052973`*^9, {
   3.826033753583449*^9, 3.826033760179208*^9}, 3.826033921539853*^9},
 CellLabel->
  "Out[372]=",ExpressionUUID->"78a296a6-3760-43d9-83a5-de20d889d3a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeRxnParams0TE", "[", 
    RowBox[{"nv", ",", "nh", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<birth\>\"", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "[", "paramsTest", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnNMomentsTEtest", "=", 
   RowBox[{"makeRxnBirthNMomentsTE", "[", 
    RowBox[{"nMomentsTest", ",", "nMoments3Test", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnMomentsTEtest", "=", 
   RowBox[{"convertNMomentsTEtoMomentsTE", "[", 
    RowBox[{"momentsTest", ",", "rxnNMomentsTEtest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnParamMomentsTEtest", "=", 
   RowBox[{"convertMomentsTEtoParamMomentsTE", "[", 
    RowBox[{"paramsTest", ",", "rxnMomentsTEtest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnParamsTEtest", "=", 
   RowBox[{"convertParamMomentsTEtoParamsTE", "[", 
    RowBox[{"paramMomentsTest", ",", "rxnParamMomentsTEtest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params1TEtest", "=", 
   RowBox[{"makeParams1TEtest", "[", "rxnParamsTEtest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"convertParamsTELatentSpace", "[", 
  RowBox[{"paramsTest", ",", "params1TEtest", ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", "1", "}"}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", "0", "}"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.82588394626366*^9, 3.825884055658846*^9}, {
   3.825884316020462*^9, 3.825884317796029*^9}, {3.8258845797219067`*^9, 
   3.825884624816319*^9}, {3.825884777319624*^9, 3.825884785286561*^9}, {
   3.825886532888534*^9, 3.8258865359484797`*^9}, 3.826033773795958*^9, 
   3.826033919104891*^9, 
   3.8307982253583183`*^9},ExpressionUUID->"7c8a5487-8e9d-4149-9cc3-\
07d93af22a38"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"sig2TE\"\>", "\[Rule]", "227.14285278320312`"}], ",", 
   RowBox[{"\<\"wtTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"3.5856857299804688`", ",", "0.`"}], "}"}], "}"}]}], ",", 
   RowBox[{"\<\"bTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"300.`", ",", "0.`"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.825884783139916*^9, 3.825884787116908*^9}, 
   3.825884906765724*^9, 3.82588653782237*^9, 3.8258865937945538`*^9, 
   3.826033776798118*^9, 3.8260339238644342`*^9},
 CellLabel->
  "Out[374]=",ExpressionUUID->"45e40213-dc50-4df9-8e68-11bf39a7256f"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"fwt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"3.585685828003181`", ",", "0.`"}], "}"}], "}"}]}], ",", 
   RowBox[{"\<\"fb\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"300.`", ",", "0.`"}], "}"}]}], ",", 
   RowBox[{"\<\"fsig2\"\>", "\[Rule]", "227.14285714285714`"}], ",", 
   RowBox[{"\<\"fmuh\"\>", "\[Rule]", 
    RowBox[{"{", "0", "}"}]}], ",", 
   RowBox[{"\<\"fvarh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.825884783139916*^9, 3.825884787116908*^9}, 
   3.825884906765724*^9, 3.82588653782237*^9, 3.8258865937945538`*^9, 
   3.826033776798118*^9, 3.82603392386592*^9},
 CellLabel->
  "Out[380]=",ExpressionUUID->"065691ff-697d-4536-9768-b3aabdac3415"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeRxnParams0TE", "[", 
    RowBox[{"nv", ",", "nh", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<death\>\"", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "[", "paramsTest", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnNMomentsTEtest", "=", 
   RowBox[{"makeRxnDeathNMomentsTE", "[", 
    RowBox[{"nMomentsTest", ",", "nMoments3Test", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnMomentsTEtest", "=", 
   RowBox[{"convertNMomentsTEtoMomentsTE", "[", 
    RowBox[{"momentsTest", ",", "rxnNMomentsTEtest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnParamMomentsTEtest", "=", 
   RowBox[{"convertMomentsTEtoParamMomentsTE", "[", 
    RowBox[{"paramsTest", ",", "rxnMomentsTEtest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnParamsTEtest", "=", 
   RowBox[{"convertParamMomentsTEtoParamsTE", "[", 
    RowBox[{"paramMomentsTest", ",", "rxnParamMomentsTEtest"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params1TEtest", "=", 
   RowBox[{"makeParams1TEtest", "[", "rxnParamsTEtest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"convertParamsTELatentSpace", "[", 
  RowBox[{"paramsTest", ",", "params1TEtest", ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", "1", "}"}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", "0", "}"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.825884925193521*^9, 3.8258849290455112`*^9}, {
   3.825886599741466*^9, 3.825886601111903*^9}, 3.8260337769556303`*^9, 
   3.8260339215102654`*^9, 
   3.830798229145507*^9},ExpressionUUID->"ee297440-6eb3-4e26-bd63-\
ca7a21275eb0"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"sig2TE\"\>", "\[Rule]", "72.85714721679688`"}], ",", 
   RowBox[{"\<\"wtTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3.5856857299804688`"}], ",", "0.`"}], "}"}], "}"}]}], 
   ",", 
   RowBox[{"\<\"bTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "300.`"}], ",", "0.`"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.825884931579575*^9, 3.8258866033953743`*^9, 
  3.8260337800780993`*^9, 3.826033926419819*^9},
 CellLabel->
  "Out[382]=",ExpressionUUID->"8a5ea474-4809-4e65-ab5a-53be5b80c175"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"fwt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "3.585685828003181`"}], ",", "0.`"}], "}"}], "}"}]}], ",", 
   RowBox[{"\<\"fb\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "300.`"}], ",", "0.`"}], "}"}]}], ",", 
   RowBox[{"\<\"fsig2\"\>", "\[Rule]", "72.85714285714286`"}], ",", 
   RowBox[{"\<\"fmuh\"\>", "\[Rule]", 
    RowBox[{"{", "0", "}"}]}], ",", 
   RowBox[{"\<\"fvarh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "0", "}"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.825884931579575*^9, 3.8258866033953743`*^9, 
  3.8260337800780993`*^9, 3.826033926421322*^9},
 CellLabel->
  "Out[388]=",ExpressionUUID->"9474648b-9e6d-4df4-9886-e96e0868ab64"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Flatten outputs", "Chapter",
 CellChangeTimes->{{3.825885540845749*^9, 
  3.825885542317395*^9}},ExpressionUUID->"54ac089f-a600-476d-9ce4-\
7ad6776bcabd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"layerDefnsFlat", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<wtFlat\>\"", "\[Rule]", 
      RowBox[{"FlattenLayer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<varhFlat\>\"", "\[Rule]", 
      RowBox[{"FlattenLayer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<sig2Arr\>\"", "\[Rule]", 
      RowBox[{"ReshapeLayer", "[", 
       RowBox[{"{", "1", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<cat\>\"", "\[Rule]", 
      RowBox[{"CatenateLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
    "|>"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82588599279974*^9, 3.825886004356789*^9}, 
   3.825886059198228*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"7291f700-9d87-42cd-8c4c-cd5ad9cb1538"],

Cell[BoxData[
 RowBox[{
  RowBox[{"layerConnFlat", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NetPort", "[", 
       RowBox[{"\"\<lyr\>\"", ",", "\"\<sig2TE\>\""}], "]"}], "\[Rule]", 
      "\"\<sig2Arr\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NetPort", "[", 
       RowBox[{"\"\<lyr\>\"", ",", "\"\<wtTE\>\""}], "]"}], "\[Rule]", 
      "\"\<wtFlat\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NetPort", "[", 
       RowBox[{"\"\<lyr\>\"", ",", "\"\<varhTE\>\""}], "]"}], "\[Rule]", 
      "\"\<varhFlat\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<wtFlat\>\"", ",", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<lyr\>\"", ",", "\"\<bTE\>\""}], "]"}], ",", 
        "\"\<sig2Arr\>\"", ",", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<lyr\>\"", ",", "\"\<muhTE\>\""}], "]"}], ",", 
        "\"\<varhFlat\>\""}], "}"}], "\[Rule]", "\"\<cat\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825886061420533*^9, 3.825886070073381*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"4505359f-8d53-423a-b444-003220688794"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeRxnParams0TEflat", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "rxnSpec_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<wtFlat\>\"", "\[Rule]", 
         RowBox[{"FlattenLayer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2Arr\>\"", "\[Rule]", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", "1", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<cat\>\"", "\[Rule]", 
         RowBox[{"CatenateLayer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<lyr\>\"", "->", 
         RowBox[{"makeRxnParams0TE", "[", 
          RowBox[{"nv", ",", "nh", ",", "rxnSpec"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<lyr\>\"", ",", "\"\<sig2TE\>\""}], "]"}], "\[Rule]", 
         "\"\<sig2Arr\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<lyr\>\"", ",", "\"\<wtTE\>\""}], "]"}], "\[Rule]", 
         "\"\<wtFlat\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<wtFlat\>\"", ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<lyr\>\"", ",", "\"\<bTE\>\""}], "]"}], ",", 
           "\"\<sig2Arr\>\""}], "}"}], "\[Rule]", "\"\<cat\>\""}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825885523782955*^9, 3.8258855553523817`*^9}, {
  3.8258857837380457`*^9, 3.8258859813194103`*^9}, {3.825886074141818*^9, 
  3.82588609389566*^9}, {3.825886628827965*^9, 3.825886672880559*^9}, {
  3.826033925156805*^9, 3.8260339274195642`*^9}, {3.8260339993488197`*^9, 
  3.826034034750005*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"01d9586b-2ca0-453e-8019-fd5622a5a67b"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798233132842*^9, 
  3.830798233413562*^9}},ExpressionUUID->"0ccd7b45-24d0-4628-a226-\
6312639b5afd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeRxnParams0TEflat", "[", 
   RowBox[{"nv", ",", "nh", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<eat\>\"", ",", "2", ",", "1"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.825885818439949*^9, 3.8258858237838984`*^9}, {
   3.8258866818319607`*^9, 3.825886688582415*^9}, 3.826033943365218*^9, 
   3.830798231287653*^9},ExpressionUUID->"ccb1df33-787b-4c80-bed6-\
c5ba040009f3"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Import package for tests", "Title",
 CellChangeTimes->{{3.825883769607966*^9, 3.8258837715440702`*^9}, {
  3.825897757113186*^9, 
  3.82589775841055*^9}},ExpressionUUID->"365eb2a4-c2ef-4c3f-9202-\
fa061a5b00a3"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<../../package/\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<funcs_rxns_moms.m\>\"", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258837730534678`*^9, 3.825883819050502*^9}, {
   3.830798250784898*^9, 3.830798251142522*^9}, 
   3.830808251877819*^9},ExpressionUUID->"9c286fac-fee4-4aa7-9840-\
dc12e032e358"]
}, Closed]],

Cell[CellGroupData[{

Cell["Make graph for inputs", "Title",
 CellChangeTimes->{{3.825943042388685*^9, 
  3.825943046608261*^9}},ExpressionUUID->"e9f5b843-b032-4204-8f80-\
f0079616cd07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGraphInputsWOSTD", "[", 
   RowBox[{
   "nv_", ",", "nh_", ",", "freqs_", ",", "muhCosCoeffsInit_", ",", 
    "muhSinCoeffsInit_", ",", "varhCosCoeffsInit_", ",", 
    "varhSinCoeffsInit_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "layerDefns", ",", "layerConn", ",", "graph", ",", "rxnName", ",", 
      "idx"}], "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<convert0\>\"", "->", 
         RowBox[{"makeConvertParams0ToParamsLayer", "[", 
          RowBox[{
          "freqs", ",", "muhCosCoeffsInit", ",", "muhSinCoeffsInit", ",", 
           "varhCosCoeffsInit", ",", "varhSinCoeffsInit"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<catenate\>\"", "\[Rule]", 
         RowBox[{"CatenateLayer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<wt2Flatten\>\"", "\[Rule]", 
         RowBox[{"FlattenLayer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<varh2Flatten\>\"", "\[Rule]", 
         RowBox[{"FlattenLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<wt\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convert0\>\"", ",", "\"\<wt1\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<b\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convert0\>\"", ",", "\"\<b1\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convert0\>\"", ",", "\"\<wt2\>\""}], "]"}], "->", 
         RowBox[{"\"\<wt2Flatten\>\"", "\[Rule]", "\"\<catenate\>\""}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convert0\>\"", ",", "\"\<varh2\>\""}], "]"}], "->", 
         RowBox[{"\"\<varh2Flatten\>\"", "\[Rule]", "\"\<catenate\>\""}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convert0\>\"", ",", "\"\<sig2\>\""}], "]"}], 
         "\[Rule]", "\"\<catenate\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convert0\>\"", ",", "\"\<muh2\>\""}], "]"}], 
         "\[Rule]", "\"\<catenate\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convert0\>\"", ",", "\"\<b2\>\""}], "]"}], "\[Rule]", 
         "\"\<catenate\>\""}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8259430470235*^9, 3.825943110705764*^9}, {
   3.825943224194178*^9, 3.825943226806053*^9}, {3.825943564010388*^9, 
   3.825943568311454*^9}, 3.8260339490454617`*^9, {3.8260355047373962`*^9, 
   3.8260355061303883`*^9}, {3.826043887458156*^9, 3.8260439184339943`*^9}, {
   3.8260444659249487`*^9, 3.826044479651421*^9}, {3.826118048090307*^9, 
   3.826118068461138*^9}, {3.826375565773929*^9, 3.8263755874715652`*^9}, {
   3.826375633010771*^9, 3.826375704539962*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"d575d9ea-7910-41a1-8e6c-80fbc2946d3b"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.830798263986823*^9, 
  3.830798264286438*^9}},ExpressionUUID->"2d55852d-56f8-44d6-8db0-\
156695fbdc72"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"momentsTest", "=", 
   RowBox[{
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<mu\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "0"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<var\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"9", ",", "0.2", ",", "0.1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.2", ",", "0.3", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.1", ",", "0.3", ",", "1"}], "}"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "|>"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
   RowBox[{"momentsTest", "[", "\"\<var\>\"", "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"paramsTest", "=", 
  RowBox[{
  "convertMomentsToParams", "[", "momentsTest", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"momentsTest", "=", 
  RowBox[{
  "convertParamsToMoments", "[", "paramsTest", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
  RowBox[{"momentsTest", "[", "\"\<var\>\"", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.825897199989624*^9, 3.825897235735756*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"3df4e0f6-53f9-4529-b7ca-67dbe37335e5"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.8258972243264*^9, 3.825897236095263*^9}, {
   3.8259431268719597`*^9, 3.8259431380483227`*^9}, 3.826033954880127*^9, 
   3.8260355206455193`*^9, 3.826043924941992*^9, {3.8263755947628927`*^9, 
   3.826375612585216*^9}},
 CellLabel->"Out[72]=",ExpressionUUID->"feb9390a-2296-472a-b3b3-b05869b67283"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"sig2\"\>", "\[Rule]", "8.99`"}], ",", 
   RowBox[{"\<\"muh\"\>", "\[Rule]", 
    RowBox[{"{", "0.`", "}"}]}], ",", 
   RowBox[{"\<\"varh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "1.`", "}"}], "}"}]}], ",", 
   RowBox[{"\<\"wt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0.1`", ",", "0.3`"}], "}"}], "}"}]}], ",", 
   RowBox[{"\<\"b\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"3.`", ",", "2.`"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.8258972243264*^9, 3.825897236095263*^9}, {
   3.8259431268719597`*^9, 3.8259431380483227`*^9}, 3.826033954880127*^9, 
   3.8260355206455193`*^9, 3.826043924941992*^9, {3.8263755947628927`*^9, 
   3.826375612586073*^9}},
 CellLabel->"Out[73]=",ExpressionUUID->"edf16160-a727-40da-99c6-a31e1a183a2b"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"muv\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"3.`", ",", "2.`"}], "}"}]}], ",", 
   RowBox[{"\<\"muh\"\>", "\[Rule]", 
    RowBox[{"{", "0.`", "}"}]}], ",", 
   RowBox[{"\<\"varv\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"9.`", ",", "0.03`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.03`", ",", "9.08`"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"varvh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0.1`", ",", "0.3`"}], "}"}], "}"}]}], ",", 
   RowBox[{"\<\"varh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "1.`", "}"}], "}"}]}], ",", 
   RowBox[{"\<\"mu\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"3.`", ",", "2.`", ",", "0.`"}], "}"}]}], ",", 
   RowBox[{"\<\"var\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"9.`", ",", "0.03`", ",", "0.1`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.03`", ",", "9.08`", ",", "0.3`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.1`", ",", "0.3`", ",", "1.`"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.8258972243264*^9, 3.825897236095263*^9}, {
   3.8259431268719597`*^9, 3.8259431380483227`*^9}, 3.826033954880127*^9, 
   3.8260355206455193`*^9, 3.826043924941992*^9, {3.8263755947628927`*^9, 
   3.826375612587204*^9}},
 CellLabel->"Out[74]=",ExpressionUUID->"d179736e-6e21-44e4-88f8-2bd616425c43"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8258972243264*^9, 3.825897236095263*^9}, {
   3.8259431268719597`*^9, 3.8259431380483227`*^9}, 3.826033954880127*^9, 
   3.8260355206455193`*^9, 3.826043924941992*^9, {3.8263755947628927`*^9, 
   3.82637561258834*^9}},
 CellLabel->"Out[75]=",ExpressionUUID->"e5a0a08b-da98-4740-92ac-c2215ba55517"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"freqsTest", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nv", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nh", "=", "1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"makeGraphInputsWOSTD", "[", 
   RowBox[{"nv", ",", "nh", ",", "freqsTest", ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "4"}], "]"}], ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "4"}], "]"}], ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "4"}], "]"}], ",", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "4"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.825887424826394*^9, 3.825887438432991*^9}, {
   3.8258970365415792`*^9, 3.8258970442021713`*^9}, {3.826035535806492*^9, 
   3.8260355397358837`*^9}, {3.826043929360838*^9, 3.826043937034128*^9}, {
   3.8261180854868507`*^9, 3.8261180860031567`*^9}, {3.8263756158796053`*^9, 
   3.8263756186082773`*^9}, 
   3.8297059357893867`*^9},ExpressionUUID->"7c8cd943-584a-4c2f-832d-\
0815b213fef4"]
}, Open  ]]
}, Closed]]
},
FileChangeProtection->Automatic,
AutoGeneratedPackage->None,
WindowSize->{1088, 961},
WindowMargins->{{Automatic, 226}, {Automatic, 0}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c74e991d-4e90-4c3a-aed6-562037d4389e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 152, 3, 98, "Title",ExpressionUUID->"2fc3b0a5-ef81-48e0-ad46-2bca4dac5358"],
Cell[735, 27, 8744, 178, 1317, "Input",ExpressionUUID->"32543105-d66a-47bc-a629-e0f4a372c52c",
 InitializationCell->True],
Cell[9482, 207, 723, 20, 46, "Input",ExpressionUUID->"37fb00f8-9dd3-42e3-96b5-c9b0ff2c57e1",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[10230, 231, 149, 3, 67, "Section",ExpressionUUID->"51374f05-a29a-42f7-8f3f-15a3f5d8d6f7"],
Cell[10382, 236, 1508, 37, 136, "Input",ExpressionUUID->"bd9e0421-5680-4e96-9edd-837bebda45bf"],
Cell[CellGroupData[{
Cell[11915, 277, 3877, 91, 262, "Input",ExpressionUUID->"8aaca3fa-4328-40a3-a24d-75c36d828599"],
Cell[15795, 370, 1358, 19, 34, "Output",ExpressionUUID->"e8f15ee3-3a4b-4a54-9a13-caa63b15f929"],
Cell[17156, 391, 7102, 137, 264, "Output",ExpressionUUID->"bba918a8-8035-4bb0-8dd3-a2eac9d8f69c"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[24319, 535, 199, 4, 72, "Title",ExpressionUUID->"46f1c9ea-80e8-46a1-860d-8b88772d3017"],
Cell[24521, 541, 514, 14, 49, "Input",ExpressionUUID->"e76b5b0d-5409-4430-a898-210c268a4eb1",
 InitializationCell->True],
Cell[25038, 557, 3478, 86, 341, "Input",ExpressionUUID->"670249c1-759f-4a56-b8c9-e7cc88477bf0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[28541, 647, 149, 3, 67, "Section",ExpressionUUID->"3f281376-ba3c-4d99-80a0-2020fbb7e3c6"],
Cell[CellGroupData[{
Cell[28715, 654, 633, 18, 73, "Input",ExpressionUUID->"b2ae9c8c-9b4f-4790-8cb1-48b228873e24"],
Cell[29351, 674, 466, 13, 34, "Output",ExpressionUUID->"b3c5e618-8b45-4641-b982-fe2ac1aa8481"],
Cell[29820, 689, 468, 13, 34, "Output",ExpressionUUID->"24ffdbda-b494-4391-89e8-0e8b27450d08"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[30349, 709, 165, 3, 72, "Title",ExpressionUUID->"65ddda7d-81a2-477d-b031-9b6318b22c4a"],
Cell[30517, 714, 1387, 34, 72, "Input",ExpressionUUID->"d198e94e-ee12-43e3-88de-5392c2de2c03",
 InitializationCell->True],
Cell[31907, 750, 1014, 25, 49, "Input",ExpressionUUID->"e5f815ec-43ac-45d8-94f8-a417af244ad0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[32946, 779, 151, 3, 67, "Section",ExpressionUUID->"25b1888a-bac7-4a22-a1c3-41b348a745e0"],
Cell[CellGroupData[{
Cell[33122, 786, 2117, 56, 325, "Input",ExpressionUUID->"e00ca8e7-ae7b-4a23-8a05-aa4385e2e04a"],
Cell[35242, 844, 331, 6, 34, "Output",ExpressionUUID->"5a2faba5-87f1-4a79-a542-fa7891550a2a"],
Cell[35576, 852, 335, 7, 34, "Output",ExpressionUUID->"98eb4db7-19b3-4218-9e80-7d9322473ce6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35948, 864, 1290, 35, 199, "Input",ExpressionUUID->"2baa5183-835a-4ff4-b7b4-45c971cce523"],
Cell[37241, 901, 283, 7, 34, "Output",ExpressionUUID->"8e8c941a-9dfa-44bb-857c-336d4bbbd853"],
Cell[37527, 910, 282, 7, 34, "Output",ExpressionUUID->"71389ccf-ce87-4b2e-9d0a-de840a3a5939"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[37858, 923, 223, 4, 58, "Chapter",ExpressionUUID->"e1d1d40b-6d25-42e1-bd96-0620b2c8a6aa"],
Cell[38084, 929, 1054, 25, 72, "Input",ExpressionUUID->"150883d2-624d-40c6-a0fa-fc0a2bc65725",
 InitializationCell->True],
Cell[39141, 956, 960, 22, 49, "Input",ExpressionUUID->"e9f4b641-fa44-417b-88fa-68419485a24f",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[40126, 982, 151, 3, 67, "Section",ExpressionUUID->"9d3530b2-1cb3-4676-9150-212fee561b5d"],
Cell[CellGroupData[{
Cell[40302, 989, 1679, 43, 241, "Input",ExpressionUUID->"187cc452-7894-4f66-81c8-e6f36858d9c9"],
Cell[41984, 1034, 421, 9, 34, "Output",ExpressionUUID->"ad763a59-ce7b-4238-9be8-23efdfcad6e0"],
Cell[42408, 1045, 420, 9, 34, "Output",ExpressionUUID->"ef7890d4-855b-4404-b121-a410efa3035b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[42865, 1059, 1081, 29, 157, "Input",ExpressionUUID->"7939a27f-2799-4215-9720-b1dd12e1897a"],
Cell[43949, 1090, 338, 9, 34, "Output",ExpressionUUID->"3dfe4243-6b97-415e-9395-8ba39a8cd6fe"],
Cell[44290, 1101, 340, 9, 34, "Output",ExpressionUUID->"b4d1a6df-a62e-47fd-b6dc-b31ae308453e"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[44703, 1118, 230, 4, 72, "Title",ExpressionUUID->"fedfaf62-4769-4c23-b2f3-e4387ee5439f"],
Cell[44936, 1124, 4279, 88, 677, "Input",ExpressionUUID->"a365bf21-ecee-4dcf-93cd-95e4ab038d86",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[49240, 1216, 149, 3, 67, "Section",ExpressionUUID->"42575cd4-d749-4992-b806-9db5a301b882"],
Cell[49392, 1221, 808, 18, 52, "Input",ExpressionUUID->"31b5925e-52e5-48c1-8b2c-eda21f54006d"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[50249, 1245, 213, 4, 72, "Title",ExpressionUUID->"6af74424-f4fe-4f07-827d-58a5ec887ae3"],
Cell[50465, 1251, 1213, 32, 110, "Input",ExpressionUUID->"322f1acc-b919-4d84-88f7-721b03c9aef7",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[51703, 1287, 151, 3, 67, "Section",ExpressionUUID->"8689e181-e4af-47a7-9f24-487936e56bd0"],
Cell[CellGroupData[{
Cell[51879, 1294, 1859, 58, 262, "Input",ExpressionUUID->"febff9b1-857e-4a05-87b7-e822e6003230"],
Cell[53741, 1354, 658, 17, 34, "Output",ExpressionUUID->"68bb607b-3537-47da-93a3-f30195addb18"],
Cell[54402, 1373, 659, 17, 34, "Output",ExpressionUUID->"48a2e079-4a7d-41e9-b857-c224aa6f88b2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[55110, 1396, 162, 3, 58, "Chapter",ExpressionUUID->"85bb17ec-aad3-4bef-a3cf-224630da3b2f"],
Cell[55275, 1401, 7861, 175, 1013, "Input",ExpressionUUID->"e07c8541-1179-4820-b811-9b07e9faf697",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[63161, 1580, 149, 3, 67, "Section",ExpressionUUID->"28580f4a-eefc-45bd-840e-ce4b2c007bd4"],
Cell[63313, 1585, 279, 6, 30, "Input",ExpressionUUID->"599aaa96-365b-4503-aafe-20aba7d77949"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[63653, 1598, 170, 3, 72, "Title",ExpressionUUID->"c0dd3a22-94d8-4ff8-bb31-e0c16d130d7f"],
Cell[CellGroupData[{
Cell[63848, 1605, 168, 3, 69, "Chapter",ExpressionUUID->"37020cd4-70ad-43e5-b30d-003205fcf34e"],
Cell[64019, 1610, 2558, 60, 404, "Input",ExpressionUUID->"03ec8a4e-fc56-4a54-b74e-c41964bd45c8",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[66602, 1674, 148, 3, 67, "Section",ExpressionUUID->"e8b9d4e8-f8c9-46f1-ba07-57fe87c76d9b"],
Cell[66753, 1679, 281, 6, 30, "Input",ExpressionUUID->"bd587b45-36b0-4af1-899f-ba028755ef42"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[67083, 1691, 165, 3, 69, "Chapter",ExpressionUUID->"36b95f31-c124-47a8-aa01-8835e923f430"],
Cell[67251, 1696, 1959, 44, 341, "Input",ExpressionUUID->"a6d3be3c-8a34-4a91-ba32-0ff75dbe2be1",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[69235, 1744, 153, 3, 67, "Section",ExpressionUUID->"14008b62-ea26-4540-b23f-0eca17c48a4d"],
Cell[69391, 1749, 278, 6, 30, "Input",ExpressionUUID->"af0af7bb-f129-48a6-927a-9f3a1428346b"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[69730, 1762, 154, 3, 72, "Title",ExpressionUUID->"4c6ecff3-0666-4b86-ac9f-f1582aa49833"],
Cell[69887, 1767, 1694, 41, 215, "Input",ExpressionUUID->"6020f374-229e-4093-8fdd-4d1cf50728bd",
 InitializationCell->True],
Cell[71584, 1810, 889, 24, 68, "Input",ExpressionUUID->"3e9b3d6e-c4ac-4ed7-93cf-033af5f3451e",
 InitializationCell->True],
Cell[72476, 1836, 1167, 32, 89, "Input",ExpressionUUID->"c6a2eb84-bf4c-444f-a2fc-c5207627e278",
 InitializationCell->True],
Cell[73646, 1870, 1972, 46, 320, "Input",ExpressionUUID->"8c01b497-6d4d-4bc1-a379-921da1e6e19d",
 InitializationCell->True],
Cell[75621, 1918, 1898, 43, 320, "Input",ExpressionUUID->"016f770d-e3aa-4373-a195-a9dfc825e27f",
 InitializationCell->True],
Cell[77522, 1963, 3410, 79, 509, "Input",ExpressionUUID->"1207896e-17be-4e6b-98d3-1eb7faf89c15",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[80957, 2046, 151, 3, 67, "Section",ExpressionUUID->"dcb585f8-9fa8-4c1e-a058-f698a8de46b1"],
Cell[81111, 2051, 3395, 86, 530, "Input",ExpressionUUID->"dcf24204-5757-43bf-8d0f-2518f641618d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[84531, 2141, 2401, 68, 346, "Input",ExpressionUUID->"2589dfb4-3720-4ddb-bfc0-1492608a07b5"],
Cell[86935, 2211, 326, 6, 34, "Output",ExpressionUUID->"32de460d-aa76-41bf-b8f5-0fb64698e21b"],
Cell[87264, 2219, 332, 6, 70, "Output",ExpressionUUID->"be64a8fa-d9e8-479a-83f7-7119a35a54e2"],
Cell[87599, 2227, 256, 4, 70, "Output",ExpressionUUID->"ea6089f3-8bef-4c80-ae84-59ca54bb4dbd"],
Cell[87858, 2233, 685, 18, 70, "Output",ExpressionUUID->"05ee64ef-b6b7-457f-a7c3-17cbe0cb6a1d"],
Cell[88546, 2253, 691, 18, 70, "Output",ExpressionUUID->"8c4bbfd1-befd-4d14-b63b-555a77c2fbcd"],
Cell[89240, 2273, 256, 4, 70, "Output",ExpressionUUID->"a31c2dde-2e59-4126-8ddd-7ea494be620f"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[89557, 2284, 202, 4, 72, "Title",ExpressionUUID->"42f75383-66ed-4961-a102-78009944226d"],
Cell[89762, 2290, 1636, 39, 215, "Input",ExpressionUUID->"108d6b6e-c497-40cf-8664-5610ffdeba77",
 InitializationCell->True],
Cell[91401, 2331, 1991, 46, 320, "Input",ExpressionUUID->"4a06b9d7-318e-4484-abbc-47cd5f35e0f2",
 InitializationCell->True],
Cell[93395, 2379, 1910, 42, 320, "Input",ExpressionUUID->"ab668816-d09a-476b-8fa8-077b20e21ec8",
 InitializationCell->True],
Cell[95308, 2423, 3485, 80, 509, "Input",ExpressionUUID->"9e65a4f7-c0fe-4e19-ae6e-6919744b62fb",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[98818, 2507, 151, 3, 67, "Section",ExpressionUUID->"16b0cae3-8e63-4cc9-9cd9-303c9a37e741"],
Cell[98972, 2512, 3266, 82, 530, "Input",ExpressionUUID->"8866315e-af8f-4589-a4db-30c989591f35",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[102263, 2598, 2349, 67, 346, "Input",ExpressionUUID->"8a5b8d9b-68ca-46e9-a3f1-34949facc035"],
Cell[104615, 2667, 278, 6, 34, "Output",ExpressionUUID->"6490fec2-cdb6-4e4d-816d-f926c101493d"],
Cell[104896, 2675, 284, 6, 70, "Output",ExpressionUUID->"f5ee5a4d-ec18-4ead-ab16-fd44728f4f28"],
Cell[105183, 2683, 208, 4, 70, "Output",ExpressionUUID->"ff5a8131-60c5-4d7d-a92b-e01629a0ed55"],
Cell[105394, 2689, 572, 15, 70, "Output",ExpressionUUID->"08dfcdd2-9731-4932-a78e-19030bb308cc"],
Cell[105969, 2706, 580, 15, 70, "Output",ExpressionUUID->"82be0e0a-0ed7-42a4-a58c-fb0bfd5f70e1"],
Cell[106552, 2723, 208, 4, 70, "Output",ExpressionUUID->"e2dffdb9-c22a-43fd-a2b3-0d8711122069"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[106821, 2734, 245, 4, 72, "Title",ExpressionUUID->"131d7ff7-98cc-4b34-94f8-aec9dac227ab"],
Cell[107069, 2740, 2914, 70, 257, "Input",ExpressionUUID->"7d75e48d-5c95-4ef6-a45c-f2c411223800",
 InitializationCell->True],
Cell[109986, 2812, 1589, 45, 110, "Input",ExpressionUUID->"9e5ef683-1eab-4a81-a919-674ff23bee7c",
 InitializationCell->True],
Cell[111578, 2859, 2333, 55, 362, "Input",ExpressionUUID->"d5662e30-11c2-40de-b6e8-853fb16f3fcd",
 InitializationCell->True],
Cell[113914, 2916, 2358, 54, 362, "Input",ExpressionUUID->"07ad98d9-c848-430d-81e7-c5511933e15b",
 InitializationCell->True],
Cell[116275, 2972, 2838, 64, 404, "Input",ExpressionUUID->"d1a35e2b-e044-45f6-9112-201694367147",
 InitializationCell->True],
Cell[119116, 3038, 2776, 61, 404, "Input",ExpressionUUID->"7b270728-7b0f-4e47-a8cd-76f128e8ee9a",
 InitializationCell->True],
Cell[121895, 3101, 5378, 119, 845, "Input",ExpressionUUID->"a7baa09f-8f69-4c0e-aad2-0ca9115dcc53",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[127298, 3224, 151, 3, 67, "Section",ExpressionUUID->"f515273b-2640-428a-81f7-c4b940d9f28e"],
Cell[127452, 3229, 365, 8, 46, "Input",ExpressionUUID->"35f8c74d-c25e-4608-b494-d6bccfde8499",
 InitializationCell->True],
Cell[127820, 3239, 6699, 169, 782, "Input",ExpressionUUID->"b9fafd31-93bc-4203-80c8-cce439a97ac9",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[134544, 3412, 4880, 134, 539, "Input",ExpressionUUID->"10017863-8a3e-4ed4-956e-8299de717488"],
Cell[139427, 3548, 249, 4, 34, "Output",ExpressionUUID->"9b8a4009-2ce0-4ac7-a4d2-c5ae0942a3da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139713, 3557, 2047, 51, 325, "Input",ExpressionUUID->"dee9f6bb-6a9c-4cbe-8d95-14180ef4d6a3"],
Cell[141763, 3610, 1316, 30, 34, "Output",ExpressionUUID->"2d373fec-1bde-4933-8249-e9022b416b74"],
Cell[143082, 3642, 631, 11, 34, "Output",ExpressionUUID->"333e4bac-0ff5-4d3a-a4a2-78becd84e97d"],
Cell[143716, 3655, 633, 11, 34, "Output",ExpressionUUID->"dda594e4-c354-4b2f-b6ef-dac850b684e1"],
Cell[144352, 3668, 524, 8, 34, "Output",ExpressionUUID->"87981f96-9b95-46ce-bdf1-3bd2d847637a"],
Cell[144879, 3678, 984, 22, 34, "Output",ExpressionUUID->"fc02838d-c837-47cf-baa5-b7278d4731d4"],
Cell[145866, 3702, 989, 22, 34, "Output",ExpressionUUID->"e562ae58-c875-4c03-a1fa-d77e5c20576d"],
Cell[146858, 3726, 524, 8, 34, "Output",ExpressionUUID->"3217e5a3-bf50-4f65-9a2f-bd6039e5e215"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[147443, 3741, 176, 3, 72, "Title",ExpressionUUID->"178faf1c-0ac2-49a8-94b0-14611eacc4dd"],
Cell[147622, 3746, 3745, 88, 425, "Input",ExpressionUUID->"7c1402f3-a929-47a5-b264-de2597d7b25a",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[151392, 3838, 149, 3, 67, "Section",ExpressionUUID->"80326d67-4470-457c-87de-831e19358e86"],
Cell[151544, 3843, 1542, 35, 257, "Input",ExpressionUUID->"ccc9551b-6206-4375-932c-2a216f895d4b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[153111, 3882, 2244, 65, 262, "Input",ExpressionUUID->"e9489f8e-0ae2-4956-a070-ea18e701ccd9"],
Cell[155358, 3949, 1071, 27, 56, "Output",ExpressionUUID->"31ced27e-790e-4013-a8fa-a806ec0588e6"],
Cell[156432, 3978, 1079, 28, 56, "Output",ExpressionUUID->"61a52916-399f-436c-9b25-cd475a724531"],
Cell[157514, 4008, 235, 5, 34, "Output",ExpressionUUID->"3ad3acec-a32b-484a-9768-ce1e970205c6"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[157810, 4020, 180, 3, 72, "Title",ExpressionUUID->"e25058ae-c753-4a1b-9594-796ef13b9b97"],
Cell[157993, 4025, 3765, 87, 509, "Input",ExpressionUUID->"14a8915c-e374-4633-88f8-32f1ae650868",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[161783, 4116, 148, 3, 67, "Section",ExpressionUUID->"74495b95-407c-496e-946d-7893d79ec206"],
Cell[161934, 4121, 284, 6, 30, "Input",ExpressionUUID->"f4475bfb-7978-45cb-b142-8af779061fb9"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[162267, 4133, 179, 3, 72, "Title",ExpressionUUID->"31199eb2-30b4-4f5f-b57e-7408ae0ae079"],
Cell[162449, 4138, 1373, 33, 236, "Input",ExpressionUUID->"f6e3113f-af9b-4d05-9b6a-e7175168b9d7",
 InitializationCell->True],
Cell[163825, 4173, 6812, 155, 740, "Input",ExpressionUUID->"7cf64145-d658-4858-a529-49c39d07fdd8",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[170662, 4332, 151, 3, 67, "Section",ExpressionUUID->"4d29468c-1414-4976-a216-e62757ceb110"],
Cell[170816, 4337, 282, 6, 30, "Input",ExpressionUUID->"d9fcec03-07db-46a2-a77a-3eb675b7290d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[171147, 4349, 172, 3, 72, "Title",ExpressionUUID->"bb547e74-d166-4564-93f4-e6628f3a91dd"],
Cell[171322, 4354, 4077, 92, 446, "Input",ExpressionUUID->"5841f285-3080-4ef1-8e11-652fe0a21fb4",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[175424, 4450, 149, 3, 67, "Section",ExpressionUUID->"8dccf02d-0f17-4355-9331-8d93182f1320"],
Cell[175576, 4455, 3957, 96, 492, "Input",ExpressionUUID->"6edff6a5-6791-4af3-b9ed-d8c2d884a2a3",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[179558, 4555, 5875, 164, 745, "Input",ExpressionUUID->"6412a258-f6c8-4737-ae86-729cd1a2560c"],
Cell[185436, 4721, 982, 23, 37, "Output",ExpressionUUID->"d5db4557-276b-4621-8160-91693d2e1795"],
Cell[186421, 4746, 741, 18, 37, "Output",ExpressionUUID->"ffbdb438-8b61-4557-8a0a-34921cec75ff"],
Cell[187165, 4766, 309, 5, 34, "Output",ExpressionUUID->"44421157-bbbb-4c92-b707-2ec29cf2aa7c"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[187535, 4778, 221, 4, 72, "Title",ExpressionUUID->"2b5c0ae5-9a25-49d7-bab4-530c7ebb452e"],
Cell[187759, 4784, 7185, 165, 740, "Input",ExpressionUUID->"2f61d3be-008b-4fc5-9873-db08138b0481",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[194969, 4953, 149, 3, 67, "Section",ExpressionUUID->"11e8321e-134c-47e1-b21a-a751cec7c4e8"],
Cell[195121, 4958, 306, 7, 30, "Input",ExpressionUUID->"134e6634-9a76-40f7-82e0-fb2f47e0da82"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[195476, 4971, 147, 3, 72, "Title",ExpressionUUID->"75c1fcef-1813-4085-8502-bba2286b70fb"],
Cell[195626, 4976, 7992, 175, 1202, "Input",ExpressionUUID->"72575f29-5d55-4420-b812-1b2d85d139ce",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[203643, 5155, 148, 3, 67, "Section",ExpressionUUID->"f5dd0ba6-ceba-4982-8f86-5beaf01b3ed4"],
Cell[CellGroupData[{
Cell[203816, 5162, 1925, 52, 283, "Input",ExpressionUUID->"13dead12-4a1e-416c-9bea-e56414428bd8"],
Cell[205744, 5216, 227, 4, 34, "Output",ExpressionUUID->"650d6aab-6ed3-4262-8814-c6ce84ededa0"],
Cell[205974, 5222, 844, 21, 37, "Output",ExpressionUUID->"49625c8f-f928-42a5-af67-cc7c3ad59c21"],
Cell[206821, 5245, 229, 4, 34, "Output",ExpressionUUID->"07abb42c-f493-46ff-8e73-1ae1423b6c94"]
}, Open  ]],
Cell[207065, 5252, 1028, 23, 173, "Input",ExpressionUUID->"aea80708-cd03-42bd-ba41-6f69eced8442",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[208118, 5279, 2009, 49, 199, "Input",ExpressionUUID->"0a8e73e6-57f3-4b84-b586-5e8aab091a5f"],
Cell[210130, 5330, 927, 20, 37, "Output",ExpressionUUID->"7ceb1e76-f763-4484-9426-5365b6badca9"],
Cell[211060, 5352, 1113, 24, 37, "Output",ExpressionUUID->"78a296a6-3760-43d9-83a5-de20d889d3a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212210, 5381, 1967, 49, 199, "Input",ExpressionUUID->"7c8a5487-8e9d-4149-9cc3-07d93af22a38"],
Cell[214180, 5432, 688, 16, 37, "Output",ExpressionUUID->"45e40213-dc50-4df9-8e68-11bf39a7256f"],
Cell[214871, 5450, 857, 20, 37, "Output",ExpressionUUID->"065691ff-697d-4536-9768-b3aabdac3415"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215765, 5475, 1822, 47, 199, "Input",ExpressionUUID->"ee297440-6eb3-4e26-bd63-ca7a21275eb0"],
Cell[217590, 5524, 664, 18, 37, "Output",ExpressionUUID->"8a5ea474-4809-4e65-ab5a-53be5b80c175"],
Cell[218257, 5544, 832, 21, 37, "Output",ExpressionUUID->"9474648b-9e6d-4df4-9886-e96e0868ab64"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[219138, 5571, 160, 3, 69, "Chapter",ExpressionUUID->"54ac089f-a600-476d-9ce4-7ad6776bcabd"],
Cell[219301, 5576, 834, 18, 152, "Input",ExpressionUUID->"7291f700-9d87-42cd-8c4c-cd5ad9cb1538",
 InitializationCell->True],
Cell[220138, 5596, 1233, 29, 152, "Input",ExpressionUUID->"4505359f-8d53-423a-b444-003220688794",
 InitializationCell->True],
Cell[221374, 5627, 2486, 54, 404, "Input",ExpressionUUID->"01d9586b-2ca0-453e-8019-fd5622a5a67b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[223885, 5685, 149, 3, 67, "Section",ExpressionUUID->"0ccd7b45-24d0-4628-a226-6312639b5afd"],
Cell[224037, 5690, 426, 10, 30, "Input",ExpressionUUID->"ccb1df33-787b-4c80-bed6-c5ba040009f3"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[224524, 5707, 217, 4, 72, "Title",ExpressionUUID->"365eb2a4-c2ef-4c3f-9202-fa061a5b00a3"],
Cell[224744, 5713, 482, 11, 68, "Input",ExpressionUUID->"9c286fac-fee4-4aa7-9840-dc12e032e358",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[225263, 5729, 164, 3, 72, "Title",ExpressionUUID->"e9f5b843-b032-4204-8f80-f0079616cd07"],
Cell[225430, 5734, 3784, 78, 551, "Input",ExpressionUUID->"d575d9ea-7910-41a1-8e6c-80fbc2946d3b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[229239, 5816, 149, 3, 67, "Section",ExpressionUUID->"2d55852d-56f8-44d6-8db0-156695fbdc72"],
Cell[CellGroupData[{
Cell[229413, 5823, 1375, 35, 199, "Input",ExpressionUUID->"3df4e0f6-53f9-4529-b7ca-67dbe37335e5"],
Cell[230791, 5860, 353, 5, 34, "Output",ExpressionUUID->"feb9390a-2296-472a-b3b3-b05869b67283"],
Cell[231147, 5867, 884, 21, 37, "Output",ExpressionUUID->"edf16160-a727-40da-99c6-a31e1a183a2b"],
Cell[232034, 5890, 1510, 39, 60, "Output",ExpressionUUID->"d179736e-6e21-44e4-88f8-2bd616425c43"],
Cell[233547, 5931, 351, 5, 34, "Output",ExpressionUUID->"e5a0a08b-da98-4740-92ac-c2215ba55517"]
}, Open  ]],
Cell[233913, 5939, 1109, 26, 94, "Input",ExpressionUUID->"7c8cd943-584a-4c2f-832d-0815b213fef4"]
}, Open  ]]
}, Closed]]
}
]
*)

