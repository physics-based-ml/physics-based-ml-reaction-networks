(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    440750,      10291]
NotebookOptionsPosition[    415899,       9861]
NotebookOutlinePosition[    416325,       9878]
CellTagsIndexPosition[    416282,       9875]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Fourier", "Title",
 CellChangeTimes->{{3.825784351342326*^9, 
  3.8257843649529057`*^9}},ExpressionUUID->"2fc3b0a5-ef81-48e0-ad46-\
2bca4dac5358"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeFourierGraph", "[", 
   RowBox[{
   "freqs_", ",", "sinCoeffsInit_", ",", "cosCoeffsInit_", ",", 
    "offsetFixed_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nFourier", ",", "layerDefns", ",", "layerConn", ",", "graph"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"nFourier", "=", 
      RowBox[{"Length", "[", "freqs", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nFourier", "\[NotEqual]", "0"}], "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"layerDefns", "=", 
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "Offset", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<offset\>\"", "\[Rule]", 
            RowBox[{"NetArrayLayer", "[", 
             RowBox[{
              RowBox[{"\"\<Output\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<Array\>\"", "\[Rule]", "offsetFixed"}], ",", 
              RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Freqs", ",", " ", "coeffs"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<cosCoeff\>\"", "\[Rule]", 
            RowBox[{"NetArrayLayer", "[", 
             RowBox[{
              RowBox[{"\"\<Output\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"\"\<Array\>\"", "\[Rule]", "cosCoeffsInit"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<sinCoeff\>\"", "\[Rule]", 
            RowBox[{"NetArrayLayer", "[", 
             RowBox[{
              RowBox[{"\"\<Output\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"\"\<Array\>\"", "\[Rule]", "sinCoeffsInit"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<freqs\>\"", "->", 
            RowBox[{"NetArrayLayer", "[", 
             RowBox[{
              RowBox[{"\"\<Output\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}], ",", 
              RowBox[{"\"\<Array\>\"", "\[Rule]", "freqs"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Norm", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"\"\<range\>\"", "\[Rule]", 
            RowBox[{"FunctionLayer", "[", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", 
                RowBox[{
                 RowBox[{"Total", "[", 
                  RowBox[{"Abs", "[", "#sinCoeff", "]"}], "]"}], "+", 
                 RowBox[{"Total", "[", 
                  RowBox[{"Abs", "[", "#cosCoeff", "]"}], "]"}], "+", 
                 SuperscriptBox["10", 
                  RowBox[{"-", "8"}]]}]}], "]"}], "&"}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "FT", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"\"\<ft\>\"", "->", 
            RowBox[{"FunctionLayer", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#offset", "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Total", "[", 
                    RowBox[{"#sinCoeff", "*", 
                    RowBox[{"Sin", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#tpt", "-", "1"}], ")"}], "*", "#freqs"}], 
                    "]"}]}], "]"}], "+", 
                   RowBox[{"Total", "[", 
                    RowBox[{"#cosCoeff", "*", 
                    RowBox[{"Cos", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"#tpt", "-", "1"}], ")"}], "*", "#freqs"}], 
                    "]"}]}], "]"}]}], ")"}], "/", "#range"}]}], "&"}], ",", 
              RowBox[{"\"\<tpt\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<freqs\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"\"\<sinCoeff\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"\"\<cosCoeff\>\"", "\[Rule]", "nFourier"}], ",", 
              RowBox[{"\"\<offset\>\"", "\[Rule]", "1"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<ftFlatten\>\"", "\[Rule]", 
            RowBox[{"PartLayer", "[", "1", "]"}]}]}], "\[IndentingNewLine]", 
          "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"layerConn", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "Offset", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<offset\>\"", "->", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<ft\>\"", ",", "\"\<offset\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", "Norm", " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"\"\<sinCoeff\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<range\>\"", ",", "\"\<sinCoeff\>\""}], "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"\"\<cosCoeff\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<range\>\"", ",", "\"\<cosCoeff\>\""}], "]"}]}], ",",
            "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Remaining", " ", "FT"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<freqs\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<ft\>\"", ",", "\"\<freqs\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<sinCoeff\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<ft\>\"", ",", "\"\<sinCoeff\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<cosCoeff\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<ft\>\"", ",", "\"\<cosCoeff\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<range\>\"", "\[Rule]", 
            RowBox[{"NetPort", "[", 
             RowBox[{"\"\<ft\>\"", ",", "\"\<range\>\""}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<ft\>\"", "->", "\"\<ftFlatten\>\""}]}], 
          "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"layerDefns", "=", 
         RowBox[{"<|", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "Offset", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<offset\>\"", "\[Rule]", 
            RowBox[{"NetArrayLayer", "[", 
             RowBox[{
              RowBox[{"\"\<Output\>\"", "\[Rule]", "1"}], ",", 
              RowBox[{"\"\<Array\>\"", "\[Rule]", "offsetFixed"}], ",", 
              RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], 
             "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"\"\<ftFlatten\>\"", "\[Rule]", 
            RowBox[{"PartLayer", "[", "1", "]"}]}]}], "\[IndentingNewLine]", 
          "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"layerConn", "=", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "Offset", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"\"\<offset\>\"", "->", "\"\<ftFlatten\>\""}], 
          "\[IndentingNewLine]", "}"}]}], ";"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "graph", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJwdzk0og3EAx/EHw0FymJeW1DYshJiZUSbJaw4sj1KUnllbslYezVpWWytp
IVPeox7DYS2aMs0KLQeXLTmhlUw5aEkOJK//33P49rl+JYxJo0umKCqfBLVM
VsebPdGs/FjpgQNXQho+hCt4D5/zCt+Jg8I53obcaPUXMdXI1cD077QWOMhO
t8PTifsdGFcX7MLM1Yymb2JMf9cGz0r2aXi+19kPR5KYKegztNrg4/Ur9Uv0
ao+yodP6I4FiT50UhtoiMsj6TsphmZ6rh7UKUyP0D112wIAjRQeF9gcDlM0H
jXDrpYiFjEphhnOzY/dCB/kZlcehtPfzCapdiy+wNBYezyamLh+YYSC0bYXi
8p5NaDsd5qDvYtILo0HBMXT5O0MwsaaMwKpKC28XPcPmELmbYgvUqERu+NfU
zbsgFXUvEd1eug/Kbz3rYaLA4tyA/wwB43M=
  "],
 CellLabel->"In[1]:=",ExpressionUUID->"32543105-d66a-47bc-a629-e0f4a372c52c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"minMax", "[", 
    RowBox[{"x_", ",", "nFourier_"}], "]"}], ":=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1.0"}], "/", "nFourier"}], ",", 
        RowBox[{"Min", "[", 
         RowBox[{
          RowBox[{"1.0", "/", "nFourier"}], ",", "#"}], "]"}]}], "]"}], "&"}],
      ",", "x"}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825701156473464*^9, 3.8257011666154757`*^9}, {
  3.825701217058936*^9, 3.825701228851843*^9}, {3.8257198003233843`*^9, 
  3.825719812820507*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"37fb00f8-9dd3-42e3-96b5-c9b0ff2c57e1"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.827354348068337*^9, 
  3.8273543492936907`*^9}},ExpressionUUID->"c6042bff-cc26-4f2f-986d-\
ecc4f93d5a7e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"freqsTest", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sinCoeffsInitTest", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.008"}], ",", "0.03", ",", "0.02", ",", "0.01"}], "}"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cosCoeffsInitTest", "=", 
   RowBox[{"{", 
    RowBox[{"0.001", ",", "0.05", ",", "0.001", ",", "0.005"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"offsetFixedTest", "=", 
    RowBox[{"{", "1.0", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"graph", "=", 
   RowBox[{"makeFourierGraph", "[", 
    RowBox[{
    "freqsTest", ",", "sinCoeffsInitTest", ",", "cosCoeffsInitTest", ",", 
     "offsetFixedTest"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.82570147183919*^9, 3.825701474524246*^9}, {
  3.825701513921007*^9, 3.825701520454009*^9}, {3.8257015609161367`*^9, 
  3.8257015662287197`*^9}, {3.825719979268244*^9, 3.825719983970439*^9}, {
  3.8257219934585037`*^9, 3.8257219951394787`*^9}, {3.8257222178877983`*^9, 
  3.825722218013771*^9}, {3.825722402304886*^9, 3.825722409471209*^9}, {
  3.825770370300054*^9, 3.825770374372892*^9}, {3.825773891627768*^9, 
  3.8257738952793093`*^9}, {3.82603537572339*^9, 3.826035386285133*^9}, {
  3.826128031391354*^9, 3.826128058006873*^9}, {3.827354352818697*^9, 
  3.827354361167927*^9}, {3.830798492408903*^9, 
  3.830798493711195*^9}},ExpressionUUID->"bd9e0421-5680-4e96-9edd-\
837bebda45bf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"tptsPltTest", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"tpt", ",", 
      RowBox[{"{", 
       RowBox[{"tpt", ",", "1", ",", "20", ",", "0.1"}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"range", "=", 
  RowBox[{
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"Abs", "[", "sinCoeffsInitTest", "]"}], "+", 
     RowBox[{"Abs", "[", "cosCoeffsInitTest", "]"}]}], "]"}], "+", 
   SuperscriptBox["10", 
    RowBox[{"-", "8"}]]}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"graph", "[", 
       RowBox[{"<|", 
        RowBox[{"\"\<tpt\>\"", "\[Rule]", 
         RowBox[{"{", "tpt", "}"}]}], "|>"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"tpt", ",", "tptsPltTest"}], "}"}]}], "]"}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"offsetFixedTest", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"sinCoeffsInitTest", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"freqsTest", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"tpt", "-", "1"}], ")"}]}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"cosCoeffsInitTest", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "*", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"freqsTest", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "*", 
                RowBox[{"(", 
                 RowBox[{"tpt", "-", "1"}], ")"}]}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "freqsTest", "]"}]}], "}"}]}], "]"}], 
          ")"}], "/", 
         RowBox[{"Max", "[", 
          RowBox[{"range", ",", "1"}], "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"tpt", ",", "tptsPltTest"}], "}"}]}], "]"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", "Dashed"}], "}"}]}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"PlotRange", "\[Rule]", "All"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.8256987329661617`*^9, 3.825698769608322*^9}, {
   3.8256988037422943`*^9, 3.82569890346896*^9}, {3.8256991837870007`*^9, 
   3.825699238262608*^9}, {3.825700896775607*^9, 3.8257009066120358`*^9}, {
   3.825701173927011*^9, 3.8257011766276608`*^9}, {3.825701248387903*^9, 
   3.825701285832068*^9}, {3.825701526050044*^9, 3.8257015303340263`*^9}, {
   3.825719992366947*^9, 3.825720005643208*^9}, 3.825720188552627*^9, {
   3.825722044117709*^9, 3.8257220441753893`*^9}, {3.825722124761979*^9, 
   3.825722127506064*^9}, {3.825722176836282*^9, 3.825722197180091*^9}, {
   3.825722389531507*^9, 3.825722392879611*^9}, {3.825725829319957*^9, 
   3.825725877331506*^9}, {3.825726405139352*^9, 3.825726428857703*^9}, {
   3.825726655571878*^9, 3.82572666650074*^9}, {3.825726740135416*^9, 
   3.825726772624181*^9}, {3.825770388941527*^9, 3.825770410800531*^9}, {
   3.825772044619223*^9, 3.825772096553166*^9}, {3.825772134134837*^9, 
   3.825772134337418*^9}, {3.825773519779071*^9, 3.8257735261238203`*^9}, {
   3.825773748733412*^9, 3.825773750169256*^9}, {3.825773898709672*^9, 
   3.8257739011981297`*^9}, {3.8260354228152113`*^9, 3.826035425194265*^9}, {
   3.8261280142749643`*^9, 3.8261280261451273`*^9}, {3.827354364219276*^9, 
   3.8273543815865993`*^9}},
 CellLabel->
  "In[231]:=",ExpressionUUID->"8aaca3fa-4328-40a3-a24d-75c36d828599"],

Cell[BoxData["0.12500001`"], "Output",
 CellChangeTimes->{{3.8256987442118073`*^9, 3.825698769891698*^9}, {
   3.825698873236226*^9, 3.8256989037323627`*^9}, {3.825699196519393*^9, 
   3.825699238528603*^9}, {3.825700894098958*^9, 3.825700907236125*^9}, 
   3.825701145369342*^9, 3.8257011769365892`*^9, {3.8257012394942636`*^9, 
   3.8257012553971863`*^9}, 3.825701286232163*^9, {3.825701531194215*^9, 
   3.825701567529331*^9}, {3.825719993268552*^9, 3.825720032048357*^9}, 
   3.8257201888488913`*^9, {3.82572198393953*^9, 3.825721996355691*^9}, 
   3.825722044550745*^9, 3.825722129884944*^9, {3.825722174127101*^9, 
   3.825722220465081*^9}, {3.825722393610094*^9, 3.825722410313593*^9}, 
   3.825725817840096*^9, {3.825725862786921*^9, 3.825725880993181*^9}, 
   3.825725936473981*^9, 3.825726397256732*^9, 3.825726429243436*^9, {
   3.825726656199533*^9, 3.825726666776093*^9}, 3.8257268221772738`*^9, {
   3.825770377881549*^9, 3.8257704113974113`*^9}, 3.8257720183609257`*^9, {
   3.82577208629335*^9, 3.825772096893199*^9}, 3.825772144494507*^9, {
   3.825773513126109*^9, 3.825773526836632*^9}, {3.825773750748349*^9, 
   3.82577375682377*^9}, 3.8257739015296793`*^9, 3.82603542555968*^9, {
   3.826128020226532*^9, 3.8261280593871727`*^9}, 3.826128105987904*^9, 
   3.827354381815803*^9},
 CellLabel->
  "Out[232]=",ExpressionUUID->"1b906659-4b91-4e41-b9d7-56ac089b0858"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, {}, 
     {RGBColor[0.9, 0.36, 0.054], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      CapForm["Butt"], 
      StyleBox[LineBox[CompressedData["
1:eJw91gtMllUYB/C3kjLdzDUyXbZOlt8wqRmfZnH7DiCC8JGA3EF6oU8bZvdw
umB7F4s01jJGArLoBfaZrtKSabnVPKtNulCr0WWtoNMGRctrt3VhM9//OX/Y
lP32PM95zjnv+7x6c+MjpVsudxzn5KU/wW/zcz5y6S+98xf8Dn5k4BM3XrCe
G9g5mEMvDOwmV9GJyM+rphcHVpH19FLkD99Ei8D+vp/Zbxnqrx2gb0X9xmI6
hP4lf5yzTkL+gTz6tsAyIX7WOjmwN38RfQfqpwfPWK8KLD4uoe9EvDVEp2D9
8DI6jPV359Crkf9GO70G+aNT9F043wvV7L8W8ePf0ncjfmoz938P1nttnE5F
v9AKnj8N9zGnlk7Hem1P0xnIP9xPZ2L9tiN0BPn6GC2xXvmwtWd85hDjWbi/
832Mw9rvYDwb/S57inHYHXiQ8Rz0b6ln3Hh6E+PrsF5PIeOwHF7HeC7282cG
47A3vYbx9YgnrmQc1plLGc9Dfu9cxmE58QPvNz+wsyNu7cGyIcb4BtTXC8Zh
P3uCz68A5+0esvZgKXYwXoj9FdcyDsuTlYxHsX78YcZh3TzAeBHWf+kc47CX
WcH93Yv9d37O/cHiNO/D2Qj/9RjPD6vJ2edfjH5LfreWsAovt/PpwX4s31qZ
fDU73yU4T2ultYTdxVmsh53t17PeeOh79i9Fv+u62B8WC7O5X+OEb+z5FCzL
VvL8m9CvrsPej4TVcw7vy1h12nlUJn80j/NZhvj8W6wl7Mrl1h7s9ERZb/Kn
ulhfjvi8v1kPu7tmn6eJaz4/ZfzhE9x/BfIzfrOWsL8qhec38e2N1goWC3bz
/ioRLxjk/cEi/y3WwyrhOOthmXyU9VWBva9eZT2sor2sh93P2E/BIrqT9dVY
L9LEeth7to71sF9fynrYrS9gfQ3W68lhPSzfS2c9rEpWs97kTyWxvhbxgiWs
h/3ROayH3cGv+f7Aemo/778O+72qmvcP638SOU+w//YYnx8sJ/ZzPjejf/Kj
fP9g978qPn9YH+b3X5l4ajPr63Ged19nPazSL7Ie9nubuH/Y6f+J+78P8QNr
eX5YHmzl+WE1onh/Jr5thvfnYr2sZDufAvZeiXKejU/VWLuwEOWcb9iPpVn7
rum/gPNu8gu/sP206fdlO/s34D6OhK0FrD44wecB64prrF2TX/Q47wf2x3+1
8+fDTncb59XEJzOttVn/mOD8NiK/doW1gEV3BecZ1j8OWbuwHJvH/rB/tM3a
N/U3XMnnBSt/j7U2/dKu4Pnvx/3+m8rzw7p9dp5gmfu8tWvyu+J8vrDzPufZ
N/mn+X1XsD/2Ju/frN/PeieG/L597A87M8+wv/FgM/vD7tmt7G/q4zXsD3uT
/P+aMvW3b2B/2G/h993ZgvpdaewPizi/fxJ2ukPsbxxexP4m/zuH/U089Cnv
H9ZJe3n/sPdyEednK/IPXW0tYK/pI86jcUentWvyR7bx+cOyjP+e+7BuqOO8
m/y+FmsNuyPvcP4fCKxe5PstYNnSyvcfdi/O8P038Yf4vfRgnbuH54fFk5/w
/mEvlmDnUZt+4ykXIv8DwNqY8Q==
        "]],
       FontSize->24]}}, {{}, {}}}, {{}, {{}, {}, 
     {GrayLevel[0.5], PointSize[
       NCache[
        Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
      Dashing[{Small, Small}], CapForm["Butt"], 
      StyleBox[LineBox[CompressedData["
1:eJw9lgs01Hkbx6nYrd5seUsr7WvWxtJaWbS5+7rkLnfGbYyZMXOUvCpaFrF5
U2JTjnu77aSdXFY2pWJtmW035JZct9wmsWmlRdFG8fae9//knDnOZ77ne57f
8zy/748Pef/2Cl8mJydX/+bzv9///5myuvrsdXfc4ykr5gvIlxU/qv1gmuF3
8WVJ1GyJLfFa6GVVcXXZxOuR5Ro/6BBA/D7Cu4bbreyJN4P3fVfkZXViFkzq
/nE+7xHV00Dosg/7lc8Sb8HH7LZadw9iLURU5M16PP+LYW0od/g3n3cg3goj
01hjBclThnXxx4uRE6tViPXQ0h6jMl48ybA+8tVY6s2exJ8huK9fKUmL2ADn
TEsGDDWIDXFzxXdux2yJjXBuy8xcRRrxdkzc7+xpHSP+HEZxxUVZAVR/B1LE
McNX7xEbg/XDVFlDCJ3fBIqV3c/KB4lNwZ846KClQ/2bYdbmPemKIGJzHBqv
uZ96mNgCJT1i68ozxJaoquj4PvVHYivEHFrVI7tCDGx2m6jxvcxwCiC/u/vn
yTLSraG6qTt+6jTp1vjs4WGZOIN0G7xumdGTTyDdBi/KEzln95Bui/LCxbxE
Dum2uPHPExXj3qTb4XDH9eECF9LtIA1KMLhsR/pOXGmOvjtrQfpOrFu9Knl8
O+n2ENeq1a//hHR7tP3e1G25mXQHHMgcOVr4LukOmMpXtBgapvk6opnVOhUr
YTjFEaWXTNhhAtKd4BQ3fIrDIt0JqZzpbJsh2p8zeuJvueSfYzjlDVdnOLIO
ku6CXiWVyx5BpLugtSHPud6fdFeMYfqAJIp0V+jlaspiz5LuBhXbqvjcv0h3
A+/alwmWfnS+XegdOS6f3UHn24X8p9l6T2gecu442fXb1rl91L876jXt746+
3b8HjF991af6jGF44J3FtgpDTSafKR4QXucWChwZlnqgpunvQenbfHtiS62+
SZI/w/DEN+NH9r5vTX5PmJgfUo7cSH5PTGqnLRUPUH0vRO153LIhh+p7offE
3RVrbei8XihRsvJS6GP6k3phm6fqOp9PqH9vPP9iOjA4g5kPvKGsmttxXI7m
5Y17rJvXpdlMHqXeSNxtxGl1oHz6oMRLvWT1RwzDB62HvNnQZDjFB03yBTP5
ruT3gY4kc2Ash/y+aPcTD6z8m/y+qE53j4t/u09flFbsWCOj/Ul90af1aWfj
ATq/H9okdskWMwzDD+YTz3P0Dah/P9Tsm9sTyWNY6odi2aYPlI7R/Pxx5z9b
PJyLaX7+yC033eRYRX5/DJzNblK4Sn5/NPnsMdS9RH422I6C/T0l5GfjRv1M
h2sh+dlYFpwT0E71pGxEW63c5hpH/gAYPv3N2CqC/AGw/+mbmKPB5A+At7as
lONF/gBkDjWGcJzJH4gumZV6gS35A5E2W21x3Zz8gbjo5CD1NCJ/II6rnWGN
aZM/CBsX7nQ6q5I/COftEgpaV5A/CF0Z9UHFvXR/gtDxp/3EWBHNPxhD2da5
7wTQ/IORt3C69+V6ylMwbkaI6q510f6CsWw2cO1QEeUzBFzv13W60XT/QrCt
tj55gU37D0G7T/9IJb3/0hCoXnThm8aSn4MN5ZP6P1eQn4Osxf115kvk52BS
/4aoMILOz4FbFmfDmT/o/KFwjLlw5PwO6j8U22+sE5QmUf+heGC7v7pRSvML
hWDxgvruVzQ/LhaVTspb6zL5ZHGxpqk09TtXyjMXS/NDmQ2BDHO56NRW3cDy
pXy/8Y9O1wjMGBZzkdz3QKdUifLOhUz/mKbLXaaejIv6osq2rjSqH4a918wC
fzRkmBUGczObpV9raR9hcOhqqfN7j2FuGGaHOAlu+2k+YXgUIo0YnGDyJw5D
VPzKl3mplNcw3LdRKh+1ZFgWhn91X/nlCovyy8PEbcflQToMs3iYHkn3zvej
PPOwJD/Q8+Acw1we4sqjlnetovo8KL7svnUplWExDxfW/LlGTZH2xUNDluET
cTrDMh7UNbYvmC6n/vkQOszz502pfz6k3rsa097miY/5WwteO79mmMvHhRzL
pBwJ7ZcP5Rd7X/5CeRbzwa967vyE3ncpH1GOqYVdF2n+fCw1SLrPkF9OgMmC
pY9O51F9ATKcteVeHaH6AqT+tG9jcSzVF0BvYxL7qZDqC6DmZPO5JJDqC7Dr
K1buKP2/JhXgma/+nK4T1RfgiwHJqUR63+XCEekocY83o/rhMPjBaJOE3j+E
I0ia/jpPi+qHY9VBHSVDFaofjplqBY1+OaofjrVbCzS02mj+4bjNkdRpn6T5
h6M5s4z/rRvlR4i0e9FzpSsZZgmh3/RtWcRtyqMQQwuPjmdkM8wV4uGd+ocN
u2n/QgiapSo+9PdcLER0pdNgWDDlXYja5JyZokSGZULM9WfoNdZQ/kVwU2x7
fIruN0uE1qO6kYlJdP9FGO1cLlh6RfdfhPnNQs299F6miFCe+fjXnenUvwiy
9q+NY1po/iJ4Zt4rFSgweZSJ8PG1Yx2DBtNW/wVAd+Me
        "]],
       FontSize->24]}}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{False, False},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0.9005529681841535},
  BaseStyle->{FontSize -> 24},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->Automatic,
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{{0}, {0}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImageSize->400,
  LabelStyle->{FontFamily -> "Times"},
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->All,
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.8256987442118073`*^9, 3.825698769891698*^9}, {
   3.825698873236226*^9, 3.8256989037323627`*^9}, {3.825699196519393*^9, 
   3.825699238528603*^9}, {3.825700894098958*^9, 3.825700907236125*^9}, 
   3.825701145369342*^9, 3.8257011769365892`*^9, {3.8257012394942636`*^9, 
   3.8257012553971863`*^9}, 3.825701286232163*^9, {3.825701531194215*^9, 
   3.825701567529331*^9}, {3.825719993268552*^9, 3.825720032048357*^9}, 
   3.8257201888488913`*^9, {3.82572198393953*^9, 3.825721996355691*^9}, 
   3.825722044550745*^9, 3.825722129884944*^9, {3.825722174127101*^9, 
   3.825722220465081*^9}, {3.825722393610094*^9, 3.825722410313593*^9}, 
   3.825725817840096*^9, {3.825725862786921*^9, 3.825725880993181*^9}, 
   3.825725936473981*^9, 3.825726397256732*^9, 3.825726429243436*^9, {
   3.825726656199533*^9, 3.825726666776093*^9}, 3.8257268221772738`*^9, {
   3.825770377881549*^9, 3.8257704113974113`*^9}, 3.8257720183609257`*^9, {
   3.82577208629335*^9, 3.825772096893199*^9}, 3.825772144494507*^9, {
   3.825773513126109*^9, 3.825773526836632*^9}, {3.825773750748349*^9, 
   3.82577375682377*^9}, 3.8257739015296793`*^9, 3.82603542555968*^9, {
   3.826128020226532*^9, 3.8261280593871727`*^9}, 3.826128105987904*^9, 
   3.827354381917095*^9},
 CellLabel->
  "Out[233]=",ExpressionUUID->"ceec4374-948b-4ec0-b6e7-fdebe809d7de"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "freqsTest", ",", "sinCoeffsInitTest", ",", "cosCoeffsInitTest", ",", 
   "offsetFixedTest", ",", "graph", ",", "tptsPltTest", ",", "range"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.827364670146693*^9, 3.8273646837846327`*^9}},
 CellLabel->
  "In[1205]:=",ExpressionUUID->"d81f9a81-fa8d-4acb-adee-4a92484d441b"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Inverse of diagonal matrix", "Title",
 CellChangeTimes->{{3.825702835048008*^9, 3.825702835367131*^9}, {
  3.825784369245984*^9, 3.825784370147066*^9}, {3.827354891466488*^9, 
  3.827354894788871*^9}},ExpressionUUID->"46f1c9ea-80e8-46a1-860d-\
8b88772d3017"],

Cell[CellGroupData[{

Cell["Inverse of diagonal matrix", "Chapter",
 CellChangeTimes->{{3.827355735474407*^9, 
  3.8273557400783043`*^9}},ExpressionUUID->"58c2c622-0ee6-4775-bfcb-\
7570bd94d2eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"inverseDiagMatLayer", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "=", 
       RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", ">", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"layerDefns", "[", "\"\<nil\>\"", "]"}], "=", 
          RowBox[{"NetArrayLayer", "[", 
           RowBox[{
            RowBox[{"\"\<Array\>\"", "\[Rule]", 
             RowBox[{"{", "0.0", "}"}]}], ",", 
            RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], "]"}]}],
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"layerDefns", "[", "\"\<catenate\>\"", "]"}], "=", 
       RowBox[{"CatenateLayer", "[", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"layerDefns", "[", "\"\<reshape\>\"", "]"}], "=", 
       RowBox[{"ReshapeLayer", "[", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"layerDefns", "[", 
           RowBox[{"\"\<inv\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "=", 
          RowBox[{"ElementwiseLayer", "[", 
           RowBox[{
            SuperscriptBox["#", 
             RowBox[{"-", "1"}]], "&"}], "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"layerDefns", "[", 
           RowBox[{"\"\<part\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "=", 
          RowBox[{"PartLayer", "[", 
           RowBox[{"{", 
            RowBox[{"i", ",", "i"}], "}"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"layerDefns", "[", 
           RowBox[{"\"\<reshape\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "=", 
          RowBox[{"ReshapeLayer", "[", 
           RowBox[{"{", "1", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"layerConn", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"i", "\[Equal]", "j"}], ",", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"layerConn", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\"\<part\>\"", "<>", 
                  RowBox[{"ToString", "[", "i", "]"}]}], ")"}], "->", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\"\<inv\>\"", "<>", 
                   RowBox[{"ToString", "[", "i", "]"}]}], ")"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\"\<reshape\>\"", "<>", 
                    RowBox[{"ToString", "[", "i", "]"}]}], ")"}], "->", 
                  "\"\<catenate\>\""}]}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"layerConn", ",", 
               RowBox[{"\"\<nil\>\"", "\[Rule]", "\"\<catenate\>\""}]}], 
              "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
           ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "n"}], "}"}]}], "]"}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"AppendTo", "[", 
       RowBox[{"layerConn", ",", 
        RowBox[{"\"\<catenate\>\"", "->", "\"\<reshape\>\""}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"NetGraph", "[", 
        RowBox[{"layerDefns", ",", "layerConn", ",", 
         RowBox[{"\"\<Input\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"n", ",", "n"}], "}"}]}]}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827354900487368*^9, 3.827354910782196*^9}, {
  3.827354955771167*^9, 3.827354959278924*^9}, {3.8273549992261*^9, 
  3.827355131797268*^9}, {3.827355201216344*^9, 3.82735527230268*^9}, {
  3.8273553165979147`*^9, 3.8273553846236153`*^9}, {3.827355478384199*^9, 
  3.827355653454866*^9}, {3.827426022637334*^9, 3.827426025834445*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"c5ae758e-7d92-49b4-a618-114f1b6a6b90"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.827355741840383*^9, 
  3.827355742119343*^9}},ExpressionUUID->"f5b0d2e4-3090-4b8b-87ff-\
e95ae03a18fb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"testMat", "=", 
   RowBox[{
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"{", 
      RowBox[{"5", ",", "6"}], "}"}], "]"}], "//", "N"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"layer", "=", 
    RowBox[{"inverseDiagMatLayer", "[", "2", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"layer", "[", "testMat", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Inverse", "[", "testMat", "]"}]}], "Input",
 CellChangeTimes->{{3.827354920827569*^9, 3.827354938260607*^9}, {
  3.8273555065536957`*^9, 3.8273555136336*^9}, {3.827355696280562*^9, 
  3.8273557092322187`*^9}},
 CellLabel->
  "In[365]:=",ExpressionUUID->"ac7172b7-b440-4bda-932e-fea6f5bc4945"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.20000000298023224`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.1666666716337204`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.827355528703334*^9, 3.827355571128907*^9}, {
  3.8273556027489634`*^9, 3.8273556543904457`*^9}, {3.827355704289567*^9, 
  3.82735570962481*^9}},
 CellLabel->
  "Out[367]=",ExpressionUUID->"a016224d-669b-4a05-acfb-35809088d568"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.2`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", "0.16666666666666666`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.827355528703334*^9, 3.827355571128907*^9}, {
  3.8273556027489634`*^9, 3.8273556543904457`*^9}, {3.827355704289567*^9, 
  3.82735570962654*^9}},
 CellLabel->
  "Out[368]=",ExpressionUUID->"947c29f7-b216-4ec3-a079-b3671521936e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"testMat", ",", "layer"}], "]"}]], "Input",
 CellChangeTimes->{{3.827364691362932*^9, 3.827364694671185*^9}},
 CellLabel->
  "In[1206]:=",ExpressionUUID->"a27c667e-dd2f-4785-8134-7447b4114b76"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert params layer", "Title",
 CellChangeTimes->{{3.825704279392277*^9, 
  3.8257042817082033`*^9}},ExpressionUUID->"65ddda7d-81a2-477d-b031-\
9b6318b22c4a"],

Cell[CellGroupData[{

Cell["Convert b", "Chapter",
 CellChangeTimes->{{3.827354485921327*^9, 
  3.827354487020053*^9}},ExpressionUUID->"234c5c85-9bab-4473-aa2a-\
1eea602dc55f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"convertbLayer", "[", 
    RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "=", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<fn\>\"", "->", 
          RowBox[{"FunctionLayer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#b1", "+", 
              RowBox[{"Flatten", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "#wt1", "]"}], ".", "#muh1"}], 
               "]"}], "-", 
              RowBox[{
               RowBox[{"Transpose", "[", "#wt1", "]"}], ".", 
               RowBox[{"Sqrt", "[", "#varh1", "]"}], ".", 
               RowBox[{"Sqrt", "[", "#invvarh2", "]"}], ".", "#muh2"}]}], 
             "&"}], ",", 
            RowBox[{"\"\<b1\>\"", "\[Rule]", "nv"}], ",", 
            RowBox[{"\"\<wt1\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
            RowBox[{"\"\<muh1\>\"", "\[Rule]", "nh"}], ",", 
            RowBox[{"\"\<varh1\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
            RowBox[{"\"\<muh2\>\"", "\[Rule]", "nh"}], ",", 
            RowBox[{"\"\<invvarh2\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"nh", ",", "nh"}], "}"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<invvarh2\>\"", "->", 
          RowBox[{"inverseDiagMatLayer", "[", "nh", "]"}]}]}], 
        "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"layerConn", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh2\>\"", "]"}], "->", 
         RowBox[{"\"\<invvarh2\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<fn\>\"", ",", "\"\<invvarh2\>\""}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"NetGraph", "[", 
        RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826992117982533*^9, 3.826992255647401*^9}, {
  3.826992441716584*^9, 3.826992473374321*^9}, {3.827002296975027*^9, 
  3.827002313998851*^9}, {3.827002418676659*^9, 3.827002420342517*^9}, {
  3.827354422255254*^9, 3.827354423063596*^9}, {3.827355780551304*^9, 
  3.8273557966815*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"2a624d7d-0f44-4d9d-9d11-16d434d00080"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.827354484085939*^9, 
  3.827354484398246*^9}},ExpressionUUID->"e8aec30b-da52-42b9-bfea-\
b70c76d3345f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"b1Test", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wt1Test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "7", ",", "8"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muh1Test", "=", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh1Test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh2Test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "6"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muh2Test", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"b2True", "=", 
  RowBox[{
   RowBox[{"b1Test", "+", 
    RowBox[{
     RowBox[{"Transpose", "[", "wt1Test", "]"}], ".", "muh1Test"}], "-", 
    RowBox[{
     RowBox[{"Transpose", "[", "wt1Test", "]"}], ".", 
     RowBox[{"Sqrt", "[", "varh1Test", "]"}], ".", 
     RowBox[{"Inverse", "[", 
      RowBox[{"Sqrt", "[", "varh2Test", "]"}], "]"}], ".", "muh2Test"}]}], "//",
    "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"b2Actual", "=", 
  RowBox[{
   RowBox[{"convertbLayer", "[", 
    RowBox[{"3", ",", "2"}], "]"}], "[", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<b1\>\"", "\[Rule]", "b1Test"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"\"\<wt1\>\"", "\[Rule]", "wt1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<muh1\>\"", "\[Rule]", "muh1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh1\>\"", "\[Rule]", "varh1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh2\>\"", "\[Rule]", "varh2Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<muh2\>\"", "\[Rule]", "muh2Test"}]}], "\[IndentingNewLine]",
     "|>"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.825704547918667*^9, 3.825704625860607*^9}, {
   3.825704813372499*^9, 3.825704826223818*^9}, 3.825704864563471*^9, {
   3.825704940466617*^9, 3.8257049414519663`*^9}, {3.8269922788783417`*^9, 
   3.8269923324388514`*^9}},
 CellLabel->
  "In[370]:=",ExpressionUUID->"e00ca8e7-ae7b-4a23-8a05-aa4385e2e04a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.6396070634490627`", ",", "3.4716115714490883`", ",", 
   "5.303616079449112`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8257046222135143`*^9, 3.82570462611124*^9}, {
   3.8257048179870358`*^9, 3.8257048265238867`*^9}, 3.825704941753586*^9, {
   3.826992276541993*^9, 3.8269922795369368`*^9}, {3.8269923271120653`*^9, 
   3.8269923327134523`*^9}, {3.826992445334754*^9, 3.826992475072049*^9}, 
   3.827354393485276*^9, 3.827354425697234*^9, 3.827355799772089*^9},
 CellLabel->
  "Out[376]=",ExpressionUUID->"ea48707d-8a68-41dd-8aee-fc4f0bec15b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.6396064758300781`", ",", "3.4716110229492188`", ",", 
   "5.303619384765625`"}], "}"}]], "Output",
 CellChangeTimes->{{3.8257046222135143`*^9, 3.82570462611124*^9}, {
   3.8257048179870358`*^9, 3.8257048265238867`*^9}, 3.825704941753586*^9, {
   3.826992276541993*^9, 3.8269922795369368`*^9}, {3.8269923271120653`*^9, 
   3.8269923327134523`*^9}, {3.826992445334754*^9, 3.826992475072049*^9}, 
   3.827354393485276*^9, 3.827354425697234*^9, 3.827355800032157*^9},
 CellLabel->
  "Out[377]=",ExpressionUUID->"cac1c27b-9b4d-49ac-8072-da9ba6ec76fe"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "b1Test", ",", "wt1Test", ",", "muh1Test", ",", "varh1Test", ",", 
   "varh2Test", ",", "muh2Test", ",", "b2True", ",", "b2Actual"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.827364697845413*^9, 3.827364715189191*^9}},
 CellLabel->
  "In[1207]:=",ExpressionUUID->"5b349017-1642-48e9-9321-2f45d789426f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convert wt", "Chapter",
 CellChangeTimes->{{3.8273544786522427`*^9, 
  3.8273544798358393`*^9}},ExpressionUUID->"7726c12a-ff78-4822-b28d-\
3b50ccc9f61d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"convertwtLayer", "[", 
    RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "=", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<fn\>\"", "->", 
          RowBox[{"FunctionLayer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Sqrt", "[", "#invvarh2", "]"}], ".", 
              RowBox[{"Sqrt", "[", "#varh1", "]"}], ".", "#wt1"}], "&"}], ",", 
            RowBox[{"\"\<invvarh2\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
            RowBox[{"\"\<wt1\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
            RowBox[{"\"\<varh1\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"nh", ",", "nh"}], "}"}]}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<invvarh2\>\"", "->", 
          RowBox[{"inverseDiagMatLayer", "[", "nh", "]"}]}]}], 
        "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"layerConn", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh2\>\"", "]"}], "->", 
         RowBox[{"\"\<invvarh2\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<fn\>\"", ",", "\"\<invvarh2\>\""}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"NetGraph", "[", 
        RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825704293704557*^9, 3.825704362162993*^9}, {
  3.825704399722686*^9, 3.825704444589329*^9}, {3.8257045094889183`*^9, 
  3.8257045124095488`*^9}, {3.825704716376679*^9, 3.825704748168625*^9}, {
  3.825704936451956*^9, 3.82570493792344*^9}, {3.826992092428464*^9, 
  3.826992094097423*^9}, {3.826992529354065*^9, 3.826992565043372*^9}, {
  3.8270023196190968`*^9, 3.827002321240686*^9}, {3.827354431234078*^9, 
  3.827354467822731*^9}, {3.827355811617999*^9, 3.827355815812573*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"1c05b6a8-f56f-4006-804c-69e86dbf262d"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.827354482137348*^9, 
  3.8273544823753967`*^9}},ExpressionUUID->"458d2c7b-32d4-4dd4-a3b7-\
579e121d3948"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"wt1Test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "7", ",", "8"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh1Test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "4"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh2Test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "6"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"wt2True", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"Sqrt", "[", "varh2Test", "]"}], "]"}], ".", 
    RowBox[{"Sqrt", "[", "varh1Test", "]"}], ".", "wt1Test"}], "//", 
   "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"wt2Actual", "=", 
  RowBox[{
   RowBox[{"convertwtLayer", "[", 
    RowBox[{"3", ",", "2"}], "]"}], "[", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<wt1\>\"", "\[Rule]", "wt1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh1\>\"", "\[Rule]", "varh1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh2\>\"", "\[Rule]", "varh2Test"}]}], 
    "\[IndentingNewLine]", "|>"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.825704869600503*^9, 3.8257049110809526`*^9}, {
  3.825704944698711*^9, 3.8257049455081778`*^9}, {3.826992572618511*^9, 
  3.8269925858740997`*^9}},
 CellLabel->
  "In[379]:=",ExpressionUUID->"2baa5183-835a-4ff4-b7b4-45c971cce523"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.32379000772445`", ",", "3.0983866769659336`", ",", 
     "3.872983346207417`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.898979485566356`", ",", "5.715476066494082`", ",", 
     "6.531972647421808`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.825704911323472*^9, 3.8257049457571907`*^9, {3.826992582563655*^9, 
   3.826992586127448*^9}, {3.827354432754603*^9, 3.827354468409807*^9}, 
   3.827355818187058*^9},
 CellLabel->
  "Out[382]=",ExpressionUUID->"7f5cb75c-85d8-45f1-85a8-4965838e730b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "2.3237898349761963`", ",", "3.098386526107788`", ",", 
     "3.87298321723938`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4.898979663848877`", ",", "5.715476036071777`", ",", 
     "6.531972885131836`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.825704911323472*^9, 3.8257049457571907`*^9, {3.826992582563655*^9, 
   3.826992586127448*^9}, {3.827354432754603*^9, 3.827354468409807*^9}, 
   3.827355818289288*^9},
 CellLabel->
  "Out[383]=",ExpressionUUID->"2e77a1a6-29dc-4485-8979-e418d24c132a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "wt1Test", ",", "varh1Test", ",", "varh2Test", ",", "wt2True", ",", 
   "wt2Actual"}], "]"}]], "Input",
 CellChangeTimes->{{3.8273647195375633`*^9, 3.827364731541911*^9}},
 CellLabel->
  "In[1208]:=",ExpressionUUID->"2038d826-2b7c-4d11-88d4-53bc6d7474bc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convert b from 0", "Chapter",
 CellChangeTimes->{{3.825704279392277*^9, 3.8257042817082033`*^9}, {
   3.825705486761505*^9, 3.825705487520769*^9}, 
   3.827354497318215*^9},ExpressionUUID->"e1d1d40b-6d25-42e1-bd96-\
0620b2c8a6aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"convertbLayerFrom0", "[", 
    RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "=", 
       RowBox[{"<|", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\"\<fn\>\"", "->", 
          RowBox[{"FunctionLayer", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#b1", "-", 
              RowBox[{
               RowBox[{"Transpose", "[", "#wt1", "]"}], ".", 
               RowBox[{"Sqrt", "[", "#invvarh2", "]"}], ".", "#muh2"}]}], 
             "&"}], ",", 
            RowBox[{"\"\<b1\>\"", "\[Rule]", "nv"}], ",", 
            RowBox[{"\"\<wt1\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
            RowBox[{"\"\<invvarh2\>\"", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
            RowBox[{"\"\<muh2\>\"", "\[Rule]", "nh"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<invvarh2\>\"", "->", 
          RowBox[{"inverseDiagMatLayer", "[", "nh", "]"}]}]}], 
        "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"layerConn", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh2\>\"", "]"}], "->", 
         RowBox[{"\"\<invvarh2\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<fn\>\"", ",", "\"\<invvarh2\>\""}], "]"}]}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"NetGraph", "[", 
        RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825704293704557*^9, 3.825704362162993*^9}, {
  3.825704399722686*^9, 3.825704444589329*^9}, {3.8257045094889183`*^9, 
  3.8257045124095488`*^9}, {3.8257049315377493`*^9, 3.825704934519601*^9}, {
  3.825705490007474*^9, 3.825705510783823*^9}, {3.826992664227812*^9, 
  3.82699268961197*^9}, {3.826992728188504*^9, 3.826992735330119*^9}, {
  3.827001492765134*^9, 3.827001536767548*^9}, {3.827001575601006*^9, 
  3.827001585630834*^9}, {3.827355831262038*^9, 3.8273558410076942`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"150883d2-624d-40c6-a0fa-fc0a2bc65725"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.827354490111052*^9, 
  3.8273544903607264`*^9}},ExpressionUUID->"6e49b6a6-b5bb-4c5c-8c7a-\
274a515b2056"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"b1Test", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wt1Test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "7", ",", "8"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh2Test", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"5", ",", "6"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muh2Test", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"b2True", "=", 
  RowBox[{
   RowBox[{"b1Test", "-", 
    RowBox[{
     RowBox[{"Transpose", "[", "wt1Test", "]"}], ".", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"Inverse", "[", "varh2Test", "]"}], "]"}], ".", "muh2Test"}]}], 
   "//", "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"layer", "=", 
  RowBox[{"convertbLayerFrom0", "[", 
   RowBox[{"3", ",", "2"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"b2Actual", "=", 
  RowBox[{"layer", "[", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<b1\>\"", "\[Rule]", "b1Test"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"\"\<wt1\>\"", "\[Rule]", "wt1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh2\>\"", "\[Rule]", "varh2Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<muh2\>\"", "\[Rule]", "muh2Test"}]}], "\[IndentingNewLine]",
     "|>"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.8273545391427517`*^9, 3.8273546155789843`*^9}, {
  3.827354864268132*^9, 3.8273548700937147`*^9}},
 CellLabel->
  "In[1209]:=",ExpressionUUID->"6d98dd5d-7a7b-414c-92ae-22d6a40780a1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "21.27919951526517`"}], ",", 
   RowBox[{"-", "24.43961302997599`"}], ",", 
   RowBox[{"-", "27.600026544686813`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.827354553735189*^9, 3.827354582620412*^9}, 
   3.827354615835125*^9, 3.827354870357381*^9, 3.827355848500135*^9, 
   3.827364737961747*^9},
 CellLabel->
  "Out[1213]=",ExpressionUUID->"e846ae75-2735-4b98-930f-8f77aebfe469"],

Cell[BoxData[
 TagBox[
  TemplateBox[{
    RowBox[{
      StyleBox[
       TagBox["NetGraph", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open = True), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              StyleBox[
               GraphicsBox[{
                 Thickness[0.0149], {
                  RGBColor[0.729, 0.729, 0.729], 
                  Thickness[0.03], 
                  Opacity[1.], 
                  JoinForm[{"Miter", 10.}], 
                  
                  JoinedCurveBox[{{{1, 4, 3}}}, {{{18., 37.}, {18., 37.}, {
                   18.5, 27.5}, {35., 27.}}}, CurveClosed -> {0}], 
                  
                  JoinedCurveBox[{{{1, 4, 3}}}, {{{50., 37.}, {50., 37.}, {
                   49.5, 27.5}, {33., 27.}}}, CurveClosed -> {0}], 
                  
                  JoinedCurveBox[{{{1, 4, 3}}}, {{{18., 16.}, {18., 16.}, {
                   18.5, 25.5}, {35., 26.}}}, CurveClosed -> {0}]}, {
                  FaceForm[
                   RGBColor[0.631, 0.8160000000000001, 0.498]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5,
                    40.5}, {22.5, 40.5}, {22.5, 33.5}, {15.5, 33.5}}}]}, {
                  FaceForm[
                   RGBColor[0.40800000000000003`, 0.627, 0.196]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 41.}, {15., 41.}, {15.,
                    33.}, {23., 33.}}, {{22., 34.}, {16., 34.}, {16., 40.}, {
                   22., 40.}}}]}, {
                  FaceForm[
                   RGBColor[0.38, 0.753, 0.89]], 
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5,
                    19.5}, {22.5, 19.5}, {22.5, 12.5}, {15.5, 12.5}}}]}, {
                  FaceForm[
                   RGBColor[0.24300000000000002`, 0.608, 0.71]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 20.}, {15., 20.}, {15.,
                    12.}, {23., 12.}}, {{22., 13.}, {16., 13.}, {16., 19.}, {
                   22., 19.}}}]}, {
                  FaceForm[
                   RGBColor[0.584, 0.51, 0.8390000000000001]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{30.5,
                    30.5}, {37.5, 30.5}, {37.5, 23.5}, {30.5, 23.5}}}]}, {
                  FaceForm[
                   RGBColor[0.4, 0.396, 0.659]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 31.}, {30., 31.}, {30.,
                    23.}, {38., 23.}}, {{37., 24.}, {31., 24.}, {31., 30.}, {
                   37., 30.}}}]}, {
                  FaceForm[
                   RGBColor[0.8270000000000001, 0.41200000000000003`, 0.133]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{45.5,
                    40.5}, {52.5, 40.5}, {52.5, 33.5}, {45.5, 33.5}}}]}, {
                  FaceForm[
                   RGBColor[0.647, 0.259, 0.08600000000000001]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{53., 41.}, {45., 41.}, {45.,
                    33.}, {53., 33.}}, {{52., 34.}, {46., 34.}, {46., 40.}, {
                   52., 40.}}}]}}, ImageMargins -> 0, 
                ImageSize -> {36, Automatic}, PlotRangePadding -> 0], 
               CacheGraphics -> False], 
              GridBox[{{
                 StyleBox[
                  
                  TemplateBox[{"\"Number of inputs\"", "\":\""}, 
                   "RowDefault"], "SummaryItemAnnotation"], 
                 StyleBox["4", "SummaryItem"]}, {
                 StyleBox[
                  TemplateBox[{
                    TemplateBox[{"\[ThinSpace]", "\" \"", 
                    StyleBox["\"Output\"", 
                    GrayLevel[0], StripOnInput -> False], "\"port\""}, 
                    "RowWithSeparators"], "\":\""}, "RowDefault"], 
                  "SummaryItemAnnotation"], 
                 StyleBox[
                  TemplateBox[{"\[ThinSpace]", "\" \"", "\"vector\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 3\[VeryThinSpace])\"", 
                    GrayLevel[0.5], StripOnInput -> False]}, 
                   "RowWithSeparators"], "SummaryItem"]}}, BaselinePosition -> 
               Automatic, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, BaselinePosition -> {1, 3}],
           True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open = False), Appearance -> None, 
                Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> {Automatic, 24}], 
              StyleBox[
               GraphicsBox[{
                 Thickness[0.0149], {
                  RGBColor[0.729, 0.729, 0.729], 
                  Thickness[0.03], 
                  Opacity[1.], 
                  JoinForm[{"Miter", 10.}], 
                  
                  JoinedCurveBox[{{{1, 4, 3}}}, {{{18., 37.}, {18., 37.}, {
                   18.5, 27.5}, {35., 27.}}}, CurveClosed -> {0}], 
                  
                  JoinedCurveBox[{{{1, 4, 3}}}, {{{50., 37.}, {50., 37.}, {
                   49.5, 27.5}, {33., 27.}}}, CurveClosed -> {0}], 
                  
                  JoinedCurveBox[{{{1, 4, 3}}}, {{{18., 16.}, {18., 16.}, {
                   18.5, 25.5}, {35., 26.}}}, CurveClosed -> {0}]}, {
                  FaceForm[
                   RGBColor[0.631, 0.8160000000000001, 0.498]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5,
                    40.5}, {22.5, 40.5}, {22.5, 33.5}, {15.5, 33.5}}}]}, {
                  FaceForm[
                   RGBColor[0.40800000000000003`, 0.627, 0.196]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 41.}, {15., 41.}, {15.,
                    33.}, {23., 33.}}, {{22., 34.}, {16., 34.}, {16., 40.}, {
                   22., 40.}}}]}, {
                  FaceForm[
                   RGBColor[0.38, 0.753, 0.89]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{15.5,
                    19.5}, {22.5, 19.5}, {22.5, 12.5}, {15.5, 12.5}}}]}, {
                  FaceForm[
                   RGBColor[0.24300000000000002`, 0.608, 0.71]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 20.}, {15., 20.}, {15.,
                    12.}, {23., 12.}}, {{22., 13.}, {16., 13.}, {16., 19.}, {
                   22., 19.}}}]}, {
                  FaceForm[
                   RGBColor[0.584, 0.51, 0.8390000000000001]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{30.5,
                    30.5}, {37.5, 30.5}, {37.5, 23.5}, {30.5, 23.5}}}]}, {
                  FaceForm[
                   RGBColor[0.4, 0.396, 0.659]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 31.}, {30., 31.}, {30.,
                    23.}, {38., 23.}}, {{37., 24.}, {31., 24.}, {31., 30.}, {
                   37., 30.}}}]}, {
                  FaceForm[
                   RGBColor[0.8270000000000001, 0.41200000000000003`, 0.133]], 
                  
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{45.5,
                    40.5}, {52.5, 40.5}, {52.5, 33.5}, {45.5, 33.5}}}]}, {
                  FaceForm[
                   RGBColor[0.647, 0.259, 0.08600000000000001]], 
                  FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2, 
                   0}, {0, 1, 0}, {0, 1, 0}}}, {{{53., 41.}, {45., 41.}, {45.,
                    33.}, {53., 33.}}, {{52., 34.}, {46., 34.}, {46., 40.}, {
                   52., 40.}}}]}}, ImageMargins -> 0, 
                ImageSize -> {36, Automatic}, PlotRangePadding -> 0], 
               CacheGraphics -> False], 
              GridBox[{{
                 
                 DynamicModuleBox[{
                  NeuralNetworks`Private`NetGraph`selection = None}, 
                  GridBox[{{
                    TagBox[
                    GraphicsBox[{{
                    StyleBox[{
                    InsetBox[
                    FormBox["\"b1\"", TraditionalForm], 
                    
                    Offset[{0, -7}, {-1.9999999999999993`, 
                    5.3589794058235685`*^-8}], 
                    ImageScaled[{
                    Rational[1, 2], 1.}], Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"fn\"", TraditionalForm], 
                    NCache[
                    Offset[{0, 
                    Rational[-31, 2]}, {-0.9999999464102056, 
                    2.0000000267948965`}], 
                    
                    Offset[{0, -15.5}, {-0.9999999464102056, 
                    2.0000000267948965`}]], 
                    ImageScaled[{
                    Rational[1, 2], 1.}], Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"muh2\"", TraditionalForm], 
                    
                    Offset[{0, -7}, {-1.9999999732051024`, 
                    1.0000000535897937`}], 
                    ImageScaled[{
                    Rational[1, 2], 1.}], Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"varh2\"", TraditionalForm], 
                    
                    Offset[{0, -7}, {-2.999999946410205, 
                    2.0000000803846905`}], 
                    ImageScaled[{
                    Rational[1, 2], 1.}], Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"invvarh2\"", TraditionalForm], 
                    NCache[
                    Offset[{0, 
                    Rational[-31, 2]}, {-1.9999999464102052`, 
                    2.0000000535897935`}], 
                    
                    Offset[{0, -15.5}, {-1.9999999464102052`, 
                    2.0000000535897935`}]], 
                    ImageScaled[{
                    Rational[1, 2], 1.}], Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"wt1\"", TraditionalForm], 
                    
                    Offset[{0, -7}, {-1.9999999196153082`, 
                    3.000000053589793}], 
                    ImageScaled[{
                    Rational[1, 2], 1.}], Automatic, {1, 0}], 
                    InsetBox[
                    FormBox["\"Output\"", TraditionalForm], 
                    
                    Offset[{0, -7}, {5.3589794058235685`*^-8, 
                    1.9999999999999993`}], 
                    ImageScaled[{
                    Rational[1, 2], 1.}], Automatic, {1, 0}]}, {
                    FontColor -> GrayLevel[0.5]}, StripOnInput -> False], 
                    StyleBox[{
                    InsetBox[
                    FormBox["\"3\"", TraditionalForm], 
                    
                    Offset[{-4.919349484592803, 
                    2.4596749070632327`}, {-1.4559016702793783`, 
                    1.0881966401357466`}], 
                    ImageScaled[{0.5, 0.415}], Automatic, {
                    0.44721361946604227`, 0.8944271790168733}], 
                    InsetBox[
                    FormBox["\"2\"", TraditionalForm], 
                    
                    Offset[{-3.889087192318317, 
                    3.8890874007337035`}, {-1.449999958467909, 
                    1.5500000388526003`}], 
                    ImageScaled[{0.5, 0.415}], Automatic, {0.7071068001334007,
                     0.7071067622396939}], 
                    InsetBox[
                    FormBox[
                    
                    TemplateBox[{
                    "\[Times]", "\"\[Times]\"", "\"2\"", "\"2\""}, 
                    "RowWithSeparators"], TraditionalForm], 
                    
                    Offset[{1.473719333233702*^-7, 
                    5.499999999999997}, {-2.4499999464102054`, 
                    2.000000065647497}], 
                    ImageScaled[{0.5, 0.415}], Automatic, {
                    0.9999999999999996, -2.6794896967885493`*^-8}], 
                    InsetBox[
                    FormBox[
                    
                    TemplateBox[{
                    "\[Times]", "\"\[Times]\"", "\"2\"", "\"3\""}, 
                    "RowWithSeparators"], TraditionalForm], 
                    
                    Offset[{3.8890874007337035`, 
                    3.889087192318317}, {-1.4499999343525016`, 
                    2.4500000388525995`}], 
                    ImageScaled[{0.5, 0.415}], Automatic, {
                    0.7071067622396939, -0.7071068001334007}], 
                    InsetBox[
                    FormBox["\"3\"", TraditionalForm], 
                    
                    Offset[{1.473719345446156*^-7, 
                    5.499999999999998}, {-0.4499999464102058, 
                    2.000000012057703}], 
                    ImageScaled[{0.5, 0.415}], Automatic, {
                    0.9999999999999997, -2.679489718993011*^-8}], 
                    InsetBox[
                    FormBox[
                    
                    TemplateBox[{
                    "\[Times]", "\"\[Times]\"", "\"2\"", "\"2\""}, 
                    "RowWithSeparators"], TraditionalForm], 
                    
                    Offset[{1.473719333233703*^-7, 
                    5.499999999999999}, {-1.4499999464102054`, 
                    2.0000000388526002`}], 
                    ImageScaled[{0.5, 0.415}], Automatic, {
                    0.9999999999999998, -2.6794896967885513`*^-8}]}, {
                    FontColor -> GrayLevel[0.7], FontSize -> 8, FontWeight -> 
                    "Thin"}, StripOnInput -> False]}, {
                    GrayLevel[0.7], {
                    TagBox[
                    TooltipBox[
                    
                    LineBox[{{-1.9999999999999993`, 
                    5.3589794058235685`*^-8}, {-0.9999999464102056, 
                    2.0000000267948965`}}], 
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"vector\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 3\[VeryThinSpace])\"", 
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"b1\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"\"", TraditionalForm], 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"[\"", TraditionalForm], 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"b1\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"vector", 
                    Style["(\[VeryThinSpace]size: 3\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"b1", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["", 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["[", 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "b1"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ], 
                    TagBox[
                    TooltipBox[
                    
                    LineBox[{{-1.9999999732051024`, 
                    1.0000000535897937`}, {-0.9999999464102056, 
                    2.0000000267948965`}}], 
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"vector\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 2\[VeryThinSpace])\"", 
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"muh2\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"\"", TraditionalForm], 
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"[\"", TraditionalForm], 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"muh2\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"vector", 
                    Style["(\[VeryThinSpace]size: 2\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"muh2", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["", 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["[", 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "muh2"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ], 
                    TagBox[
                    TooltipBox[
                    
                    LineBox[{{-2.999999946410205, 
                    2.0000000803846905`}, {-1.9999999464102052`, 
                    2.0000000535897935`}}], 
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"matrix\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 2\[Times]2\[VeryThinSpace])\"", 
                    
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"varh2\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"\"", TraditionalForm], 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"[\"", TraditionalForm], 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"Input\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"matrix", 
                    Style[
                    "(\[VeryThinSpace]size: 2\[Times]2\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"varh2", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["", 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["[", 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "Input"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ], 
                    TagBox[
                    TooltipBox[
                    
                    LineBox[{{-1.9999999196153082`, 
                    3.000000053589793}, {-0.9999999464102056, 
                    2.0000000267948965`}}], 
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"matrix\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 2\[Times]3\[VeryThinSpace])\"", 
                    
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"wt1\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"\"", TraditionalForm], 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"[\"", TraditionalForm], 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"wt1\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"matrix", 
                    Style[
                    "(\[VeryThinSpace]size: 2\[Times]3\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"wt1", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["", 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["[", 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "wt1"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ], 
                    TagBox[
                    TooltipBox[
                    
                    LineBox[{{-0.9999999464102056, 2.0000000267948965`}, {
                    5.3589794058235685`*^-8, 1.9999999999999993`}}], 
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"vector\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 3\[VeryThinSpace])\"", 
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"Output\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"]\"", TraditionalForm], 
                    
                    Offset[{7, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"\"", TraditionalForm], 
                    Offset[{0, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"Output\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"vector", 
                    Style["(\[VeryThinSpace]size: 3\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"Output", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["]", 
                    
                    Offset[{7, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["", 
                    Offset[{0, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "Output"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ], 
                    TagBox[
                    TooltipBox[
                    
                    LineBox[{{-1.9999999464102052`, 
                    2.0000000535897935`}, {-0.9999999464102056, 
                    2.0000000267948965`}}], 
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"matrix\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 2\[Times]2\[VeryThinSpace])\"", 
                    
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"Output\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"]\"", TraditionalForm], 
                    
                    Offset[{7, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"[\"", TraditionalForm], 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"invvarh2\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"matrix", 
                    Style[
                    "(\[VeryThinSpace]size: 2\[Times]2\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"Output", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["]", 
                    
                    Offset[{7, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["[", 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "invvarh2"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ]}}, {
                    TagBox[
                    TooltipBox[
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-1.4559016702793783`, 
                    1.0881966401357466`}, {-0.25, 0}, 
                    Offset[8], {1.0000000535897937`, 1.9999999732051024`}], 
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"vector\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 3\[VeryThinSpace])\"", 
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"b1\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"\"", TraditionalForm], 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"[\"", TraditionalForm], 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"b1\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"vector", 
                    Style["(\[VeryThinSpace]size: 3\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"b1", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["", 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["[", 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "b1"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ], 
                    TagBox[
                    TooltipBox[
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-1.449999958467909, 
                    1.5500000388526003`}, {-0.25, 0}, 
                    Offset[8], {1.0000000267948967`, 0.9999999732051028}], 
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"vector\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 2\[VeryThinSpace])\"", 
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"muh2\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"\"", TraditionalForm], 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"[\"", TraditionalForm], 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"muh2\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"vector", 
                    Style["(\[VeryThinSpace]size: 2\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"muh2", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["", 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["[", 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "muh2"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ], 
                    TagBox[
                    TooltipBox[
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-2.4499999464102054`, 
                    2.000000065647497}, {-0.25, 0}, 
                    Offset[8], {1., -2.6794896967885506`*^-8}], 
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"matrix\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 2\[Times]2\[VeryThinSpace])\"", 
                    
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"varh2\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"\"", TraditionalForm], 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"[\"", TraditionalForm], 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"Input\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"matrix", 
                    Style[
                    "(\[VeryThinSpace]size: 2\[Times]2\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"varh2", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["", 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["[", 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "Input"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ], 
                    TagBox[
                    TooltipBox[
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-1.4499999343525016`, 
                    2.4500000388525995`}, {-0.25, 0}, 
                    Offset[8], {0.9999999732051026, -1.0000000267948965`}], 
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"matrix\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 2\[Times]3\[VeryThinSpace])\"", 
                    
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"wt1\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"\"", TraditionalForm], 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"[\"", TraditionalForm], 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"wt1\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"matrix", 
                    Style[
                    "(\[VeryThinSpace]size: 2\[Times]3\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"wt1", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["", 
                    
                    Offset[{0, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["[", 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "wt1"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ], 
                    TagBox[
                    TooltipBox[
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999464102058, 
                    2.000000012057703}, {-0.25, 0}, 
                    Offset[8], {0.9999999999999997, -2.679489718993011*^-8}], 
                    
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"vector\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 3\[VeryThinSpace])\"", 
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"Output\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"]\"", TraditionalForm], 
                    
                    Offset[{7, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"\"", TraditionalForm], 
                    Offset[{0, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"Output\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"vector", 
                    Style["(\[VeryThinSpace]size: 3\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"Output", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["]", 
                    
                    Offset[{7, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["", 
                    Offset[{0, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "Output"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ], 
                    TagBox[
                    TooltipBox[
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-1.4499999464102054`, 
                    2.0000000388526002`}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999996, -2.6794896967885506`*^-8}], 
                    TagBox[
                    GridBox[{{
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"matrix\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 2\[Times]2\[VeryThinSpace])\"", 
                    
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"]}, {
                    StyleBox[
                    TemplateBox[{"\"Output\"", 
                    GraphicsBox[{{}, {
                    GrayLevel[0.7], {
                    
                    LineBox[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {
                    0., 0.}}]}}, {
                    InsetBox[
                    GraphicsBox[
                    StyleBox[
                    
                    PolygonBox[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], {
                    GrayLevel[0.7]}, StripOnInput -> 
                    False]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"]\"", TraditionalForm], 
                    
                    Offset[{7, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    InsetBox[
                    FormBox["\"[\"", TraditionalForm], 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "\"invvarh2\""}, "RowDefault"], 
                    GrayLevel[0.5], StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Center}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Row[{"matrix", 
                    Style[
                    "(\[VeryThinSpace]size: 2\[Times]2\[VeryThinSpace])", 
                    GrayLevel[0.5]]}, " "], 
                    Style[
                    Row[{"Output", 
                    Graphics[{{}, {
                    GrayLevel[0.7], {
                    
                    Line[{{-0.9999999999999997, 2.6794897029117842`*^-8}, {0.,
                     0.}}]}}, {
                    Inset[
                    Graphics[
                    Style[
                    
                    Polygon[{{-1., 0.3333333333333333}, {0., 
                    0.}, {-1., -0.3333333333333333}, {-0.6666666666666666, 
                    0.}, {-1., 0.3333333333333333}}], 
                    GrayLevel[0.7]]], {-0.4499999999999998, 
                    1.2057703663103027`*^-8}, {-0.25, 0}, 
                    Offset[8], {
                    0.9999999999999997, -2.6794897029117842`*^-8}]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {{{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{-0.9999999999999997, 2.6794897029117842`*^-8}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["]", 
                    
                    Offset[{7, 0}, {-0.9999999999999997, 
                    2.6794897029117842`*^-8}]]}}, {{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    Disk[{0., 0.}, 
                    Offset[{2, 2}]]}, {
                    GrayLevel[0.5], 
                    Text["[", 
                    Offset[{-5, 0}, {0., 0.}]]}}}}}, 
                    ImageSize -> {68.99999999999997, 15.000001473719337`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{7., 7.}, {10., 5.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {TooltipBoxOptions -> {
                    TooltipDelay -> 0.08}}], "invvarh2"}], 
                    GrayLevel[0.5]]}, Center], "Tooltip"]& ]}, {
                    EdgeForm[
                    AbsoluteThickness[1]], FontSize -> 10, {
                    TagBox[
                    TagBox[
                    TooltipBox[{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-1.9999999999999993`, 5.3589794058235685`*^-8}, 
                    Offset[{2, 2}]]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"b1\"", Bold, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Style["b1", Bold]}], "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 1), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{
                    FaceForm[
                    RGBColor[0.9, 0.9, 0.9]], 
                    EdgeForm[
                    GrayLevel[0.85]], {
                    FaceForm[
                    RGBColor[0.5856, 0.5856, 0.5856]], 
                    EdgeForm[
                    RGBColor[0.5856, 0.5856, 0.5856]], 
                    DiskBox[{-0.9999999464102056, 2.0000000267948965`}, 
                    Offset[13.88888888888889]]}, {
                    DiskBox[{-0.9999999464102056, 2.0000000267948965`}, 
                    Offset[11.666666666666668`]]}, 
                    InsetBox[
                    GraphicsBox[{
                    Thickness[0.0149], {
                    GrayLevel[0.5], 
                    Thickness[0.03], 
                    Opacity[1.], 
                    JoinForm[{
                    Style["Miter", 
                    GrayLevel[0.33]], 10.}], 
                    
                    JoinedCurveBox[{{{1, 4, 3}}}, {{{39.192120463394616`, 
                    30.51535353195944}, {39.192120463394616`, 
                    30.51535353195944}, {38.69442248591872, 
                    35.17935629818005}, {28.246036107633145`, 
                    35.21413676830481}}}, CurveClosed -> {0}], 
                    
                    JoinedCurveBox[{{{1, 4, 3}}}, {{{39.335627149246974`, 
                    22.022653388846493`}, {39.335627149246974`, 
                    22.022653388846493`}, {39.028664759644585`, 
                    18.313538367818456`}, {28.898905902765012`, 
                    18.118321787764348`}}}, CurveClosed -> {0}]}, 
                    GeometricTransformationBox[
                    GraphicsGroupBox[{
                    Thickness[0.0149], 
                    GraphicsGroupBox[{{
                    FaceForm[
                    RGBColor[0.732, 0.732, 0.732]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    15.5, 40.5}, {22.5, 40.5}, {22.5, 33.5}, {15.5, 
                    33.5}}}]}, {
                    FaceForm[
                    GrayLevel[0.33]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2,
                     0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 41.}, {15., 41.}, {
                    15., 33.}, {23., 33.}}, {{22., 34.}, {16., 34.}, {16., 
                    40.}, {22., 40.}}}]}}]}], {{{{1.6209767772132715`, 0.}, {
                    0., 1.302327038770047}}, {-8.296516058106576, \
-14.790162389666165`}}}], 
                    GeometricTransformationBox[
                    GraphicsGroupBox[{
                    Thickness[0.0149], 
                    GraphicsGroupBox[{{
                    FaceForm[
                    RGBColor[0.732, 0.732, 0.732]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    15.5, 19.5}, {22.5, 19.5}, {22.5, 12.5}, {15.5, 
                    12.5}}}]}, {
                    FaceForm[
                    GrayLevel[0.33]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2,
                     0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 20.}, {15., 20.}, {
                    15., 12.}, {23., 12.}}, {{22., 13.}, {16., 13.}, {16., 
                    19.}, {22., 19.}}}]}}]}], {{{{1.6446663930506598`, 0.}, {
                    0., 1.2828873028183188`}}, {-8.702521921403617, \
-2.012105908138385}}}], 
                    GeometricTransformationBox[
                    GraphicsGroupBox[{
                    Thickness[0.0149], 
                    GraphicsGroupBox[{{
                    FaceForm[
                    RGBColor[0.732, 0.732, 0.732]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    30.5, 30.5}, {37.5, 30.5}, {37.5, 23.5}, {30.5, 
                    23.5}}}]}, {
                    FaceForm[
                    GrayLevel[0.33]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2,
                     0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 31.}, {30., 31.}, {
                    30., 23.}, {38., 23.}}, {{37., 24.}, {31., 24.}, {31., 
                    30.}, {37., 30.}}}]}}]}], {{{{1.5182866155506958`, 0.}, {
                    0., 1.2065857650683098`}}, {-11.402865979580374`, \
-6.527851836053724}}}]}, PlotRange -> All, AspectRatio -> 1, PlotRangePadding -> 
                    0, ImagePadding -> 0, ImageSize -> 15, ImageMargins -> 
                    0.], {-0.9999999464102056, 2.0000000267948965`}]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"fn\"", Bold, StripOnInput -> False]}, {
                    StyleBox[
                    "FunctionLayer", FontFamily -> "Source Code Pro", 
                    ShowStringCharacters -> True, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Style["fn", Bold], 
                    Style[
                    FunctionLayer, FontFamily -> "Source Code Pro", 
                    ShowStringCharacters -> True]}], "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 2), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-1.9999999732051024`, 1.0000000535897937`}, 
                    Offset[{2, 2}]]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"muh2\"", Bold, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Style["muh2", Bold]}], "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 3), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-2.999999946410205, 2.0000000803846905`}, 
                    Offset[{2, 2}]]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"varh2\"", Bold, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Style["varh2", Bold]}], "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 4), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{
                    FaceForm[
                    RGBColor[
                    0.7999999999999999, 0.7999999999999999, 
                    0.7999999999999999]], 
                    EdgeForm[
                    GrayLevel[0.7]], {
                    FaceForm[
                    RGBColor[0.5664, 0.5664, 0.5664]], 
                    EdgeForm[
                    RGBColor[0.5664, 0.5664, 0.5664]], 
                    RectangleBox[
                    NCache[
                    Offset[{
                    Rational[-25, 2], 
                    Rational[-25, 2]}, {-1.9999999464102052`, 
                    2.0000000535897935`}], 
                    
                    Offset[{-12.5, -12.5}, {-1.9999999464102052`, 
                    2.0000000535897935`}]], 
                    NCache[
                    Offset[{
                    Rational[25, 2], 
                    Rational[25, 2]}, {-1.9999999464102052`, 
                    2.0000000535897935`}], 
                    
                    Offset[{12.5, 12.5}, {-1.9999999464102052`, 
                    2.0000000535897935`}]]]}, {
                    RectangleBox[
                    NCache[
                    Offset[{
                    Rational[-21, 2], 
                    Rational[-21, 2]}, {-1.9999999464102052`, 
                    2.0000000535897935`}], 
                    
                    Offset[{-10.5, -10.5}, {-1.9999999464102052`, 
                    2.0000000535897935`}]], 
                    NCache[
                    Offset[{
                    Rational[21, 2], 
                    Rational[21, 2]}, {-1.9999999464102052`, 
                    2.0000000535897935`}], 
                    
                    Offset[{10.5, 10.5}, {-1.9999999464102052`, 
                    2.0000000535897935`}]]]}, 
                    InsetBox[
                    GraphicsBox[{
                    Thickness[0.0149], {
                    GrayLevel[0.5], 
                    Thickness[0.03], 
                    Opacity[1.], 
                    JoinForm[{"Miter", 10.}], 
                    
                    JoinedCurveBox[{{{1, 4, 3}}}, {{{39.192120463394616`, 
                    30.51535353195944}, {39.192120463394616`, 
                    30.51535353195944}, {38.69442248591872, 
                    35.17935629818005}, {28.246036107633145`, 
                    35.21413676830481}}}, CurveClosed -> {0}], 
                    
                    JoinedCurveBox[{{{1, 4, 3}}}, {{{39.335627149246974`, 
                    22.022653388846493`}, {39.335627149246974`, 
                    22.022653388846493`}, {39.028664759644585`, 
                    18.313538367818456`}, {28.898905902765012`, 
                    18.118321787764348`}}}, CurveClosed -> {0}]}, 
                    GeometricTransformationBox[
                    GraphicsGroupBox[{
                    Thickness[0.0149], 
                    GraphicsGroupBox[{{
                    FaceForm[
                    RGBColor[0.631, 0.8160000000000001, 0.498]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    15.5, 40.5}, {22.5, 40.5}, {22.5, 33.5}, {15.5, 
                    33.5}}}]}, {
                    FaceForm[
                    RGBColor[0.40800000000000003`, 0.627, 0.196]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2,
                     0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 41.}, {15., 41.}, {
                    15., 33.}, {23., 33.}}, {{22., 34.}, {16., 34.}, {16., 
                    40.}, {22., 40.}}}]}}]}], {{{{1.6209767772132715`, 0.}, {
                    0., 1.302327038770047}}, {-8.296516058106576, \
-14.790162389666165`}}}], 
                    GeometricTransformationBox[
                    GraphicsGroupBox[{
                    Thickness[0.0149], 
                    GraphicsGroupBox[{{
                    FaceForm[
                    RGBColor[0.38, 0.753, 0.89]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    15.5, 19.5}, {22.5, 19.5}, {22.5, 12.5}, {15.5, 
                    12.5}}}]}, {
                    FaceForm[
                    RGBColor[0.24300000000000002`, 0.608, 0.71]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2,
                     0}, {0, 1, 0}, {0, 1, 0}}}, {{{23., 20.}, {15., 20.}, {
                    15., 12.}, {23., 12.}}, {{22., 13.}, {16., 13.}, {16., 
                    19.}, {22., 19.}}}]}}]}], {{{{1.6446663930506598`, 0.}, {
                    0., 1.2828873028183188`}}, {-8.702521921403617, \
-2.012105908138385}}}], 
                    GeometricTransformationBox[
                    GraphicsGroupBox[{
                    Thickness[0.0149], 
                    GraphicsGroupBox[{{
                    FaceForm[
                    RGBColor[0.584, 0.51, 0.8390000000000001]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}}, {{{
                    30.5, 30.5}, {37.5, 30.5}, {37.5, 23.5}, {30.5, 
                    23.5}}}]}, {
                    FaceForm[
                    RGBColor[0.4, 0.396, 0.659]], 
                    
                    FilledCurveBox[{{{0, 2, 0}, {0, 1, 0}, {0, 1, 0}}, {{0, 2,
                     0}, {0, 1, 0}, {0, 1, 0}}}, {{{38., 31.}, {30., 31.}, {
                    30., 23.}, {38., 23.}}, {{37., 24.}, {31., 24.}, {31., 
                    30.}, {37., 30.}}}]}}]}], {{{{1.5182866155506958`, 0.}, {
                    0., 1.2065857650683098`}}, {-11.402865979580374`, \
-6.527851836053724}}}]}, PlotRange -> All, AspectRatio -> 1, PlotRangePadding -> 
                    0, ImagePadding -> 0, ImageSize -> 15, ImageMargins -> 
                    0.], {-1.9999999464102052`, 2.0000000535897935`}]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"invvarh2\"", Bold, StripOnInput -> False]}, {
                    StyleBox[
                    "NetGraph", FontFamily -> "Source Code Pro", 
                    ShowStringCharacters -> True, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Style["invvarh2", Bold], 
                    Style[
                    NetGraph, FontFamily -> "Source Code Pro", 
                    ShowStringCharacters -> True]}], "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 5), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{-1.9999999196153082`, 3.000000053589793}, 
                    Offset[{2, 2}]]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"wt1\"", Bold, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Style["wt1", Bold]}], "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 6), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]], 
                    TagBox[
                    TagBox[
                    TooltipBox[{
                    GrayLevel[0.85], 
                    EdgeForm[
                    GrayLevel[0.5]], 
                    DiskBox[{5.3589794058235685`*^-8, 1.9999999999999993`}, 
                    Offset[{2, 2}]]}, 
                    TagBox[
                    GridBox[{{
                    StyleBox["\"Output\"", Bold, StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                    "Column"], 
                    TooltipStyle -> {
                    Background -> GrayLevel[0.937255], CellFrame -> 1, 
                    CellFrameColor -> GrayLevel[0.85]}], Annotation[#, 
                    Column[{
                    Style["Output", Bold]}], "Tooltip"]& ], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = 7), 
                    PassEventsUp -> False, Method -> "Preemptive", 
                    PassEventsDown -> Automatic}]]}}, {
                    FaceForm[None], 
                    EdgeForm[{
                    Dashing[{0, Small}], 
                    GrayLevel[0.5], 
                    Thickness[Large]}], 
                    PolygonBox[
                    Dynamic[
                    If[
                    Not[
                    IntegerQ[NeuralNetworks`Private`NetGraph`selection]], {}, 
                    
                    GeneralUtilities`Graphics`PackagePrivate`makeOffsetSquare[
                    
                    
                    Part[{{-1.9999999999999993`, 
                    5.3589794058235685`*^-8}, {-0.9999999464102056, 
                    2.0000000267948965`}, {-1.9999999732051024`, 
                    1.0000000535897937`}, {-2.999999946410205, 
                    2.0000000803846905`}, {-1.9999999464102052`, 
                    2.0000000535897935`}, {-1.9999999196153082`, 
                    3.000000053589793}, {5.3589794058235685`*^-8, 
                    1.9999999999999993`}}, 
                    NeuralNetworks`Private`NetGraph`selection], 
                    3 + {0.5, 0.5} 
                    Part[{8, 25, 8, 8, 25, 8, 8}, 
                    NeuralNetworks`Private`NetGraph`selection], {-0.5, 
                    0.5}]]]]}}, 
                    ImageSize -> {222.99999999999994`, 212.99999999999994`}, 
                    AspectRatio -> Full, PlotRangePadding -> 0, 
                    ImagePadding -> {{29., 29.}, {29., 19.}}, 
                    ImageMargins -> {{0, 0}, {0, 0}}, 
                    BaseStyle -> {
                    TooltipBoxOptions -> {TooltipDelay -> 0.08}}], 
                    
                    EventHandlerTag[{
                    "MouseClicked" :> (
                    NeuralNetworks`Private`NetGraph`selection = None), Method -> 
                    "Preemptive", PassEventsDown -> Automatic, PassEventsUp -> 
                    True}]]}, {
                    GridBox[{{
                    ItemBox[
                    StyleBox["Input Ports", Bold], 
                    Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                    GrayLevel[0.85]], 
                    ItemBox[
                    StyleBox[
                    
                    GraphicsBox[{}, ImageSize -> {1, 11}, 
                    BaselinePosition -> (Scaled[0.] -> Baseline)], 
                    "CacheGraphics" -> False], 
                    Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                    GrayLevel[0.85]]}, {
                    StyleBox[
                    TemplateBox[{"\"varh2\"", "\":\""}, "RowDefault"], 
                    "SummaryItemAnnotation"], 
                    StyleBox[
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"matrix\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 2\[Times]2\[VeryThinSpace])\"", 
                    
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"], "SummaryItem"]}, {
                    StyleBox[
                    TemplateBox[{"\"wt1\"", "\":\""}, "RowDefault"], 
                    "SummaryItemAnnotation"], 
                    StyleBox[
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"matrix\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 2\[Times]3\[VeryThinSpace])\"", 
                    
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"], "SummaryItem"]}, {
                    StyleBox[
                    TemplateBox[{"\"muh2\"", "\":\""}, "RowDefault"], 
                    "SummaryItemAnnotation"], 
                    StyleBox[
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"vector\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 2\[VeryThinSpace])\"", 
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"], "SummaryItem"]}, {
                    StyleBox[
                    TemplateBox[{"\"b1\"", "\":\""}, "RowDefault"], 
                    "SummaryItemAnnotation"], 
                    StyleBox[
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"vector\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 3\[VeryThinSpace])\"", 
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"], "SummaryItem"]}, {
                    ItemBox[
                    StyleBox["Output Port", Bold], 
                    Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                    GrayLevel[0.85]], 
                    ItemBox[
                    StyleBox[
                    
                    GraphicsBox[{}, ImageSize -> {1, 11}, 
                    BaselinePosition -> (Scaled[0.] -> Baseline)], 
                    "CacheGraphics" -> False], 
                    Frame -> {{False, False}, {False, True}}, FrameStyle -> 
                    GrayLevel[0.85]]}, {
                    StyleBox[
                    TemplateBox[{"\"Output\"", "\":\""}, "RowDefault"], 
                    "SummaryItemAnnotation"], 
                    StyleBox[
                    TemplateBox[{"\[ThinSpace]", "\" \"", "\"vector\"", 
                    StyleBox[
                    "\"(\[VeryThinSpace]size: 3\[VeryThinSpace])\"", 
                    GrayLevel[0.5], StripOnInput -> False]}, 
                    "RowWithSeparators"], "SummaryItem"]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}]}, {
                    DynamicBox[
                    If[
                    IntegerQ[NeuralNetworks`Private`NetGraph`selection], 
                    NeuralNetworks`FormatSelectedParameterGraph[
                    Part[
                    Association[
                    "Nodes" -> 
                    Association[
                    "invvarh2" -> 
                    Association[
                    "Type" -> "Graph", "Inputs" -> 
                    Association[
                    "Input" -> NeuralNetworks`TensorT[{2, 2}, 
                    NeuralNetworks`AtomT]], "Outputs" -> 
                    Association[
                    "Output" -> NeuralNetworks`TensorT[{2, 2}, 
                    NeuralNetworks`AtomT]], "Nodes" -> 
                    Association[
                    "nil" -> Association[
                    "Type" -> "NetArray", "Arrays" -> 
                    Association["Array" -> 
                    NeuralNetworks`Private`DummyArray[{1}]], "Parameters" -> 
                    Association["Dimensions" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`AtomT], 
                    "$ArrayDimensions" -> {1}], "Inputs" -> Association[], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{1}, 
                    NeuralNetworks`AtomT]], "TrainingParameters" -> 
                    Association["LearningRateMultipliers" -> 0]], "part1" -> 
                    Association["Type" -> "Part", "Arrays" -> Association[], 
                    "Parameters" -> Association[
                    "Specification" -> NeuralNetworks`ValidatedParameter[{1, 
                    1}]], "Inputs" -> 
                    Association["Input" -> 
                    NeuralNetworks`TensorT[{2, 2}, NeuralNetworks`AtomT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{}, 
                    NeuralNetworks`AtomT]]], "part2" -> 
                    Association["Type" -> "Part", "Arrays" -> Association[], 
                    "Parameters" -> Association[
                    "Specification" -> NeuralNetworks`ValidatedParameter[{2, 
                    2}]], "Inputs" -> 
                    Association["Input" -> 
                    NeuralNetworks`TensorT[{2, 2}, NeuralNetworks`AtomT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{}, 
                    NeuralNetworks`AtomT]]], "inv1" -> 
                    Association["Type" -> "Elementwise", "Arrays" -> 
                    Association[], "Parameters" -> 
                    Association["Function" -> 
                    NeuralNetworks`ValidatedParameter[Divide[1, #]& ], 
                    "$Dimensions" -> {}], "Inputs" -> 
                    Association["Input" -> 
                    NeuralNetworks`TensorT[{}, NeuralNetworks`AtomT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{}, 
                    NeuralNetworks`AtomT]]], "inv2" -> 
                    Association["Type" -> "Elementwise", "Arrays" -> 
                    Association[], "Parameters" -> 
                    Association["Function" -> 
                    NeuralNetworks`ValidatedParameter[Divide[1, #]& ], 
                    "$Dimensions" -> {}], "Inputs" -> 
                    Association["Input" -> 
                    NeuralNetworks`TensorT[{}, NeuralNetworks`AtomT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{}, 
                    NeuralNetworks`AtomT]]], "reshape1" -> 
                    Association["Type" -> "Reshape", "Arrays" -> 
                    Association[], "Parameters" -> 
                    Association["Dimensions" -> 
                    NeuralNetworks`ValidatedParameter[{1}]], "Inputs" -> 
                    Association["Input" -> 
                    NeuralNetworks`TensorT[{}, NeuralNetworks`AtomT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{1}, 
                    NeuralNetworks`AtomT]]], "reshape2" -> 
                    Association["Type" -> "Reshape", "Arrays" -> 
                    Association[], "Parameters" -> 
                    Association["Dimensions" -> 
                    NeuralNetworks`ValidatedParameter[{1}]], "Inputs" -> 
                    Association["Input" -> 
                    NeuralNetworks`TensorT[{}, NeuralNetworks`AtomT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{1}, 
                    NeuralNetworks`AtomT]]], "catenate" -> 
                    Association["Type" -> "Catenate", "Arrays" -> 
                    Association[], "Parameters" -> Association["Level" -> 1], 
                    "Inputs" -> Association[
                    "Input1" -> NeuralNetworks`TensorT[{1}, 
                    NeuralNetworks`AtomT], "Input2" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`AtomT], 
                    "Input3" -> NeuralNetworks`TensorT[{1}, 
                    NeuralNetworks`AtomT], "Input4" -> 
                    NeuralNetworks`TensorT[{1}, NeuralNetworks`AtomT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{4}, 
                    NeuralNetworks`AtomT]]], "reshape" -> 
                    Association["Type" -> "Reshape", "Arrays" -> 
                    Association[], "Parameters" -> 
                    Association["Dimensions" -> 
                    NeuralNetworks`ValidatedParameter[{2, 2}]], "Inputs" -> 
                    Association["Input" -> 
                    NeuralNetworks`TensorT[{4}, NeuralNetworks`AtomT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{2, 2}, 
                    NeuralNetworks`AtomT]]]], 
                    "Edges" -> {
                    NeuralNetworks`NetPath[
                    "Nodes", "part1", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Inputs", "Input"], 
                    NeuralNetworks`NetPath[
                    "Nodes", "part2", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Inputs", "Input"], 
                    NeuralNetworks`NetPath[
                    "Nodes", "catenate", "Inputs", "Input2"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "nil", "Outputs", "Output"], 
                    NeuralNetworks`NetPath[
                    "Nodes", "catenate", "Inputs", "Input3"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "nil", "Outputs", "Output"], 
                    NeuralNetworks`NetPath[
                    "Nodes", "inv1", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "part1", "Outputs", "Output"], 
                    NeuralNetworks`NetPath[
                    "Nodes", "inv2", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "part2", "Outputs", "Output"], 
                    NeuralNetworks`NetPath[
                    "Nodes", "reshape1", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "inv1", "Outputs", "Output"], 
                    NeuralNetworks`NetPath[
                    "Nodes", "reshape2", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "inv2", "Outputs", "Output"], 
                    NeuralNetworks`NetPath[
                    "Nodes", "catenate", "Inputs", "Input1"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "reshape1", "Outputs", "Output"], 
                    NeuralNetworks`NetPath[
                    "Nodes", "catenate", "Inputs", "Input4"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "reshape2", "Outputs", "Output"], 
                    NeuralNetworks`NetPath[
                    "Nodes", "reshape", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "catenate", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Outputs", "Output"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "reshape", "Outputs", "Output"]}], "fn" -> 
                    Association[
                    "Type" -> "Function", "Arrays" -> Association[], 
                    "Parameters" -> 
                    Association["Function" -> (Slot["b1"] - Dot[
                    Transpose[
                    Slot["wt1"]], 
                    Sqrt[
                    Slot["invvarh2"]], 
                    Slot["muh2"]]& ), "Net" -> 
                    Association["Type" -> "Graph", "Inputs" -> 
                    Association["wt1" -> 
                    NeuralNetworks`TensorT[{2, 3}, NeuralNetworks`AtomT], 
                    "invvarh2" -> NeuralNetworks`TensorT[{2, 2}, 
                    NeuralNetworks`AtomT], "muh2" -> 
                    NeuralNetworks`TensorT[{2}, NeuralNetworks`AtomT], "b1" -> 
                    NeuralNetworks`TensorT[{3}, NeuralNetworks`AtomT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{3}, 
                    NeuralNetworks`RealT]], "Nodes" -> 
                    Association["1" -> Association[
                    "Type" -> "Transpose", "Arrays" -> Association[], 
                    "Parameters" -> Association[
                    "Specification" -> NeuralNetworks`ValidatedParameter[
                    TwoWayRule[1, 2]]], "Inputs" -> 
                    Association["Input" -> NeuralNetworks`TensorT[{2, 3}, 
                    NeuralNetworks`AtomT]], "Outputs" -> 
                    Association["Output" -> 
                    NeuralNetworks`TensorT[{3, 2}, NeuralNetworks`AtomT]]], 
                    "2" -> Association[
                    "Type" -> "Elementwise", "Arrays" -> Association[], 
                    "Parameters" -> Association[
                    "Function" -> NeuralNetworks`ValidatedParameter[Sqrt], 
                    "$Dimensions" -> {2, 2}], "Inputs" -> 
                    Association["Input" -> NeuralNetworks`TensorT[{2, 2}, 
                    NeuralNetworks`AtomT]], "Outputs" -> 
                    Association["Output" -> 
                    NeuralNetworks`TensorT[{2, 2}, NeuralNetworks`AtomT]]], 
                    "3" -> Association[
                    "Type" -> "Dot", "Arrays" -> Association[], "Parameters" -> 
                    Association["TransposeSpecifications" -> 
                    NeuralNetworks`ValidatedParameter[None]], "Inputs" -> 
                    Association["Input1" -> 
                    NeuralNetworks`TensorT[{3, 2}, NeuralNetworks`AtomT], 
                    "Input2" -> NeuralNetworks`TensorT[{2, 2}, 
                    NeuralNetworks`AtomT], "Input3" -> 
                    NeuralNetworks`TensorT[{2}, NeuralNetworks`AtomT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{3}, 
                    NeuralNetworks`RealT]]], "4" -> 
                    Association["Type" -> "Threading", "Arrays" -> 
                    Association[], "Parameters" -> 
                    Association["Function" -> 
                    NeuralNetworks`ValidatedParameter[Subtract[#, #2]& ], 
                    "Broadcasting" -> NeuralNetworks`ValidatedParameter[-1]], 
                    "Inputs" -> Association[
                    "Input1" -> NeuralNetworks`TensorT[{3}, 
                    NeuralNetworks`AtomT], "Input2" -> 
                    NeuralNetworks`TensorT[{3}, NeuralNetworks`RealT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{3}, 
                    NeuralNetworks`RealT]]]], 
                    "Edges" -> {NeuralNetworks`NetPath[
                    "Nodes", "1", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Inputs", "wt1"], 
                    NeuralNetworks`NetPath["Nodes", "2", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Inputs", "invvarh2"], 
                    NeuralNetworks`NetPath["Nodes", "3", "Inputs", "Input3"] -> 
                    NeuralNetworks`NetPath["Inputs", "muh2"], 
                    NeuralNetworks`NetPath["Nodes", "4", "Inputs", "Input1"] -> 
                    NeuralNetworks`NetPath["Inputs", "b1"], 
                    NeuralNetworks`NetPath["Nodes", "3", "Inputs", "Input1"] -> 
                    NeuralNetworks`NetPath["Nodes", "1", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "3", "Inputs", "Input2"] -> 
                    NeuralNetworks`NetPath["Nodes", "2", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Nodes", "4", "Inputs", "Input2"] -> 
                    NeuralNetworks`NetPath["Nodes", "3", "Outputs", "Output"],
                     NeuralNetworks`NetPath["Outputs", "Output"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "4", "Outputs", "Output"]}], 
                    "$InputNames" -> {"wt1", "invvarh2", "muh2", "b1"}, 
                    "$OutputNames" -> {"Output"}], "Inputs" -> 
                    Association[
                    "wt1" -> NeuralNetworks`TensorT[{2, 3}, 
                    NeuralNetworks`AtomT], "invvarh2" -> 
                    NeuralNetworks`TensorT[{2, 2}, NeuralNetworks`AtomT], 
                    "muh2" -> NeuralNetworks`TensorT[{2}, 
                    NeuralNetworks`AtomT], "b1" -> 
                    NeuralNetworks`TensorT[{3}, NeuralNetworks`AtomT]], 
                    "Outputs" -> Association[
                    "Output" -> NeuralNetworks`TensorT[{3}, 
                    NeuralNetworks`RealT]]]], "Inputs" -> 
                    Association[
                    "varh2" -> NeuralNetworks`TensorT[{2, 2}, 
                    NeuralNetworks`AtomT], "wt1" -> 
                    NeuralNetworks`TensorT[{2, 3}, NeuralNetworks`AtomT], 
                    "muh2" -> NeuralNetworks`TensorT[{2}, 
                    NeuralNetworks`AtomT], "b1" -> 
                    NeuralNetworks`TensorT[{3}, NeuralNetworks`AtomT]], 
                    "Outputs" -> 
                    Association[
                    "Output" -> 
                    NeuralNetworks`TensorT[{3}, NeuralNetworks`RealT]], 
                    "Edges" -> {
                    NeuralNetworks`NetPath[
                    "Nodes", "invvarh2", "Inputs", "Input"] -> 
                    NeuralNetworks`NetPath["Inputs", "varh2"], 
                    NeuralNetworks`NetPath["Nodes", "fn", "Inputs", "b1"] -> 
                    NeuralNetworks`NetPath["Inputs", "b1"], 
                    NeuralNetworks`NetPath["Nodes", "fn", "Inputs", "muh2"] -> 
                    NeuralNetworks`NetPath["Inputs", "muh2"], 
                    NeuralNetworks`NetPath["Nodes", "fn", "Inputs", "wt1"] -> 
                    NeuralNetworks`NetPath["Inputs", "wt1"], 
                    NeuralNetworks`NetPath[
                    "Nodes", "fn", "Inputs", "invvarh2"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "invvarh2", "Outputs", "Output"], 
                    NeuralNetworks`NetPath["Outputs", "Output"] -> 
                    NeuralNetworks`NetPath[
                    "Nodes", "fn", "Outputs", "Output"]}], 
                    Apply[Sequence, 
                    Part[{
                    NeuralNetworks`NetPath["Inputs", "b1"], 
                    NeuralNetworks`NetPath["Nodes", "fn"], 
                    NeuralNetworks`NetPath["Inputs", "muh2"], 
                    NeuralNetworks`NetPath["Inputs", "varh2"], 
                    NeuralNetworks`NetPath["Nodes", "invvarh2"], 
                    NeuralNetworks`NetPath["Inputs", "wt1"], 
                    NeuralNetworks`NetPath["Outputs", "Output"]}, 
                    NeuralNetworks`Private`NetGraph`selection]]], 
                    Part[{
                    NeuralNetworks`NetPath["Inputs", "b1"], 
                    NeuralNetworks`NetPath["Nodes", "fn"], 
                    NeuralNetworks`NetPath["Inputs", "muh2"], 
                    NeuralNetworks`NetPath["Inputs", "varh2"], 
                    NeuralNetworks`NetPath["Nodes", "invvarh2"], 
                    NeuralNetworks`NetPath["Inputs", "wt1"], 
                    NeuralNetworks`NetPath["Outputs", "Output"]}, 
                    NeuralNetworks`Private`NetGraph`selection], 
                    Association[], {}], 
                    ToBoxes[""]], 
                    TrackedSymbols :> {
                    NeuralNetworks`Private`NetGraph`selection}]}}, 
                   GridBoxAlignment -> {"Columns" -> {{Left}}}], 
                  Initialization :> {NetGraph}]}}, BaselinePosition -> 
               Automatic, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, 
               GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            GridFrameMargins -> {{0, 0}, {0, 0}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open], ImageSize -> Automatic], BaselinePosition -> 
        Baseline, 
        BaseStyle -> {
         ShowStringCharacters -> False, NumberMarks -> False, PrintPrecision -> 
          3, ShowSyntaxStyles -> False}]], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("NetGraph[<>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.827354553735189*^9, 3.827354582620412*^9}, 
   3.827354615835125*^9, 3.827354870357381*^9, 3.827355848500135*^9, 
   3.8273647382224073`*^9},
 CellLabel->
  "Out[1214]=",ExpressionUUID->"3cf9d63f-2166-4a5f-8c85-0e197cf83757"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "21.279199600219727`"}], ",", 
   RowBox[{"-", "24.439613342285156`"}], ",", 
   RowBox[{"-", "27.600027084350586`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.827354553735189*^9, 3.827354582620412*^9}, 
   3.827354615835125*^9, 3.827354870357381*^9, 3.827355848500135*^9, 
   3.82736473824461*^9},
 CellLabel->
  "Out[1215]=",ExpressionUUID->"85b653b9-e8ac-42b5-988c-3ec99800cdbf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "b1Test", ",", "wt1Test", ",", "varh2Test", ",", "muh2Test", ",", "b2True", 
   ",", "layer", ",", "b2Actual"}], "]"}]], "Input",
 CellChangeTimes->{{3.827364735167926*^9, 3.827364752701003*^9}},
 CellLabel->
  "In[1216]:=",ExpressionUUID->"3d892237-7c21-4df4-91eb-7bc27585da6e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convert wt from 0", "Chapter",
 CellChangeTimes->{{3.8273544913388777`*^9, 
  3.827354494900173*^9}},ExpressionUUID->"df4c7c01-95d5-4b10-887c-\
77d05d6958a8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convertwtLayerFrom0", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<fn\>\"", "->", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Sqrt", "[", "#invvarh2", "]"}], ".", "#wt1"}], "&"}], 
           ",", 
           RowBox[{"\"\<wt1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<invvarh2\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<invvarh2\>\"", "->", 
         RowBox[{"inverseDiagMatLayer", "[", "nh", "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"NetPort", "[", "\"\<varh2\>\"", "]"}], "->", 
        RowBox[{"\"\<invvarh2\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<fn\>\"", ",", "\"\<invvarh2\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825704293704557*^9, 3.825704362162993*^9}, {
  3.825704399722686*^9, 3.825704444589329*^9}, {3.8257045094889183`*^9, 
  3.8257045124095488`*^9}, {3.825704716376679*^9, 3.825704748168625*^9}, {
  3.825704936451956*^9, 3.82570493792344*^9}, {3.8257055166711273`*^9, 
  3.825705524087533*^9}, {3.825705573437446*^9, 3.825705575036976*^9}, {
  3.82699269909198*^9, 3.826992741065934*^9}, {3.827001550232519*^9, 
  3.827001563028215*^9}, {3.827355853976396*^9, 3.827355861566101*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"e9f4b641-fa44-417b-88fa-68419485a24f"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8273558666954603`*^9, 
  3.82735586699196*^9}},ExpressionUUID->"a16f9d93-1fcd-4c1a-8563-\
349ebb22c737"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"wt1Test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "7", ",", "8"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh2Test", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "8"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"wt2True", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", 
     RowBox[{"Sqrt", "[", "varh2Test", "]"}], "]"}], ".", "wt1Test"}], "//", 
   "N"}]}], "\[IndentingNewLine]", 
 RowBox[{"wt2Actual", "=", 
  RowBox[{
   RowBox[{"convertwtLayerFrom0", "[", 
    RowBox[{"3", ",", "2"}], "]"}], "[", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<wt1\>\"", "\[Rule]", "wt1Test"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<varh2\>\"", "\[Rule]", "varh2Test"}]}], 
    "\[IndentingNewLine]", "|>"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.825704869600503*^9, 3.8257049110809526`*^9}, {
  3.825704944698711*^9, 3.8257049455081778`*^9}, {3.8257055593606453`*^9, 
  3.8257055872130632`*^9}, {3.8269927638951797`*^9, 3.8269927725783167`*^9}},
 CellLabel->
  "In[1217]:=",ExpressionUUID->"7939a27f-2799-4215-9720-b1dd12e1897a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.3416407864998738`", ",", "1.7888543819998317`", ",", 
     "2.23606797749979`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.1213203435596424`", ",", "2.474873734152916`", ",", 
     "2.8284271247461903`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.825704911323472*^9, 3.8257049457571907`*^9, {3.825705582643235*^9, 
   3.825705592901224*^9}, 3.8269927727951937`*^9, 3.8270015886038637`*^9, 
   3.827355886072138*^9, 3.827364755262664*^9},
 CellLabel->
  "Out[1219]=",ExpressionUUID->"b6c24455-01b3-431f-8592-33cf19521e27"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.3416407108306885`", ",", "1.7888543605804443`", ",", 
     "2.2360680103302`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2.1213202476501465`", ",", "2.4748737812042236`", ",", 
     "2.8284270763397217`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.825704911323472*^9, 3.8257049457571907`*^9, {3.825705582643235*^9, 
   3.825705592901224*^9}, 3.8269927727951937`*^9, 3.8270015886038637`*^9, 
   3.827355886072138*^9, 3.8273647553448133`*^9},
 CellLabel->
  "Out[1220]=",ExpressionUUID->"27aec40d-d06e-46af-9384-0a9725da63e8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"wt1Test", ",", "varh2Test", ",", "wt2True", ",", "wt2Actual"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.827364755846736*^9, 3.827364762417164*^9}},
 CellLabel->
  "In[1221]:=",ExpressionUUID->"27e9fb05-8b07-49ad-a5c5-3b5942fb8585"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Make convert params0 to params layer", "Title",
 CellChangeTimes->{{3.825705096992691*^9, 3.8257051019214363`*^9}, {
  3.825705976511894*^9, 
  3.825705980919406*^9}},ExpressionUUID->"fedfaf62-4769-4c23-b2f3-\
e4387ee5439f"],

Cell[CellGroupData[{

Cell["Fourier graph for muh", "Chapter",
 CellChangeTimes->{{3.8273529949694138`*^9, 
  3.827353003212854*^9}},ExpressionUUID->"26c7ba03-7fb0-4a3d-9df6-\
2ddf25d21e6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeFourierGraphMuh", "[", 
   RowBox[{
   "nh_", ",", "freqs_", ",", "sinCoeffsInit_", ",", "cosCoeffsInit_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "\"\<catenate\>\"", "]"}], "=", 
      RowBox[{"CatenateLayer", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"layerDefns", "[", 
          RowBox[{"\"\<muh\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "=", 
         RowBox[{"makeFourierGraph", "[", 
          RowBox[{"freqs", ",", "sinCoeffsInit", ",", "cosCoeffsInit", ",", 
           RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", 
          RowBox[{"\"\<muh\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<Reshape\>\""}], 
          "]"}], "=", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", "1", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nh"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerConn", ",", 
          RowBox[{
           RowBox[{"\"\<muh\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}], "\[Rule]", 
           RowBox[{
            RowBox[{"\"\<muh\>\"", "<>", 
             RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<Reshape\>\""}], 
            "->", "\"\<catenate\>\""}]}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nh"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826999806528623*^9, 3.826999935354321*^9}, {
  3.826999973715262*^9, 3.827000037861391*^9}, {3.827000102951592*^9, 
  3.827000125800488*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"aede53a6-cf60-4b68-9224-5c28fdb279e2"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.827353005769866*^9, 
  3.8273530071776114`*^9}},ExpressionUUID->"6c6ad3af-2ff2-4b39-a48c-\
a369b67bd502"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"freqsTest", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sinCoeffsInitTest", "=", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "2.0", ",", "3.0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cosCoeffsInitTest", "=", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "2.0", ",", "3.0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhTest", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"layer", "=", 
   RowBox[{"makeFourierGraphMuh", "[", 
    RowBox[{
    "nhTest", ",", "freqsTest", ",", "sinCoeffsInitTest", ",", 
     "cosCoeffsInitTest"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tptTest", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"layer", "[", "tptTest", "]"}]}], "Input",
 CellChangeTimes->{{3.8270000453066893`*^9, 3.827000079167069*^9}, {
   3.827000158563294*^9, 3.827000167746469*^9}, {3.82735320874232*^9, 
   3.827353219328298*^9}, {3.8273533048517513`*^9, 3.827353305016062*^9}, {
   3.827355924429823*^9, 3.8273559274152308`*^9}, 
   3.830798514104895*^9},ExpressionUUID->"096eae42-a05a-41b3-86d9-\
5b7b62624ba0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.0820331797003746`"}], ",", 
   RowBox[{"-", "0.0820331797003746`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.827000080226893*^9, 3.82700012776622*^9, {3.8270001640843773`*^9, 
   3.8270001691569033`*^9}, 3.8270015922043877`*^9, 3.8273532204967537`*^9, 
   3.827353306483653*^9, {3.827355910121509*^9, 3.8273559286028767`*^9}, 
   3.8273647664640427`*^9},
 CellLabel->
  "Out[1228]=",ExpressionUUID->"297c04c9-40b3-4017-b5ff-96acfb446caf"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "freqsTest", ",", "sinCoeffsInitTest", ",", "cosCoeffsInitTest", ",", 
   "nhTest", ",", "layer", ",", "tptTest"}], "]"}]], "Input",
 CellChangeTimes->{{3.827364765911942*^9, 3.827364776285968*^9}},
 CellLabel->
  "In[1229]:=",ExpressionUUID->"a4eb4b18-7f3a-49cb-9355-387a07c4eb7f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Fourier graph for varh", "Chapter",
 CellChangeTimes->{{3.8273530092996187`*^9, 
  3.8273530128810263`*^9}},ExpressionUUID->"dca4cd67-10a0-4086-a71b-\
812d2905a4e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeFourierGraphVarh", "[", 
   RowBox[{
   "nh_", ",", "freqs_", ",", "sinCoeffsInit_", ",", "cosCoeffsInit_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "\"\<catenate\>\"", "]"}], "=", 
      RowBox[{"CatenateLayer", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"nh", ">", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<nil\>\"", "]"}], "=", 
         RowBox[{"NetArrayLayer", "[", 
          RowBox[{
           RowBox[{"Array", "->", 
            RowBox[{"{", "0.0", "}"}]}], ",", 
           RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "\"\<reshape\>\"", "]"}], "=", 
      RowBox[{"ReshapeLayer", "[", 
       RowBox[{"{", 
        RowBox[{"nh", ",", "nh"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"layerDefns", "[", 
          RowBox[{"\"\<varhDiag\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}], "]"}], "=", 
         RowBox[{"makeFourierGraph", "[", 
          RowBox[{"freqs", ",", "sinCoeffsInit", ",", "cosCoeffsInit", ",", 
           RowBox[{"{", "1.01", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"layerDefns", "[", 
          RowBox[{"\"\<varhDiag\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}], "<>", "\"\<Reshape\>\""}], 
          "]"}], "=", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", "1", "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nh"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "j"}], ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"layerConn", ",", 
              RowBox[{
               RowBox[{"\"\<varhDiag\>\"", "<>", 
                RowBox[{"ToString", "[", "i", "]"}]}], "\[Rule]", 
               RowBox[{
                RowBox[{"\"\<varhDiag\>\"", "<>", 
                 RowBox[{"ToString", "[", "i", "]"}], "<>", 
                 "\"\<Reshape\>\""}], "->", "\"\<catenate\>\""}]}]}], "]"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"layerConn", ",", 
              RowBox[{"\"\<nil\>\"", "\[Rule]", "\"\<catenate\>\""}]}], 
             "]"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "nh"}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "nh"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerConn", ",", 
       RowBox[{"\"\<catenate\>\"", "->", "\"\<reshape\>\""}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827000485849697*^9, 3.82700049447713*^9}, {
  3.827000525031704*^9, 3.827000527846362*^9}, {3.827000570477994*^9, 
  3.827000598695407*^9}, {3.827001038483303*^9, 3.82700108089251*^9}, {
  3.8270011157811193`*^9, 3.827001159560721*^9}, {3.82700121536364*^9, 
  3.8270012612024517`*^9}, {3.827001661780768*^9, 3.8270016647680407`*^9}, {
  3.8273537652624683`*^9, 3.827353766007834*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"3467a33a-6c0e-42f1-9e63-aa031004a145"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8273530158103333`*^9, 
  3.827353016086177*^9}},ExpressionUUID->"495d655e-5252-445a-8359-\
f38c2b670d90"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"freqsTest", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sinCoeffsInitTest", "=", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "2.0", ",", "3.0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cosCoeffsInitTest", "=", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "2.0", ",", "3.0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhTest", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"layer", "=", 
   RowBox[{"makeFourierGraphVarh", "[", 
    RowBox[{
    "nhTest", ",", "freqsTest", ",", "sinCoeffsInitTest", ",", 
     "cosCoeffsInitTest"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tptTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"layer", "[", "tptTest", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.827000253674367*^9, 3.8270002541990423`*^9}, {
   3.827000453805625*^9, 3.82700045390405*^9}, {3.827000586446313*^9, 
   3.8270005867718163`*^9}, {3.8270010864185753`*^9, 3.827001086934833*^9}, {
   3.827353117018721*^9, 3.8273531595297203`*^9}, {3.827355934215406*^9, 
   3.827355937809437*^9}, 
   3.830798519622039*^9},ExpressionUUID->"2a2977e5-93c4-4446-9189-\
397be85e6776"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.9862102270126343`", "0.`"},
     {"0.`", "0.9862102270126343`"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.827000255619569*^9, {3.827000423557335*^9, 3.827000455702458*^9}, {
   3.827000589586625*^9, 3.827000601214164*^9}, {3.8270010857002687`*^9, 
   3.827001088175638*^9}, {3.8270011292652893`*^9, 3.8270011618747253`*^9}, {
   3.8270012250512743`*^9, 3.8270012298377037`*^9}, 3.8270012632052183`*^9, {
   3.827353154493794*^9, 3.82735316069739*^9}, 3.8273559390921087`*^9, 
   3.827364779659256*^9},
 CellLabel->
  "Out[1236]//MatrixForm=",ExpressionUUID->"c21a5a37-5529-48d6-a849-\
75a8ae6fda32"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "freqsTest", ",", "sinCoeffsInitTest", ",", "cosCoeffsInitTest", ",", 
   "nhTest", ",", "layer", ",", "tptTest"}], "]"}]], "Input",
 CellChangeTimes->{{3.827364778867951*^9, 3.827364787147888*^9}},
 CellLabel->
  "In[1237]:=",ExpressionUUID->"16e35519-9804-4b83-be83-33c54491d24f"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convert params 0 to params", "Chapter",
 CellChangeTimes->{{3.827353018608032*^9, 
  3.8273530218109083`*^9}},ExpressionUUID->"56725cc8-e07c-43f9-b3b4-\
aa3a1f43a5c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertParams0ToParamsLayer", "[", 
   RowBox[{
   "nv_", ",", "nh_", ",", "freqs_", ",", "muhCosCoeffsInit_", ",", 
    "muhSinCoeffsInit_", ",", "varhCosCoeffsInit_", ",", 
    "varhSinCoeffsInit_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn", ",", "graph"}], "}"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<layerMuh\>\"", "->", 
         RowBox[{"makeFourierGraphMuh", "[", 
          RowBox[{
          "nh", ",", "freqs", ",", "muhSinCoeffsInit", ",", 
           "muhCosCoeffsInit"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<layerVarh\>\"", "->", 
         RowBox[{"makeFourierGraphVarh", "[", 
          RowBox[{
          "nh", ",", "freqs", ",", "varhSinCoeffsInit", ",", 
           "varhCosCoeffsInit"}], "]"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<convertblayer\>\"", "->", 
         RowBox[{"convertbLayerFrom0", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<flattenb\>\"", "\[Rule]", 
         RowBox[{"FlattenLayer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertwtlayer\>\"", "->", 
         RowBox[{"convertwtLayerFrom0", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<layerMuh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertblayer\>\"", ",", "\"\<muh2\>\""}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<layerVarh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertblayer\>\"", ",", "\"\<varh2\>\""}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertblayer\>\"", "\[Rule]", 
         RowBox[{"\"\<flattenb\>\"", "->", 
          RowBox[{"NetPort", "[", "\"\<b2\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\"\<layerVarh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertwtlayer\>\"", ",", "\"\<varh2\>\""}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertwtlayer\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<wt2\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\"\<layerMuh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<muh2\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<layerVarh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<varh2\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<sig2\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<sig2\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"graph", "=", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<sig2\>\"", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "graph", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825705981534645*^9, 3.825706050022122*^9}, {
  3.825718738178441*^9, 3.8257187734076*^9}, {3.8257203687627783`*^9, 
  3.825720455390102*^9}, {3.826035436753889*^9, 3.826035483623488*^9}, {
  3.826043642747409*^9, 3.826043684940377*^9}, {3.826043763118853*^9, 
  3.826043851982929*^9}, {3.8260439051598797`*^9, 3.826043906870182*^9}, {
  3.8261179974707527`*^9, 3.82611802593007*^9}, {3.826736595093892*^9, 
  3.826736625252583*^9}, {3.8269997855256233`*^9, 3.826999798835979*^9}, {
  3.827000620696177*^9, 3.827000665179558*^9}, {3.8270012965275908`*^9, 
  3.827001325534956*^9}, {3.827001460732277*^9, 3.827001465395729*^9}, {
  3.827001606372862*^9, 3.827001612588271*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"a365bf21-ecee-4dcf-93cd-95e4ab038d86"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8273530905129557`*^9, 
  3.827353091654416*^9}},ExpressionUUID->"0fb607a4-0ac0-425e-a7cb-\
4ce84a0eee7f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nvTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhTest", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"freqsTest", "=", 
   RowBox[{"{", 
    RowBox[{"0.1", ",", "0.2", ",", "0.3", ",", "0.4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muhCosCoeffsInitTest", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muhSinCoeffsInitTest", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varhCosCoeffsInitTest", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "4"}], "]"}]}], ";", 
  RowBox[{"varhSinCoeffsInitTest", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "4"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.827353031201663*^9, 3.827353064174553*^9}},
 CellLabel->
  "In[425]:=",ExpressionUUID->"38bacdb5-1c9d-4306-9ac8-b43d11542025"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertParams0ToParamsLayer", "[", 
   RowBox[{
   "nvTest", ",", "nhTest", ",", "freqsTest", ",", "muhCosCoeffsInitTest", 
    ",", "muhSinCoeffsInitTest", ",", "varhCosCoeffsInitTest", ",", 
    "varhSinCoeffsInitTest"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.825706056651168*^9, 3.8257060644394207`*^9}, {
   3.826035492261265*^9, 3.826035492427899*^9}, {3.826043855615714*^9, 
   3.826043860562415*^9}, {3.8261180415671997`*^9, 3.8261180421572857`*^9}, {
   3.827001467475685*^9, 3.827001468652581*^9}, {3.8270016858794193`*^9, 
   3.827001686754448*^9}, {3.827353071078106*^9, 3.8273530814758463`*^9}, 
   3.8307985242383747`*^9},ExpressionUUID->"31b5925e-52e5-48c1-8b2c-\
eda21f54006d"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "nvTest", ",", "nhTest", ",", "freqsTest", ",", "muhCosCoeffsInitTest", ",",
    "muhSinCoeffsInitTest", ",", "varhCosCoeffsInitTest", ",", 
   "varhSinCoeffsInitTest"}], "]"}]], "Input",
 CellChangeTimes->{{3.8273647899106503`*^9, 3.827364816755108*^9}},
 CellLabel->
  "In[1238]:=",ExpressionUUID->"d0735ec9-1fc5-46ee-b3b9-134c970372c2"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Moments from params", "Title",
 CellChangeTimes->{{3.825784408131878*^9, 3.825784408509409*^9}, {
  3.825784782569479*^9, 
  3.8257847858322277`*^9}},ExpressionUUID->"6af74424-f4fe-4f07-827d-\
58a5ec887ae3"],

Cell[CellGroupData[{

Cell["Catenate varv, varvh, varh", "Chapter",
 CellChangeTimes->{{3.827356019971657*^9, 
  3.827356026241054*^9}},ExpressionUUID->"956e8db4-64e5-4101-9cbc-\
d3223c1a84b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeVarArrayReshapeLayer", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"FunctionLayer", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Catenate", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Transpose", "[", 
          RowBox[{"Catenate", "[", 
           RowBox[{"{", 
            RowBox[{"#varv", ",", "#varvh"}], "}"}], "]"}], "]"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Catenate", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Transpose", "[", "#varvh", "]"}], ",", "#varh"}], "}"}],
            "]"}], "]"}]}], "}"}], "]"}], "]"}], "&"}], ",", 
    RowBox[{"\"\<varv\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"nv", ",", "nv"}], "}"}]}], ",", 
    RowBox[{"\"\<varvh\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
    RowBox[{"\"\<varh\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"nh", ",", "nh"}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8257861609531803`*^9, 3.825786176757854*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"322f1acc-b919-4d84-88f7-721b03c9aef7"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.827356030654011*^9, 
  3.827356031052065*^9}},ExpressionUUID->"1a636228-fe3e-4056-a400-\
d50bfde822e8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"lyr", "=", 
    RowBox[{"makeVarArrayReshapeLayer", "[", 
     RowBox[{"nv", ",", "nh"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varvTest", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nv", ",", "nv"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varvhTest", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nh", ",", "nv"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varhTest", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nh", ",", "nh"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrayFlatten", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"varvTest", ",", 
       RowBox[{"Transpose", "[", "varvhTest", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"varvhTest", ",", "varhTest"}], "}"}]}], "}"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"lyr", "[", 
  RowBox[{"<|", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\"\<varv\>\"", "\[Rule]", "varvTest"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<varvh\>\"", "\[Rule]", "varvhTest"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"\"\<varh\>\"", "\[Rule]", "varhTest"}]}], "\[IndentingNewLine]", 
   "|>"}], "]"}]}], "Input",
 CellChangeTimes->{{3.825786182044635*^9, 3.825786196877397*^9}, 
   3.830798532857605*^9},ExpressionUUID->"febff9b1-857e-4a05-87b7-\
e822e6003230"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.25131400064662746`"}], ",", 
     RowBox[{"-", "0.974585672128494`"}], ",", "0.5331006471075255`", ",", 
     "0.5359948059861104`", ",", "0.41461716318661956`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.648597890479687`"}], ",", "0.012690256020083002`", ",", 
     RowBox[{"-", "0.4507408783001887`"}], ",", 
     RowBox[{"-", "0.6203677216464416`"}], ",", 
     RowBox[{"-", "0.4054338666801791`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9099656552760833`", ",", "0.12404635648843376`", ",", 
     RowBox[{"-", "0.3655279047122959`"}], ",", "0.6977046497549466`", ",", 
     RowBox[{"-", "0.8407672956225278`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5359948059861104`", ",", 
     RowBox[{"-", "0.6203677216464416`"}], ",", "0.6977046497549466`", ",", 
     "0.588553507298073`", ",", 
     RowBox[{"-", "0.31956631140267344`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.41461716318661956`", ",", 
     RowBox[{"-", "0.4054338666801791`"}], ",", 
     RowBox[{"-", "0.8407672956225278`"}], ",", 
     RowBox[{"-", "0.041328399489899414`"}], ",", 
     RowBox[{"-", "0.8467309377171279`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.82578618575911*^9, 3.825786197278028*^9}, 
   3.825883121033534*^9, 3.827001753578656*^9, 3.827356032995267*^9},
 CellLabel->
  "Out[438]=",ExpressionUUID->"36ee8eaa-1aae-4ccc-a554-930cc5488663"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.2513140141963959`"}], ",", 
     RowBox[{"-", "0.9745856523513794`"}], ",", "0.5331006646156311`", ",", 
     "0.535994827747345`", ",", "0.4146171510219574`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6485978960990906`"}], ",", "0.012690256349742413`", ",", 
     
     RowBox[{"-", "0.45074087381362915`"}], ",", 
     RowBox[{"-", "0.620367705821991`"}], ",", 
     RowBox[{"-", "0.40543386340141296`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9099656343460083`", ",", "0.12404635548591614`", ",", 
     RowBox[{"-", "0.3655278980731964`"}], ",", "0.6977046728134155`", ",", 
     RowBox[{"-", "0.8407673239707947`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.535994827747345`", ",", 
     RowBox[{"-", "0.620367705821991`"}], ",", "0.6977046728134155`", ",", 
     "0.5885534882545471`", ",", 
     RowBox[{"-", "0.3195663094520569`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4146171510219574`", ",", 
     RowBox[{"-", "0.40543386340141296`"}], ",", 
     RowBox[{"-", "0.8407673239707947`"}], ",", 
     RowBox[{"-", "0.04132840037345886`"}], ",", 
     RowBox[{"-", "0.8467309474945068`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.82578618575911*^9, 3.825786197278028*^9}, 
   3.825883121033534*^9, 3.827001753578656*^9, 3.827356032997283*^9},
 CellLabel->
  "Out[439]=",ExpressionUUID->"b03879de-aae2-43dc-b355-dbec30db6ba1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"lyr", ",", "varvTest", ",", "varvhTest", ",", "varhTest"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8273648235085897`*^9, 3.827364832285228*^9}},
 CellLabel->
  "In[1239]:=",ExpressionUUID->"46cb9a84-63cc-4268-ac1c-5560fb9d4b8e"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convert params to moments", "Chapter",
 CellChangeTimes->{{3.827356061802331*^9, 
  3.827356065636908*^9}},ExpressionUUID->"299c0f25-55d8-4829-b93a-\
ecd6d2b00b8d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGraphConvertParamsToMoments", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<varvh\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#varh", ".", "#wt"}], "&"}], ",", 
           RowBox[{"\"\<varh\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<wt\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<idmat\>\"", "\[Rule]", 
         RowBox[{"NetArrayLayer", "[", 
          RowBox[{
           RowBox[{"\"\<Array\>\"", "->", 
            RowBox[{"IdentityMatrix", "[", "nv", "]"}]}], ",", 
           RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<varv\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "#wt", "]"}], ".", "#varh", ".", 
              "#wt"}], "+", 
             RowBox[{"#sig2", "*", "#idmat"}]}], "&"}], ",", 
           RowBox[{"\"\<wt\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varh\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<sig2\>\"", "\[Rule]", "1"}], ",", 
           RowBox[{"\"\<idmat\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nv", ",", "nv"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<muv\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#b", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "#wt", "]"}], ".", "#muh"}]}], "&"}], 
           ",", 
           RowBox[{"\"\<b\>\"", "\[Rule]", "nv"}], ",", 
           RowBox[{"\"\<wt\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<muh\>\"", "\[Rule]", "nh"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Catenate", "[", 
             RowBox[{"{", 
              RowBox[{"#muv", ",", "#muh"}], "}"}], "]"}], "&"}], ",", 
           RowBox[{"\"\<muv\>\"", "\[Rule]", "nv"}], ",", 
           RowBox[{"\"\<muh\>\"", "\[Rule]", "nh"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<var\>\"", "\[Rule]", 
         RowBox[{"makeVarArrayReshapeLayer", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "varvh", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varvh\>\"", ",", "\"\<varh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<wt\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varvh\>\"", ",", "\"\<wt\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "varv", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<wt\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varv\>\"", ",", "\"\<wt\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varv\>\"", ",", "\"\<varh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<sig2\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varv\>\"", ",", "\"\<sig2\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<idmat\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<varv\>\"", ",", "\"\<idmat\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "muv", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<b\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<muv\>\"", ",", "\"\<b\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<wt\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<muv\>\"", ",", "\"\<wt\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muh\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<muv\>\"", ",", "\"\<muh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "mu", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\"\<muv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mu\>\"", ",", "\"\<muv\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muh\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mu\>\"", ",", "\"\<muh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<mu\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "var", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\"\<varvh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<var\>\"", ",", "\"\<varvh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<var\>\"", ",", "\"\<varv\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<var\>\"", ",", "\"\<varh\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<var\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<var\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "Misc", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\"\<varvh\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<varvh\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825784787348721*^9, 3.825784798783022*^9}, {
  3.825786541731583*^9, 3.825786584948995*^9}, {3.825788099857664*^9, 
  3.825788110676518*^9}, {3.8258830837451878`*^9, 3.82588310845868*^9}, {
  3.825883198588648*^9, 3.825883199021044*^9}, {3.826033313334261*^9, 
  3.826033320843611*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"e07c8541-1179-4820-b811-9b07e9faf697"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nvTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhTest", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeGraphConvertParamsToMoments", "[", 
   RowBox[{"nvTest", ",", "nhTest"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.825788088588971*^9, 3.825788089234741*^9}, {
   3.8273560815625553`*^9, 3.8273560882878237`*^9}, 
   3.8307985382578163`*^9},ExpressionUUID->"599aaa96-365b-4503-aafe-\
20aba7d77949"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nvTest", ",", "nhTest"}], "]"}]], "Input",
 CellChangeTimes->{{3.827364836470014*^9, 3.827364840050819*^9}},
 CellLabel->
  "In[1240]:=",ExpressionUUID->"f383a405-9f31-41c4-9ea7-88da6c3e3403"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["NMoments from moments/params", "Title",
 CellChangeTimes->{{3.825787538752645*^9, 
  3.82578754902521*^9}},ExpressionUUID->"c0dd3a22-94d8-4ff8-bb31-\
e0c16d130d7f"],

Cell[CellGroupData[{

Cell["Convert moments to nmoments", "Chapter",
 CellChangeTimes->{{3.8273561053684483`*^9, 
  3.827356108895503*^9}},ExpressionUUID->"656300c1-b958-476c-92fd-\
55b749c22e64"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGraphConvertMomentsToNMoments", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<reshapeMu\>\"", "\[Rule]", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<kpv\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#mu", ".", 
             RowBox[{"Transpose", "[", "#mu", "]"}]}], "&"}], ",", 
           RowBox[{"\"\<mu\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<nvar\>\"", "\[Rule]", 
         RowBox[{"TotalLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<mu\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<reshapeMu\>\"", "\[Rule]", 
          RowBox[{"\"\<kpv\>\"", "\[Rule]", "\"\<nvar\>\""}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<var\>\"", "]"}], "\[Rule]", 
         "\"\<nvar\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<mu\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<mu\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<nvar\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<nvar\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825787551905673*^9, 3.82578768332721*^9}, {
  3.8257877375949097`*^9, 3.825787752213188*^9}, {3.825788124057631*^9, 
  3.825788142662965*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"03ec8a4e-fc56-4a54-b74e-c41964bd45c8"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8273561295087557`*^9, 
  3.827356130785206*^9}},ExpressionUUID->"d80a9052-a75a-40e8-964c-\
7364990316a3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nvTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhTest", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"makeGraphConvertMomentsToNMoments", "[", 
  RowBox[{"nvTest", ",", "nhTest"}], "]"}]}], "Input",
 CellChangeTimes->{{3.825787691011198*^9, 3.8257876946428127`*^9}, {
  3.827356133419856*^9, 3.827356140728902*^9}, {3.830798543987338*^9, 
  3.830798545081809*^9}},ExpressionUUID->"bd587b45-36b0-4af1-899f-\
ba028755ef42"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nvTest", ",", "nhTest"}], "]"}]], "Input",
 CellLabel->
  "In[1241]:=",ExpressionUUID->"77e1a2c5-6625-4f10-b10e-e8d3bbedf020"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Convert params to nmoments", "Chapter",
 CellChangeTimes->{{3.827356144049679*^9, 
  3.827356148274809*^9}},ExpressionUUID->"a77bdd70-a8a2-4068-8b48-\
da877a80b91d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGraphConvertParamsToNMoments", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<paramsToMoments\>\"", "\[Rule]", 
         RowBox[{"makeGraphConvertParamsToMoments", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<momentsToNMoments\>\"", "\[Rule]", 
         RowBox[{"makeGraphConvertMomentsToNMoments", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<paramsToMoments\>\"", ",", "\"\<mu\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<momentsToNMoments\>\"", ",", "\"\<mu\>\""}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<paramsToMoments\>\"", ",", "\"\<var\>\""}], "]"}], 
         "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<momentsToNMoments\>\"", ",", "\"\<var\>\""}], 
          "]"}]}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8257879966587276`*^9, 3.825788072782784*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"a6d3be3c-8a34-4a91-ba32-0ff75dbe2be1"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.827356151043112*^9, 
  3.82735615131361*^9}},ExpressionUUID->"939baf4f-992d-47a5-97f9-\
1dac7ff961ec"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nvTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhTest", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeGraphConvertParamsToNMoments", "[", 
   RowBox[{"nvTest", ",", "nhTest"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.825788073548258*^9, 3.825788078139997*^9}, {
   3.8273561549757843`*^9, 3.8273561637235003`*^9}, 
   3.830798548960557*^9},ExpressionUUID->"af0af7bb-f129-48a6-927a-\
9f3a1428346b"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nvTest", ",", "nhTest"}], "]"}]], "Input",
 CellLabel->
  "In[1242]:=",ExpressionUUID->"7f2c899e-15eb-40cf-bb8b-f7992bc51628"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Death rxn", "Title",
 CellChangeTimes->{{3.825788578505666*^9, 
  3.8257885793493547`*^9}},ExpressionUUID->"4c6ecff3-0666-4b86-ac9f-\
f1582aa49833"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeDeathMeans", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{"\"\<f\>\"", "->", 
        RowBox[{"FunctionLayer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"#mu", "[", 
              RowBox[{"[", "iSp", "]"}], "]"}]}], "*", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", "iSp"}], "]"}]}], "&"}], ",", 
          RowBox[{"\"\<mu\>\"", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"nv", "+", "nh"}], ")"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<f\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825797322118442*^9, 3.825797400266646*^9}, {
   3.825805793912661*^9, 3.8258058237500896`*^9}, 3.825805932939825*^9, {
   3.825806215060763*^9, 3.8258062336705008`*^9}, {3.82580654111828*^9, 
   3.825806543069293*^9}, {3.828035122777225*^9, 3.828035142725868*^9}, {
   3.828748308741254*^9, 3.828748320259959*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"6020f374-229e-4093-8fdd-4d1cf50728bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeUnitMat", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "i0_", ",", "j0_"}], "]"}], ":=", 
  RowBox[{"NetArrayLayer", "[", 
   RowBox[{
    RowBox[{"\"\<Array\>\"", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", "i0"}], "&&", 
          RowBox[{"j", "\[Equal]", "j0"}]}], ",", "1", ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258049274275846`*^9, 3.825804966950613*^9}, {
  3.827002110136602*^9, 3.827002111391523*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"3e9b3d6e-c4ac-4ed7-93cf-033af5f3451e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeUnitMatSymm", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "i0_", ",", "j0_"}], "]"}], ":=", 
  RowBox[{"NetArrayLayer", "[", 
   RowBox[{
    RowBox[{"\"\<Array\>\"", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "i0"}], "&&", 
            RowBox[{"j", "\[Equal]", "j0"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "j0"}], "&&", 
            RowBox[{"j", "\[Equal]", "i0"}]}], ")"}]}], ",", "1", ",", "0"}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"LearningRateMultipliers", "\[Rule]", "None"}]}], 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258049274275846`*^9, 3.825804966950613*^9}, {
  3.8258054390348186`*^9, 3.825805451657481*^9}, {3.82700211491586*^9, 
  3.8270021170367413`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"c6a2eb84-bf4c-444f-a2fc-c5207627e278"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeDeathNVarDiagMat", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMat", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp", ",", "iSp"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], "*", 
               RowBox[{"#nvar", "[", 
                RowBox[{"[", 
                 RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}]}], "+", 
              RowBox[{"#mu", "[", 
               RowBox[{"[", "iSp", "]"}], "]"}]}], ")"}]}], "&"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805023567387*^9, 3.8258051678646584`*^9}, {
   3.825805198830471*^9, 3.825805263798155*^9}, {3.8258055036548758`*^9, 
   3.825805504376256*^9}, 3.825871891032954*^9, {3.827002122305254*^9, 
   3.827002122953421*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"8c01b497-6d4d-4bc1-a379-921da1e6e19d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeDeathNVarOffDiagMatSymm", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_", ",", "jSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp", ",", "jSp"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{"-", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}]}], ")"}]}], "&"}], 
          "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805023567387*^9, 3.8258051678646584`*^9}, {
   3.825805198830471*^9, 3.825805263798155*^9}, {3.82580541940361*^9, 
   3.8258055144877768`*^9}, {3.825805611712385*^9, 3.8258056123780317`*^9}, 
   3.8258718931732683`*^9, {3.8270021286600437`*^9, 3.827002129306726*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"016f770d-e3aa-4373-a195-a9dfc825e27f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeDeathNVar", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "layerDefns", ",", "layerName", ",", "layerNames", ",", "layerConn"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerNames", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerDefns", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iSp", "]"}], "<>", 
       RowBox[{"ToString", "[", "iSp", "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeDeathNVarDiagMat", "[", 
       RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"iSp", "\[Equal]", "jSp"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"layerName", "=", 
         RowBox[{"\"\<m\>\"", "<>", 
          RowBox[{"ToString", "[", "iSp", "]"}], "<>", 
          RowBox[{"ToString", "[", "jSp", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
         RowBox[{"makeDeathNVarOffDiagMatSymm", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp", ",", "jSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerNames", ",", "layerName"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "\"\<tot\>\"", "]"}], "=", 
      RowBox[{"TotalLayer", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"layerNames", "\[Rule]", 
        RowBox[{"\"\<tot\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<nvarTE\>\"", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<nvar\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nv", "+", "nh"}], ",", 
           RowBox[{"nv", "+", "nh"}]}], "}"}]}], ",", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"nv", "+", "nh"}]}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805291720524*^9, 3.825805407965281*^9}, {
  3.825805540746076*^9, 3.825805707498351*^9}, {3.825805739741499*^9, 
  3.825805761943439*^9}, {3.8258057976722927`*^9, 3.825805820457033*^9}, {
  3.8258718953406467`*^9, 3.825871900230241*^9}, {3.828035149730424*^9, 
  3.828035172490514*^9}, {3.828748325007419*^9, 3.828748332361473*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"1207896e-17be-4e6b-98d3-1eb7faf89c15"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8258061076842203`*^9, 
  3.825806108010344*^9}},ExpressionUUID->"dcb585f8-9fa8-4c1e-a058-\
f698a8de46b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeRxnDeathNMomentsTE", "[", 
   RowBox[{"nMoments_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nv", ",", "nh", ",", "te", ",", "mu", ",", "nvar", ",", "n"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", "3"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Means", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mu", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mu", "[", 
       RowBox[{"[", "iSp", "]"}], "]"}], "=", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "[", 
        RowBox[{"[", "iSp", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Variances", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nvar", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nvar", "[", 
       RowBox[{"[", 
        RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], "*", 
        RowBox[{
         RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "[", 
        RowBox[{"[", "iSp", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"iSp", "\[Equal]", "jSp"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}], "=", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"jSp", ",", "iSp"}], "]"}], "]"}], "=", 
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"te", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"te", "[", "\"\<muTE\>\"", "]"}], "=", "mu"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"te", "[", "\"\<nvarTE\>\"", "]"}], "=", "nvar"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "te", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825806105763329*^9, 3.825806116929751*^9}, {
  3.8258065610193157`*^9, 3.825806565421042*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"dcf24204-5757-43bf-8d0f-2518f641618d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMoments", "=", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nv", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nh", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outTrue", "=", 
    RowBox[{"makeRxnDeathNMomentsTE", "[", 
     RowBox[{"nMoments", ",", "2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeDeathMeans", "[", 
    RowBox[{"nv", ",", "nh", ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"muTrue", "=", 
  RowBox[{"outTrue", "[", "\"\<muTE\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"muTest", "=", 
  RowBox[{"lyr", "[", "nMoments", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{"muTest", "-", "muTrue"}], "]"}], "]"}], "<", 
   SuperscriptBox["10", 
    RowBox[{"-", "5"}]]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeDeathNVar", "[", 
    RowBox[{"nv", ",", "nh", ",", "2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nvarTrue", "=", 
  RowBox[{"outTrue", "[", "\"\<nvarTE\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nvarTest", "=", 
  RowBox[{"lyr", "[", "nMoments", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"nvarTest", "-", "nvarTrue"}], "]"}], "]"}], "<", 
  SuperscriptBox["10", 
   RowBox[{"-", "5"}]]}]}], "Input",
 CellChangeTimes->{{3.825806122120771*^9, 3.825806158807034*^9}, {
   3.8258062774032707`*^9, 3.825806385537447*^9}, {3.825806570096479*^9, 
   3.825806592426536*^9}, 3.8258719077823687`*^9},
 CellLabel->
  "In[576]:=",ExpressionUUID->"2589dfb4-3720-4ddb-bfc0-1492608a07b5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0.7354303897691437`", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.825884424937608*^9},
 CellLabel->
  "Out[583]=",ExpressionUUID->"32de460d-aa76-41bf-b8f5-0fb64698e21b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.7354304194450378`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.8258844249421473`*^9},
 CellLabel->
  "Out[584]=",ExpressionUUID->"be64a8fa-d9e8-479a-83f7-7119a35a54e2"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.825884424943283*^9},
 CellLabel->
  "Out[585]=",ExpressionUUID->"ea6089f3-8bef-4c80-ae84-59ca54bb4dbd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "0.6303740339532351`"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.6303740339532351`"}], ",", 
     RowBox[{"-", "0.8922865601672849`"}], ",", 
     RowBox[{"-", "0.22091135996732492`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", "0.22091135996732492`"}], ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.825884425207059*^9},
 CellLabel->
  "Out[587]=",ExpressionUUID->"05ee64ef-b6b7-457f-a7c3-17cbe0cb6a1d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "0.630374014377594`"}], ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.630374014377594`"}], ",", 
     RowBox[{"-", "0.8922865986824036`"}], ",", 
     RowBox[{"-", "0.22091135382652283`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.`", ",", 
     RowBox[{"-", "0.22091135382652283`"}], ",", "0.`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.825884425220359*^9},
 CellLabel->
  "Out[588]=",ExpressionUUID->"8c4bbfd1-befd-4d14-b63b-555a77c2fbcd"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, {
   3.8258065799498577`*^9, 3.825806592801323*^9}, 3.825884425221489*^9},
 CellLabel->
  "Out[589]=",ExpressionUUID->"a31c2dde-2e59-4126-8ddd-7ea494be620f"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Birth rxn", "Title",
 CellChangeTimes->{{3.825788578505666*^9, 3.8257885793493547`*^9}, {
  3.82580590655658*^9, 
  3.825805910986578*^9}},ExpressionUUID->"42f75383-66ed-4961-a102-\
78009944226d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeBirthMeans", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{"\"\<f\>\"", "->", 
        RowBox[{"FunctionLayer", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#mu", "[", 
             RowBox[{"[", "iSp", "]"}], "]"}], "*", 
            RowBox[{"UnitVector", "[", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", "iSp"}], "]"}]}], "&"}], ",", 
          RowBox[{"\"\<mu\>\"", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"nv", "+", "nh"}], ")"}]}]}], "]"}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<f\>\"", "->", 
        RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825797322118442*^9, 3.825797400266646*^9}, {
  3.825805793912661*^9, 3.8258058237500896`*^9}, {3.825805913517797*^9, 
  3.825805914780362*^9}, {3.82580623951912*^9, 3.8258062633444347`*^9}, {
  3.828035182274173*^9, 3.828035197568712*^9}, {3.828748337594219*^9, 
  3.828748343329014*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"108d6b6e-c497-40cf-8664-5610ffdeba77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeBirthNVarDiagMat", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMat", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp", ",", "iSp"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "*", 
               RowBox[{"#nvar", "[", 
                RowBox[{"[", 
                 RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}]}], "+", 
              RowBox[{"#mu", "[", 
               RowBox[{"[", "iSp", "]"}], "]"}]}], ")"}]}], "&"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805023567387*^9, 3.8258051678646584`*^9}, {
   3.825805198830471*^9, 3.825805263798155*^9}, {3.8258055036548758`*^9, 
   3.825805504376256*^9}, {3.825805943144033*^9, 3.825805952977646*^9}, 
   3.825871911822729*^9, {3.8270021460125723`*^9, 3.827002147500803*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"4a06b9d7-318e-4484-abbc-47cd5f35e0f2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeBirthNVarOffDiagMatSymm", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_", ",", "jSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp", ",", "jSp"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{"#nvar", "[", 
              RowBox[{"[", 
               RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}], ")"}]}], "&"}], 
          "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805023567387*^9, 3.8258051678646584`*^9}, {
   3.825805198830471*^9, 3.825805263798155*^9}, {3.82580541940361*^9, 
   3.8258055144877768`*^9}, {3.825805611712385*^9, 3.8258056123780317`*^9}, {
   3.825805955293206*^9, 3.825805960743833*^9}, 3.825871914364833*^9, {
   3.827002149772646*^9, 3.827002150699979*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"ab668816-d09a-476b-8fa8-077b20e21ec8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeBirthNVar", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "layerDefns", ",", "layerName", ",", "layerNames", ",", "layerConn"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerNames", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerDefns", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iSp", "]"}], "<>", 
       RowBox[{"ToString", "[", "iSp", "]"}]}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeBirthNVarDiagMat", "[", 
       RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"iSp", "\[Equal]", "jSp"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"layerName", "=", 
         RowBox[{"\"\<m\>\"", "<>", 
          RowBox[{"ToString", "[", "iSp", "]"}], "<>", 
          RowBox[{"ToString", "[", "jSp", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
         RowBox[{"makeBirthNVarOffDiagMatSymm", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp", ",", "jSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerNames", ",", "layerName"}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "\"\<tot\>\"", "]"}], "=", 
      RowBox[{"TotalLayer", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"layerNames", "\[Rule]", 
        RowBox[{"\"\<tot\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<nvarTE\>\"", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<nvar\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nv", "+", "nh"}], ",", 
           RowBox[{"nv", "+", "nh"}]}], "}"}]}], ",", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"nv", "+", "nh"}]}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805291720524*^9, 3.825805407965281*^9}, {
   3.825805540746076*^9, 3.825805707498351*^9}, {3.825805739741499*^9, 
   3.825805761943439*^9}, {3.8258057976722927`*^9, 3.825805820457033*^9}, {
   3.825805963998415*^9, 3.825805971688965*^9}, 3.825871882254445*^9, {
   3.825871918540702*^9, 3.8258719203530273`*^9}, {3.828035203008767*^9, 
   3.828035226236638*^9}, {3.828748348325595*^9, 3.828748356666225*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"9e65a4f7-c0fe-4e19-ae6e-6919744b62fb"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8258061076842203`*^9, 
  3.825806108010344*^9}},ExpressionUUID->"16b0cae3-8e63-4cc9-9cd9-\
303c9a37e741"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeRxnBirthNMomentsTE", "[", 
   RowBox[{"nMoments_", ",", "iSp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"nv", ",", "nh", ",", "te", ",", "mu", ",", "nvar", ",", "n"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", "3"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Means", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"mu", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "n"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mu", "[", 
       RowBox[{"[", "iSp", "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "[", 
       RowBox[{"[", "iSp", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Variances", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nvar", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nvar", "[", 
       RowBox[{"[", 
        RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"2", "*", 
        RowBox[{
         RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"iSp", ",", "iSp"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "[", 
        RowBox[{"[", "iSp", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"iSp", "\[Equal]", "jSp"}], ",", 
          RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"jSp", ",", "iSp"}], "]"}], "]"}], "=", 
         RowBox[{"nvar", "[", 
          RowBox[{"[", 
           RowBox[{"iSp", ",", "jSp"}], "]"}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]",
      "\[IndentingNewLine]", 
     RowBox[{"te", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"te", "[", "\"\<muTE\>\"", "]"}], "=", "mu"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"te", "[", "\"\<nvarTE\>\"", "]"}], "=", "nvar"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "te", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825806105763329*^9, 3.825806116929751*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"8866315e-af8f-4589-a4db-30c989591f35"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nMoments", "=", 
   RowBox[{"Association", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nMoments", "[", "\"\<nvar\>\"", "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nMoments", "[", "\"\<mu\>\"", "]"}], "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "3"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nv", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nh", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"outTrue", "=", 
    RowBox[{"makeRxnBirthNMomentsTE", "[", 
     RowBox[{"nMoments", ",", "1"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeBirthMeans", "[", 
    RowBox[{"nv", ",", "nh", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"muTrue", "=", 
  RowBox[{"outTrue", "[", "\"\<muTE\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"muTest", "=", 
  RowBox[{"lyr", "[", "nMoments", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Max", "[", 
    RowBox[{"Abs", "[", 
     RowBox[{"muTest", "-", "muTrue"}], "]"}], "]"}], "<", 
   SuperscriptBox["10", 
    RowBox[{"-", "5"}]]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeBirthNVar", "[", 
    RowBox[{"nv", ",", "nh", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"nvarTrue", "=", 
  RowBox[{"outTrue", "[", "\"\<nvarTE\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"nvarTest", "=", 
  RowBox[{"lyr", "[", "nMoments", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"nvarTest", "-", "nvarTrue"}], "]"}], "]"}], "<", 
  SuperscriptBox["10", 
   RowBox[{"-", "5"}]]}]}], "Input",
 CellChangeTimes->{{3.825806122120771*^9, 3.825806158807034*^9}, {
   3.8258062774032707`*^9, 3.825806385537447*^9}, 3.825871925974884*^9},
 CellLabel->
  "In[629]:=",ExpressionUUID->"8a5b8d9b-68ca-46e9-a3f1-34949facc035"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7330052108607172`", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825884473589904*^9},
 CellLabel->
  "Out[636]=",ExpressionUUID->"6490fec2-cdb6-4e4d-816d-f926c101493d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.7330052256584167`", ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.8258844735944567`*^9},
 CellLabel->
  "Out[637]=",ExpressionUUID->"f5ee5a4d-ec18-4ead-ab16-fd44728f4f28"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825884473595594*^9},
 CellLabel->
  "Out[638]=",ExpressionUUID->"ff5a8131-60c5-4d7d-a92b-e01629a0ed55"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.1314661881993469`", ",", "0.9993159047344324`", ",", 
     RowBox[{"-", "0.8195775579879956`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9993159047344324`", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.8195775579879956`"}], ",", "0", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825884473796826*^9},
 CellLabel->
  "Out[640]=",ExpressionUUID->"08dfcdd2-9731-4932-a78e-19030bb308cc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.1314661502838135`", ",", "0.9993159174919128`", ",", 
     RowBox[{"-", "0.8195775747299194`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9993159174919128`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "0.8195775747299194`"}], ",", "0.`", ",", "0.`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825884473807749*^9},
 CellLabel->
  "Out[641]=",ExpressionUUID->"82be0e0a-0ed7-42a4-a58c-fb0bfd5f70e1"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825806322240872*^9, 3.8258063858006983`*^9}, 
   3.825884473808962*^9},
 CellLabel->
  "Out[642]=",ExpressionUUID->"e2dffdb9-c22a-43fd-a2b3-0d8711122069"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Eat rxn", "Title",
 CellChangeTimes->{{3.825788578505666*^9, 3.8257885793493547`*^9}, {
  3.82580590655658*^9, 3.825805910986578*^9}, {3.825869481768215*^9, 
  3.82586948215512*^9}},ExpressionUUID->"131d7ff7-98cc-4b34-94f8-\
aec9dac227ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatMeans", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<prey\>\"", "->", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], "*", 
             RowBox[{"UnitVector", "[", 
              RowBox[{
               RowBox[{"nv", "+", "nh"}], ",", "iPrey"}], "]"}]}], "&"}], ",", 
           RowBox[{"\"\<nvar\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", 
              RowBox[{"nv", "+", "nh"}]}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<hunter\>\"", "->", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#nvar", "[", 
              RowBox[{"[", 
               RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}], "*", 
             RowBox[{"UnitVector", "[", 
              RowBox[{
               RowBox[{"nv", "+", "nh"}], ",", "iHunter"}], "]"}]}], "&"}], 
           ",", 
           RowBox[{"\"\<nvar\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", 
              RowBox[{"nv", "+", "nh"}]}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<total\>\"", "\[Rule]", 
         RowBox[{"TotalLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\"\<hunter\>\"", ",", "\"\<prey\>\""}], "}"}], "\[Rule]", 
        RowBox[{"\"\<total\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825797322118442*^9, 3.825797400266646*^9}, {
  3.825805793912661*^9, 3.8258058237500896`*^9}, {3.825805913517797*^9, 
  3.825805914780362*^9}, {3.82580623951912*^9, 3.8258062633444347`*^9}, {
  3.825869483941722*^9, 3.8258695451603737`*^9}, {3.825869646462834*^9, 
  3.825869704163336*^9}, {3.825869747381749*^9, 3.825869752449211*^9}, {
  3.828034259827834*^9, 3.8280344580292063`*^9}, {3.828034568698372*^9, 
  3.8280345716229486`*^9}, {3.828034875624341*^9, 3.828034909863081*^9}, {
  3.828748373916239*^9, 3.828748378561709*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"7d75e48d-5c95-4ef6-a45c-f2c411223800"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeNMoment3", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  
  RowBox[{"FunctionLayer", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2.0"}], "*", 
       RowBox[{"#mu", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"#mu", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "*", 
       RowBox[{"#mu", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"#mu", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"#nvar", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"#mu", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "*", 
       RowBox[{"#nvar", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "k"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"#mu", "[", 
        RowBox[{"[", "k", "]"}], "]"}], "*", 
       RowBox[{"#nvar", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "&"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"\"\<mu\>\"", "\[Rule]", 
     RowBox[{"nv", "+", "nh"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"\"\<nvar\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nv", "+", "nh"}], ",", 
       RowBox[{"nv", "+", "nh"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258717005482693`*^9, 3.825871833366984*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"9e5ef683-1eab-4a81-a919-674ff23bee7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatNVarPreyPrey", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMat", "[", 
          RowBox[{"nv", ",", "nh", ",", "iPrey", ",", "iPrey"}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{
          "nv", ",", "nh", ",", "iPrey", ",", "iPrey", ",", "iHunter"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2.0"}], "*", "#n3"}], "+", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], ")"}]}], 
           "&"}], "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258718688809843`*^9, 3.825871871956662*^9}, {
  3.8258719294305067`*^9, 3.825872128393684*^9}, {3.8258721587200117`*^9, 
  3.825872172380719*^9}, {3.8270021666717987`*^9, 3.827002167538167*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"d5662e30-11c2-40de-b6e8-853fb16f3fcd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatNVarHunterHunter", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMat", "[", 
          RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iHunter"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{
          "nv", ",", "nh", ",", "iHunter", ",", "iHunter", ",", "iPrey"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2.0", "*", "#n3"}], "+", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], ")"}]}], 
           "&"}], "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258718688809843`*^9, 3.825871871956662*^9}, {
  3.8258719294305067`*^9, 3.825872128393684*^9}, {3.8258721587200117`*^9, 
  3.825872172380719*^9}, {3.825872204702159*^9, 3.825872229728559*^9}, {
  3.827002169812064*^9, 3.8270021705502768`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"07ad98d9-c848-430d-81e7-c5511933e15b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatNVarHunterPrey", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<n3hhp\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{
          "nv", ",", "nh", ",", "iHunter", ",", "iHunter", ",", "iPrey"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<n3hpp\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{
          "nv", ",", "nh", ",", "iHunter", ",", "iPrey", ",", "iPrey"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "#n3hhp"}], "+", "#n3hpp", "-", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], ")"}]}], 
           "&"}], "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3hhp\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3hhp\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3hpp\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3hpp\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258718688809843`*^9, 3.825871871956662*^9}, {
  3.8258719294305067`*^9, 3.825872128393684*^9}, {3.8258721587200117`*^9, 
  3.825872172380719*^9}, {3.825872204702159*^9, 3.825872329376462*^9}, {
  3.8258723717230263`*^9, 3.825872374215766*^9}, {3.8270021739641438`*^9, 
  3.8270021745238743`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"d1a35e2b-e044-45f6-9112-201694367147"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatNVarLoop", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_", ",", "jSp_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMatPrey\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"nv", ",", "nh", ",", "iPrey", ",", "jSp"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<unitMatHunter\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "jSp"}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{"nv", ",", "nh", ",", "jSp", ",", "iPrey", ",", "iHunter"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "#unitMatPrey"}], "*", "#n3"}], "+", 
            RowBox[{"#unitMatHunter", "*", "#n3"}]}], "&"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMatPrey\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMatPrey\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<unitMatHunter\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMatHunter\>\""}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258718688809843`*^9, 3.825871871956662*^9}, {
  3.8258719294305067`*^9, 3.825872128393684*^9}, {3.8258721587200117`*^9, 
  3.825872172380719*^9}, {3.825872204702159*^9, 3.825872329376462*^9}, {
  3.8258723717230263`*^9, 3.825872374215766*^9}, {3.825872446784706*^9, 
  3.825872594157295*^9}, {3.8258733857064734`*^9, 3.8258733876952257`*^9}, {
  3.827002178911924*^9, 3.827002181516478*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"7b270728-7b0f-4e47-a8cd-76f128e8ee9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeEatNVar", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "layerDefns", ",", "layerName", ",", "layerNames", ",", "layerConn"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerNames", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerDefns", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Prey", "-", "prey"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iPrey", "]"}], "<>", 
       RowBox[{"ToString", "[", "iPrey", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeEatNVarPreyPrey", "[", 
       RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Hunter", "-", "hunter"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iHunter", "]"}], "<>", 
       RowBox[{"ToString", "[", "iHunter", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeEatNVarHunterHunter", "[", 
       RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Hunter", "-", "prey"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iHunter", "]"}], "<>", 
       RowBox[{"ToString", "[", "iPrey", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeEatNVarHunterPrey", "[", 
       RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Loop", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"iPrey", "!=", "jSp"}], "&&", 
           RowBox[{"iHunter", "!=", "jSp"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"layerName", "=", 
            RowBox[{"\"\<d\>\"", "<>", 
             RowBox[{"ToString", "[", "jSp", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
            RowBox[{"makeEatNVarLoop", "[", 
             RowBox[{
             "nv", ",", "nh", ",", "iHunter", ",", "iPrey", ",", "jSp"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"layerNames", ",", "layerName"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Sum", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "\"\<tot\>\"", "]"}], "=", 
      RowBox[{"TotalLayer", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"layerNames", "\[Rule]", 
        RowBox[{"\"\<tot\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<nvarTE\>\"", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<nvar\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nv", "+", "nh"}], ",", 
           RowBox[{"nv", "+", "nh"}]}], "}"}]}], ",", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"nv", "+", "nh"}]}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805291720524*^9, 3.825805407965281*^9}, {
  3.825805540746076*^9, 3.825805707498351*^9}, {3.825805739741499*^9, 
  3.825805761943439*^9}, {3.8258057976722927`*^9, 3.825805820457033*^9}, {
  3.825805963998415*^9, 3.825805971688965*^9}, {3.825872638970333*^9, 
  3.8258728575302687`*^9}, {3.8258737831488657`*^9, 3.8258738408870068`*^9}, {
  3.825873887087625*^9, 3.825873889056589*^9}, {3.825874182704708*^9, 
  3.825874189649164*^9}, {3.828034514209214*^9, 3.828034515338325*^9}, {
  3.8280345518889093`*^9, 3.828034552093834*^9}, {3.8280349280216084`*^9, 
  3.8280349667646103`*^9}, {3.828748430585986*^9, 3.8287484381574173`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"a7baa09f-8f69-4c0e-aad2-0ca9115dcc53"]
}, Closed]],

Cell[CellGroupData[{

Cell["Eat Ann rxn", "Title",
 CellChangeTimes->{{3.825788578505666*^9, 3.8257885793493547`*^9}, {
  3.82580590655658*^9, 3.825805910986578*^9}, {3.825869481768215*^9, 
  3.82586948215512*^9}, {3.828748493963683*^9, 
  3.828748496764826*^9}},ExpressionUUID->"e5e7ae61-4c60-4e81-a713-\
91147b288f8f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeAnnMeans", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<prey\>\"", "->", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], "*", 
             RowBox[{"UnitVector", "[", 
              RowBox[{
               RowBox[{"nv", "+", "nh"}], ",", "iPrey"}], "]"}]}], "&"}], ",", 
           RowBox[{"\"\<nvar\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", 
              RowBox[{"nv", "+", "nh"}]}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<total\>\"", "\[Rule]", 
         RowBox[{"TotalLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<prey\>\"", "\[Rule]", 
        RowBox[{"\"\<total\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825797322118442*^9, 3.825797400266646*^9}, {
  3.825805793912661*^9, 3.8258058237500896`*^9}, {3.825805913517797*^9, 
  3.825805914780362*^9}, {3.82580623951912*^9, 3.8258062633444347`*^9}, {
  3.825869483941722*^9, 3.8258695451603737`*^9}, {3.825869646462834*^9, 
  3.825869704163336*^9}, {3.825869747381749*^9, 3.825869752449211*^9}, {
  3.828034259827834*^9, 3.8280344580292063`*^9}, {3.828034568698372*^9, 
  3.8280345716229486`*^9}, {3.828034875624341*^9, 3.828034909863081*^9}, {
  3.828748373916239*^9, 3.828748378561709*^9}, {3.82874850127489*^9, 
  3.828748502515123*^9}, {3.828748534332493*^9, 3.8287485383931026`*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"8b6655f6-1a47-4b6e-ba20-ced19af09950"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeNMoment3", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "i_", ",", "j_", ",", "k_"}], "]"}], ":=", 
  
  RowBox[{"FunctionLayer", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"-", "2.0"}], "*", 
       RowBox[{"#mu", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"#mu", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "*", 
       RowBox[{"#mu", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"#mu", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"#nvar", "[", 
        RowBox[{"[", 
         RowBox[{"j", ",", "k"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"#mu", "[", 
        RowBox[{"[", "j", "]"}], "]"}], "*", 
       RowBox[{"#nvar", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "k"}], "]"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"#mu", "[", 
        RowBox[{"[", "k", "]"}], "]"}], "*", 
       RowBox[{"#nvar", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}]}]}], "&"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"\"\<mu\>\"", "\[Rule]", 
     RowBox[{"nv", "+", "nh"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"\"\<nvar\>\"", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nv", "+", "nh"}], ",", 
       RowBox[{"nv", "+", "nh"}]}], "}"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258717005482693`*^9, 3.825871833366984*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"1304759c-7001-40c6-b130-22a466fa0147"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeAnnNVarPreyPrey", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMat", "[", 
          RowBox[{"nv", ",", "nh", ",", "iPrey", ",", "iPrey"}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{
          "nv", ",", "nh", ",", "iPrey", ",", "iPrey", ",", "iHunter"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2.0"}], "*", "#n3"}], "+", 
              RowBox[{"#nvar", "[", 
               RowBox[{"[", 
                RowBox[{"iHunter", ",", "iPrey"}], "]"}], "]"}]}], ")"}]}], 
           "&"}], "]"}]}]}], "\[IndentingNewLine]", "|>"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258718688809843`*^9, 3.825871871956662*^9}, {
  3.8258719294305067`*^9, 3.825872128393684*^9}, {3.8258721587200117`*^9, 
  3.825872172380719*^9}, {3.8270021666717987`*^9, 3.827002167538167*^9}, {
  3.8287485634766483`*^9, 3.8287485666842327`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"8a903149-4642-40b2-9434-d3bf7b87cd2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeAnnNVarHunterPrey", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<n3hhp\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{
          "nv", ",", "nh", ",", "iHunter", ",", "iHunter", ",", "iPrey"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"#unitMat", "*", 
            RowBox[{"(", 
             RowBox[{"-", "#n3hhp"}], ")"}]}], "&"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMat\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMat\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3hhp\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3hhp\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258718688809843`*^9, 3.825871871956662*^9}, {
  3.8258719294305067`*^9, 3.825872128393684*^9}, {3.8258721587200117`*^9, 
  3.825872172380719*^9}, {3.825872204702159*^9, 3.825872329376462*^9}, {
  3.8258723717230263`*^9, 3.825872374215766*^9}, {3.8270021739641438`*^9, 
  3.8270021745238743`*^9}, {3.828748608943256*^9, 3.8287486308955307`*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"f7d6240f-3a77-4ecc-80ea-a2c49f7954c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeAnnNVarLoop", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_", ",", "jSp_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMatPrey\>\"", "\[Rule]", 
         RowBox[{"makeUnitMatSymm", "[", 
          RowBox[{"nv", ",", "nh", ",", "iPrey", ",", "jSp"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"makeNMoment3", "[", 
          RowBox[{"nv", ",", "nh", ",", "jSp", ",", "iPrey", ",", "iHunter"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<mult\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "#unitMatPrey"}], "*", "#n3"}], "&"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<unitMatPrey\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<unitMatPrey\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<n3\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<mult\>\"", ",", "\"\<n3\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258718688809843`*^9, 3.825871871956662*^9}, {
  3.8258719294305067`*^9, 3.825872128393684*^9}, {3.8258721587200117`*^9, 
  3.825872172380719*^9}, {3.825872204702159*^9, 3.825872329376462*^9}, {
  3.8258723717230263`*^9, 3.825872374215766*^9}, {3.825872446784706*^9, 
  3.825872594157295*^9}, {3.8258733857064734`*^9, 3.8258733876952257`*^9}, {
  3.827002178911924*^9, 3.827002181516478*^9}, {3.828748643854465*^9, 
  3.828748644685194*^9}, {3.828748706412434*^9, 3.82874871434927*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"06e79e30-f493-4d30-acee-2b19f2a34670"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeAnnNVar", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "iHunter_", ",", "iPrey_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "layerDefns", ",", "layerName", ",", "layerNames", ",", "layerConn"}], 
     "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerNames", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerDefns", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Prey", "-", "prey"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iPrey", "]"}], "<>", 
       RowBox[{"ToString", "[", "iPrey", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeAnnNVarPreyPrey", "[", 
       RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Hunter", "-", "prey"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"layerName", "=", 
      RowBox[{"\"\<m\>\"", "<>", 
       RowBox[{"ToString", "[", "iHunter", "]"}], "<>", 
       RowBox[{"ToString", "[", "iPrey", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
      RowBox[{"makeAnnNVarHunterPrey", "[", 
       RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"layerNames", ",", "layerName"}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Loop", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"iPrey", "!=", "jSp"}], "&&", 
           RowBox[{"iHunter", "!=", "jSp"}]}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"layerName", "=", 
            RowBox[{"\"\<d\>\"", "<>", 
             RowBox[{"ToString", "[", "jSp", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"layerDefns", "[", "layerName", "]"}], "=", 
            RowBox[{"makeAnnNVarLoop", "[", 
             RowBox[{
             "nv", ",", "nh", ",", "iHunter", ",", "iPrey", ",", "jSp"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"layerNames", ",", "layerName"}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"jSp", ",", 
         RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Sum", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"layerDefns", "[", "\"\<tot\>\"", "]"}], "=", 
      RowBox[{"TotalLayer", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"layerNames", "\[Rule]", 
        RowBox[{"\"\<tot\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<nvarTE\>\"", "]"}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<nvar\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nv", "+", "nh"}], ",", 
           RowBox[{"nv", "+", "nh"}]}], "}"}]}], ",", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"nv", "+", "nh"}]}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825805291720524*^9, 3.825805407965281*^9}, {
  3.825805540746076*^9, 3.825805707498351*^9}, {3.825805739741499*^9, 
  3.825805761943439*^9}, {3.8258057976722927`*^9, 3.825805820457033*^9}, {
  3.825805963998415*^9, 3.825805971688965*^9}, {3.825872638970333*^9, 
  3.8258728575302687`*^9}, {3.8258737831488657`*^9, 3.8258738408870068`*^9}, {
  3.825873887087625*^9, 3.825873889056589*^9}, {3.825874182704708*^9, 
  3.825874189649164*^9}, {3.828034514209214*^9, 3.828034515338325*^9}, {
  3.8280345518889093`*^9, 3.828034552093834*^9}, {3.8280349280216084`*^9, 
  3.8280349667646103`*^9}, {3.828748430585986*^9, 3.8287484381574173`*^9}, {
  3.828748717322953*^9, 3.8287487318069067`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"fb8a877a-16aa-4c23-9514-5f9f0826f593"]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert NMomentsTE to MomentsTE", "Title",
 CellChangeTimes->{{3.825874426178727*^9, 
  3.8258744349291677`*^9}},ExpressionUUID->"178faf1c-0ac2-49a8-94b0-\
14611eacc4dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertNMomentsTEtoMomentsTE", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<reshapeMu\>\"", "\[Rule]", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<reshapeMuTE\>\"", "\[Rule]", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<negkpv\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"#muTE", ".", 
               RowBox[{"Transpose", "[", "#mu", "]"}]}]}], "-", 
             RowBox[{"#mu", ".", 
              RowBox[{"Transpose", "[", "#muTE", "]"}]}]}], "&"}], ",", 
           RowBox[{"\"\<mu\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}]}], ",", 
           RowBox[{"\"\<muTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"nv", "+", "nh"}], ",", "1"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varTE\>\"", "\[Rule]", 
         RowBox[{"TotalLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<mu\>\"", "]"}], "->", 
         RowBox[{"\"\<reshapeMu\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<negkpv\>\"", ",", "\"\<mu\>\""}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}], "->", 
         RowBox[{"\"\<reshapeMuTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<negkpv\>\"", ",", "\"\<muTE\>\""}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"NetPort", "[", "\"\<nvarTE\>\"", "]"}], ",", 
           "\"\<negkpv\>\""}], "}"}], "->", 
         RowBox[{"\"\<varTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", "\"\<varTE\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<muTEout\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<muTE\>\"", "\[Rule]", 
         RowBox[{"nv", "+", "nh"}]}], ",", 
        RowBox[{"\"\<mu\>\"", "\[Rule]", 
         RowBox[{"nv", "+", "nh"}]}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825874436358872*^9, 3.825874460536234*^9}, {
  3.8258744928261347`*^9, 3.8258746723175783`*^9}, {3.825874776474001*^9, 
  3.825874786494669*^9}, {3.825882136384387*^9, 3.825882136803739*^9}, {
  3.825882208118986*^9, 3.8258822103778553`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"7c1402f3-a929-47a5-b264-de2597d7b25a"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.825874684553235*^9, 
  3.825874684960331*^9}},ExpressionUUID->"f03fc260-7b30-4aa6-b4aa-\
714b38677994"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convertNMomentsTEtoMomentsTE", "[", 
   RowBox[{"moments_", ",", "rxnNMomentsTE_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rxnMomentsTE", ",", "kpv"}], "}"}], "\[IndentingNewLine]", ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rxnMomentsTE", "=", 
      RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rxnMomentsTE", "[", "\"\<muTE\>\"", "]"}], "=", 
      RowBox[{"rxnNMomentsTE", "[", "\"\<muTE\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"kpv", "=", 
      RowBox[{
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"rxnNMomentsTE", "[", "\"\<muTE\>\"", "]"}], ",", 
         RowBox[{"moments", "[", "\"\<mu\>\"", "]"}]}], "]"}], "+", 
       RowBox[{"KroneckerProduct", "[", 
        RowBox[{
         RowBox[{"moments", "[", "\"\<mu\>\"", "]"}], ",", 
         RowBox[{"rxnNMomentsTE", "[", "\"\<muTE\>\"", "]"}]}], "]"}]}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"rxnMomentsTE", "[", "\"\<varTE\>\"", "]"}], "=", 
      RowBox[{
       RowBox[{"rxnNMomentsTE", "[", "\"\<nvarTE\>\"", "]"}], "-", "kpv"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "rxnMomentsTE", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[39]:=",ExpressionUUID->"ccc9551b-6206-4375-932c-2a216f895d4b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"moments", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{"\"\<mu\>\"", "\[Rule]", 
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"nv", "+", "nh"}]}], "]"}]}], "\[IndentingNewLine]", "|>"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nv", "+", "nh"}], ",", 
       RowBox[{"nv", "+", "nh"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnNMomentsTE", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<muTE\>\"", "->", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"nv", "+", "nh"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<nvarTE\>\"", "\[Rule]", 
      RowBox[{"x", "+", 
       RowBox[{"Transpose", "[", "x", "]"}]}]}]}], "\[IndentingNewLine]", 
    "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"momentsTEtrue", "=", 
  RowBox[{"convertNMomentsTEtoMomentsTE", "[", 
   RowBox[{"moments", ",", "rxnNMomentsTE"}], "]"}]}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"momentsTEtest", "=", 
   RowBox[{
    RowBox[{"makeConvertNMomentsTEtoMomentsTE", "[", 
     RowBox[{"nv", ",", "nh"}], "]"}], "[", 
    RowBox[{"Join", "[", 
     RowBox[{"moments", ",", "rxnNMomentsTE"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Values", "[", "momentsTEtrue", "]"}], "]"}], "-", 
     RowBox[{"Flatten", "[", 
      RowBox[{"Values", "[", "momentsTEtest", "]"}], "]"}]}], "]"}], "]"}], 
  "<", 
  SuperscriptBox["10", 
   RowBox[{"-", "5"}]]}]}], "Input",
 CellChangeTimes->{{3.825874699589093*^9, 3.825874754371224*^9}, {
  3.825874797397565*^9, 3.8258748416577997`*^9}},
 CellLabel->
  "In[455]:=",ExpressionUUID->"e9489f8e-0ae2-4956-a070-ea18e701ccd9"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"muTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.01713370128309455`", ",", 
      RowBox[{"-", "0.8616698091126955`"}], ",", 
      RowBox[{"-", "0.2205348067010542`"}], ",", 
      RowBox[{"-", "0.1648391762553021`"}], ",", "0.08889359087001303`"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"varTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "1.1288899451372132`", ",", "0.9808366381412088`", ",", 
        "0.8904312650970002`", ",", "0.8559146693289202`", ",", 
        "0.7415009724727943`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.9808366381412088`", ",", 
        RowBox[{"-", "1.6845210784830609`"}], ",", 
        RowBox[{"-", "0.2707108619225039`"}], ",", "0.7404506168706504`", ",",
         "1.0851382019602516`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.8904312650970002`", ",", 
        RowBox[{"-", "0.2707108619225039`"}], ",", 
        RowBox[{"-", "0.15952113218898714`"}], ",", "1.2237009920762056`", 
        ",", 
        RowBox[{"-", "0.6271370638691738`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.8559146693289202`", ",", "0.7404506168706504`", ",", 
        "1.2237009920762056`", ",", "1.8569584194799131`", ",", 
        RowBox[{"-", "0.059295248282498214`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.7415009724727943`", ",", "1.0851382019602516`", ",", 
        RowBox[{"-", "0.6271370638691738`"}], ",", 
        RowBox[{"-", "0.059295248282498214`"}], ",", 
        RowBox[{"-", "1.612609065683515`"}]}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.825874754632194*^9, {3.8258747890021267`*^9, 3.825874810539715*^9}, 
   3.8258748419622307`*^9, 3.8273562192971087`*^9},
 CellLabel->
  "Out[458]=",ExpressionUUID->"bdcac369-ba13-45ae-918f-350bb81fa676"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"muTEout\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0.017133701592683792`", ",", 
      RowBox[{"-", "0.8616698384284973`"}], ",", 
      RowBox[{"-", "0.2205348014831543`"}], ",", 
      RowBox[{"-", "0.16483917832374573`"}], ",", "0.0888935923576355`"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"varTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "1.1288899183273315`", ",", "0.9808366298675537`", ",", 
        "0.89043128490448`", ",", "0.8559147119522095`", ",", 
        "0.741500973701477`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.9808366298675537`", ",", 
        RowBox[{"-", "1.6845210790634155`"}], ",", 
        RowBox[{"-", "0.27071088552474976`"}], ",", "0.7404506206512451`", 
        ",", "1.085138201713562`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.89043128490448`", ",", 
        RowBox[{"-", "0.27071088552474976`"}], ",", 
        RowBox[{"-", "0.15952113270759583`"}], ",", "1.223701000213623`", ",", 
        RowBox[{"-", "0.6271370649337769`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.8559147119522095`", ",", "0.7404506206512451`", ",", 
        "1.223701000213623`", ",", "1.8569583892822266`", ",", 
        RowBox[{"-", "0.05929524451494217`"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.741500973701477`", ",", "1.085138201713562`", ",", 
        RowBox[{"-", "0.6271370649337769`"}], ",", 
        RowBox[{"-", "0.05929524451494217`"}], ",", 
        RowBox[{"-", "1.6126091480255127`"}]}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{
  3.825874754632194*^9, {3.8258747890021267`*^9, 3.825874810539715*^9}, 
   3.8258748419622307`*^9, 3.827356219495769*^9},
 CellLabel->
  "Out[459]=",ExpressionUUID->"aceeec20-31dc-4e5e-a0b8-ae03c1ddbf70"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.825874754632194*^9, {3.8258747890021267`*^9, 3.825874810539715*^9}, 
   3.8258748419622307`*^9, 3.827356219498003*^9},
 CellLabel->
  "Out[460]=",ExpressionUUID->"42f4ebec-c252-478f-8166-948a0d33ff0c"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert MomentsTE to ParamMomentsTE", "Title",
 CellChangeTimes->{{3.825875081467132*^9, 
  3.8258750927691927`*^9}},ExpressionUUID->"e25058ae-c753-4a1b-9594-\
796ef13b9b97"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertMomentsTEtoParamMomentsTE", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "name", ",", "layerConn"}], "}"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<muvTE\>\"", "\[Rule]", 
         RowBox[{"PartLayer", "[", 
          RowBox[{"1", ";;", "nv"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<muhTE\>\"", "\[Rule]", 
         RowBox[{"PartLayer", "[", 
          RowBox[{
           RowBox[{"nv", "+", "1"}], ";;"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varvhTE\>\"", "\[Rule]", 
         RowBox[{"PartLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"nv", "+", "1"}], ";;"}], ",", 
            RowBox[{";;", "nv"}]}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varvbarTEpart\>\"", "\[Rule]", 
         RowBox[{"PartLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{";;", "nv"}], ",", 
            RowBox[{";;", "nv"}]}], "}"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varvbarTEdiagsum\>\"", "->", 
         RowBox[{"makeSumDiagonal", "[", "nv", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varhTE\>\"", "\[Rule]", 
         RowBox[{"PartLayer", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"nv", "+", "1"}], ";;"}], ",", 
            RowBox[{
             RowBox[{"nv", "+", "1"}], ";;"}]}], "}"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<muvTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", "\"\<muvTE\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<muhTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", "\"\<muhTE\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<varvhTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", "\"\<varvhTE\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<varhTE\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", "\"\<varhTE\>\"", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"\"\<varvbarTEpart\>\"", "->", 
          RowBox[{"\"\<varvbarTEdiagsum\>\"", "\[Rule]", 
           RowBox[{"NetPort", "[", "\"\<varvbarTE\>\"", "]"}]}]}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn", ",", 
        RowBox[{"\"\<varTE\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"nv", "+", "nh"}], ",", 
           RowBox[{"nv", "+", "nh"}]}], "}"}]}], ",", 
        RowBox[{"\"\<muvTE\>\"", "\[Rule]", "nv"}], ",", 
        RowBox[{"\"\<muhTE\>\"", "\[Rule]", "nh"}], ",", 
        RowBox[{"\"\<varvbarTE\>\"", "\[Rule]", "\"\<Real\>\""}], ",", 
        RowBox[{"\"\<muTE\>\"", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"nv", "+", "nh"}], ")"}]}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258750932569532`*^9, 3.825875226498475*^9}, {
  3.82587530438533*^9, 3.825875472106812*^9}, {3.825875504285183*^9, 
  3.8258755641201*^9}, {3.825881448716752*^9, 3.825881503625291*^9}, {
  3.827356264137909*^9, 3.827356320177511*^9}, {3.827356353913168*^9, 
  3.82735636288636*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"14a8915c-e374-4633-88f8-32f1ae650868"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8273562347452602`*^9, 
  3.82735623502745*^9}},ExpressionUUID->"16363a14-7208-4304-90b3-\
3dd4e0854e8d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nvTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhTest", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeConvertMomentsTEtoParamMomentsTE", "[", 
   RowBox[{"nvTest", ",", "nhTest"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8258754482803173`*^9, 3.825875459771105*^9}, {
   3.827356235930868*^9, 3.827356243251952*^9}, 
   3.8307985751878347`*^9},ExpressionUUID->"f4475bfb-7978-45cb-b142-\
8af779061fb9"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nvTest", ",", "nhTest"}], "]"}]], "Input",
 CellLabel->
  "In[1243]:=",ExpressionUUID->"dfa9f61b-a8ce-452f-8ffa-b7b84bd66ec0"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert ParamMomentsTE to ParamsTE", "Title",
 CellChangeTimes->{{3.8258755910703506`*^9, 
  3.825875597279234*^9}},ExpressionUUID->"31199eb2-30b4-4f5f-b57e-\
7408ae0ae079"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeSumDiagonal", "[", "n_", "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<diag\>\"", "->", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{"Flatten", "[", 
            RowBox[{"#", "*", 
             RowBox[{"IdentityMatrix", "[", "n", "]"}]}], "]"}], "&"}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<tot\>\"", "\[Rule]", 
         RowBox[{"SummationLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", 
       RowBox[{"\"\<diag\>\"", "\[Rule]", "\"\<tot\>\""}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825881142260428*^9, 3.825881223668807*^9}, {
  3.825881340520232*^9, 3.825881394784629*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"f6e3113f-af9b-4d05-9b6a-e7175168b9d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertParamMomentsTEtoParamsTE", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<bTE\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#muvTE", "-", 
             RowBox[{
              RowBox[{"Transpose", "[", "#varvhTE", "]"}], ".", "#varhInv", 
              ".", "#muh"}], "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "#varvh", "]"}], ".", "#varhInv", ".",
               "#varhTE", ".", "#varhInv", ".", "#muh"}], "-", 
             RowBox[{
              RowBox[{"Transpose", "[", "#varvh", "]"}], ".", "#varhInv", ".",
               "#muhTE"}]}], "&"}], ",", 
           RowBox[{"\"\<muvTE\>\"", "\[Rule]", "nv"}], ",", 
           RowBox[{"\"\<varvhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<muh\>\"", "\[Rule]", "nh"}], ",", 
           RowBox[{"\"\<varvh\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<muhTE\>\"", "\[Rule]", "nh"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<wtTE\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{
              "#varhInv", ".", "#varhTE", ".", "#varhInv", ".", "#varvh"}]}], 
             "+", 
             RowBox[{"#varhInv", ".", "#varvhTE"}]}], "&"}], ",", 
           RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<varhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<varvh\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varvhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2TEmat\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Transpose", "[", "#varvhTE", "]"}], ".", "#varhInv", 
              ".", "#varvh"}], "-", 
             RowBox[{
              RowBox[{"Transpose", "[", "#varvh", "]"}], ".", "#varhInv", ".",
               "#varhTE", ".", "#varhInv", ".", "#varvh"}], "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "#varvh", "]"}], ".", "#varhInv", ".",
               "#varvhTE"}]}], "&"}], ",", 
           RowBox[{"\"\<varvhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<varvh\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varhTE\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2TEsumdiag\>\"", "\[Rule]", 
         RowBox[{"makeSumDiagonal", "[", "nv", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2TE\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"#varvbarTE", "/", "nv"}], "-", 
             RowBox[{"#sig2TEsumdiag", "/", "nv"}]}], "&"}], ",", 
           RowBox[{"\"\<varvbarTE\>\"", "\[Rule]", "\"\<Real\>\""}], ",", 
           RowBox[{"\"\<Output\>\"", "\[Rule]", "\"\<Real\>\""}]}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
         RowBox[{"inverseDiagMatLayer", "[", "nh", "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muhTE\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<muhTE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varhTE\>\"", "]"}], "->", 
         RowBox[{"NetPort", "[", "\"\<varhTE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2TEmat\>\"", "->", 
         RowBox[{"\"\<sig2TEsumdiag\>\"", "\[Rule]", 
          RowBox[{"NetPort", "[", 
           RowBox[{"\"\<sig2TE\>\"", ",", "\"\<sig2TEsumdiag\>\""}], 
           "]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2TE\>\"", "->", 
         RowBox[{"NetPort", "[", "\"\<sig2TE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<bTE\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<bTE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<wtTE\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<wtTE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<bTE\>\"", ",", "\"\<varhInv\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<wtTE\>\"", ",", "\"\<varhInv\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varhInv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<sig2TEmat\>\"", ",", "\"\<varhInv\>\""}], "]"}]}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh\>\"", "]"}], "->", 
         "\"\<varhInv\>\""}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825875598347383*^9, 3.825875619678629*^9}, {
  3.825880835777158*^9, 3.825881093362678*^9}, {3.825881541104669*^9, 
  3.825881852933859*^9}, {3.826984928621286*^9, 3.826984928718713*^9}, {
  3.827002252772292*^9, 3.827002265935792*^9}, {3.827002387659704*^9, 
  3.827002395130669*^9}, {3.8273564225170393`*^9, 3.827356492276209*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"7cf64145-d658-4858-a529-49c39d07fdd8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertParamMomentsTEtoParamsTE", "[", 
   RowBox[{"nv", ",", "nh"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.82588100602553*^9, 3.825881013455667*^9}, 
   3.830798580249729*^9},ExpressionUUID->"d9fcec03-07db-46a2-a77a-\
3eb675b7290d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert ParamsTE to Params0TE", "Title",
 CellChangeTimes->{{3.826031392296721*^9, 
  3.826031399459671*^9}},ExpressionUUID->"bb547e74-d166-4564-93f4-\
e6628f3a91dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertParamsTEtoParams0TE", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<b2TE\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#fb1", "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "#fwt1", "]"}], ".", "#muh1"}], "+", 
             RowBox[{
              RowBox[{"Transpose", "[", "#wt1", "]"}], ".", "#fmuh1"}]}], 
            "&"}], ",", 
           RowBox[{"\"\<fb1\>\"", "\[Rule]", "nv"}], ",", 
           RowBox[{"\"\<fwt1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<muh1\>\"", "\[Rule]", "nh"}], ",", 
           RowBox[{"\"\<wt1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<fmuh1\>\"", "\[Rule]", "nh"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<wt2TE\>\"", "\[Rule]", 
         RowBox[{"FunctionLayer", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"0.5", "*", 
              RowBox[{
               RowBox[{"Sqrt", "[", "#varh1Inv", "]"}], ".", "#fvarh1", ".", 
               "#wt1"}]}], "+", 
             RowBox[{
              RowBox[{"Sqrt", "[", "#varh1", "]"}], ".", "#fwt1"}]}], "&"}], 
           ",", 
           RowBox[{"\"\<varh1Inv\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<fvarh1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<wt1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}], ",", 
           RowBox[{"\"\<varh1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nh"}], "}"}]}], ",", 
           RowBox[{"\"\<fwt1\>\"", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"nh", ",", "nv"}], "}"}]}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<varh1Inv\>\"", "\[Rule]", 
         RowBox[{"inverseDiagMatLayer", "[", "nh", "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh1\>\"", "]"}], "\[Rule]", 
         "\"\<varh1Inv\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<varh1Inv\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<wt2TE\>\"", ",", "\"\<varh1Inv\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<b2TE\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<b2TE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<wt2TE\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<wt2TE\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.826031408895294*^9, 3.826031411580204*^9}, 
   3.826031612213122*^9, {3.8260316987798843`*^9, 3.8260318173748837`*^9}, {
   3.826031852890449*^9, 3.8260318672296762`*^9}, {3.826031930583096*^9, 
   3.826032012819419*^9}, {3.826032049907668*^9, 3.8260320812187147`*^9}, {
   3.82603214059099*^9, 3.826032142046898*^9}, {3.826032175304772*^9, 
   3.826032249575116*^9}, {3.8260325825669813`*^9, 3.8260325831830273`*^9}, {
   3.826984933177183*^9, 3.826984933262569*^9}, {3.827002277253594*^9, 
   3.82700228844985*^9}, {3.8270024034885597`*^9, 3.8270024118725367`*^9}, {
   3.8273565041597357`*^9, 3.827356514519706*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"5841f285-3080-4ef1-8e11-652fe0a21fb4"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.826032354125846*^9, 
  3.826032354489985*^9}},ExpressionUUID->"8dccf02d-0f17-4355-9331-\
8d93182f1320"],

Cell[BoxData[
 RowBox[{
  RowBox[{"convertParamsTELatentSpace", "[", 
   RowBox[{
   "params1_", ",", "params1TE_", ",", "muh2_", ",", "varh2_", ",", "fmuh2_", 
    ",", "fvarh2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fb1", ",", "fwt1", ",", "fmuh1", ",", "fvarh1", ",", "fb2", ",", "muh1",
       ",", "wt1", ",", "varh1", ",", "fwt2"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"fb1", "=", 
      RowBox[{"params1TE", "[", "\"\<fb\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fwt1", "=", 
      RowBox[{"params1TE", "[", "\"\<fwt\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fmuh1", "=", 
      RowBox[{"params1TE", "[", "\"\<fmuh\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fvarh1", "=", 
      RowBox[{"params1TE", "[", "\"\<fvarh\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"muh1", "=", 
      RowBox[{"params1", "[", "\"\<muh\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wt1", "=", 
      RowBox[{"params1", "[", "\"\<wt\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"varh1", "=", 
      RowBox[{"params1", "[", "\"\<varh\>\"", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fb2", "=", 
      RowBox[{"fb1", "+", 
       RowBox[{
        RowBox[{"Transpose", "[", "fwt1", "]"}], ".", "muh1"}], "+", 
       RowBox[{
        RowBox[{"Transpose", "[", "wt1", "]"}], ".", "fmuh1"}], "-", 
       RowBox[{
        RowBox[{"Transpose", "[", "fwt1", "]"}], ".", 
        RowBox[{"Sqrt", "[", "varh1", "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], ".", "muh2"}], "-", 
       RowBox[{"0.5", "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "wt1", "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"Sqrt", "[", "varh1", "]"}], "]"}], ".", "fvarh1", ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], ".", "muh2"}]}], "+", 
       RowBox[{"0.5", "*", 
        RowBox[{
         RowBox[{"Transpose", "[", "wt1", "]"}], ".", 
         RowBox[{"Sqrt", "[", "varh1", "]"}], ".", 
         SuperscriptBox[
          RowBox[{"Inverse", "[", 
           RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], "3"], ".", "fvarh2", 
         ".", "muh2"}]}], "-", 
       RowBox[{
        RowBox[{"Transpose", "[", "wt1", "]"}], ".", 
        RowBox[{"Sqrt", "[", "varh1", "]"}], ".", 
        RowBox[{"Inverse", "[", 
         RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], ".", "fmuh2"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"fwt2", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.5"}], "*", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Inverse", "[", 
           RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], "3"], ".", "fvarh2", 
         ".", 
         RowBox[{"Sqrt", "[", "varh1", "]"}], ".", "wt1"}]}], "+", 
       RowBox[{"0.5", "*", 
        RowBox[{
         RowBox[{"Inverse", "[", 
          RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], ".", 
         RowBox[{"Inverse", "[", 
          RowBox[{"Sqrt", "[", "varh1", "]"}], "]"}], ".", "fvarh1", ".", 
         "wt1"}]}], "+", 
       RowBox[{
        RowBox[{"Inverse", "[", 
         RowBox[{"Sqrt", "[", "varh2", "]"}], "]"}], ".", 
        RowBox[{"Sqrt", "[", "varh1", "]"}], ".", "fwt1"}]}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"makeParamsTE", "[", 
       RowBox[{"fwt2", ",", "fb2", ",", 
        RowBox[{"params1TE", "[", "\"\<fsig2\>\"", "]"}], ",", "fmuh2", ",", 
        "fvarh2"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82736215637866*^9, 3.82736215894734*^9}, {
  3.827362332917609*^9, 3.827362333464685*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"6edff6a5-6791-4af3-b9ed-d8c2d884a2a3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nvTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nhTest", "=", "2"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params1test", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<wt\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nhTest", ",", "nvTest"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<b\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "nvTest"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<muh\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "nhTest"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<varh\>\"", "\[Rule]", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1"}], "}"}], ",", "nhTest"}], "]"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<sig2\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"params1TEtest", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<fwt\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"nhTest", ",", "nvTest"}], "}"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fb\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "nvTest"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<fmuh\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "nhTest"}], "]"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<fvarh\>\"", "\[Rule]", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"RandomReal", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "nhTest"}], "]"}], 
       "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<fsig2\>\"", "\[Rule]", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muh2test", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "nhTest"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varh2test", "=", 
   RowBox[{"IdentityMatrix", "[", "nhTest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fmuh2test", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "nhTest"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fvarh2test", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"nhTest", ",", "nhTest"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valsTrue", "=", 
   RowBox[{"convertParamsTELatentSpace", "[", 
    RowBox[{
    "params1test", ",", "params1TEtest", ",", "muh2test", ",", "varh2test", 
     ",", "fmuh2test", ",", "fvarh2test"}], "]"}]}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"convertParamsTEtoParams0TE", "=", 
   RowBox[{"makeConvertParamsTEtoParams0TE", "[", 
    RowBox[{"nvTest", ",", "nhTest"}], "]"}]}], ";"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"valsTest", "=", 
   RowBox[{"convertParamsTEtoParams0TE", "[", 
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<varh1\>\"", "\[Rule]", 
       RowBox[{"params1test", "[", "\"\<varh\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<fvarh1\>\"", "\[Rule]", 
       RowBox[{"params1TEtest", "[", "\"\<fvarh\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<wt1\>\"", "\[Rule]", 
       RowBox[{"params1test", "[", "\"\<wt\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<fwt1\>\"", "\[Rule]", 
       RowBox[{"params1TEtest", "[", "\"\<fwt\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<muh1\>\"", "\[Rule]", 
       RowBox[{"params1test", "[", "\"\<muh\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<fmuh1\>\"", "\[Rule]", 
       RowBox[{"params1TEtest", "[", "\"\<fmuh\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<fb1\>\"", "\[Rule]", 
       RowBox[{"params1TEtest", "[", "\"\<fb\>\"", "]"}]}]}], 
     "\[IndentingNewLine]", "|>"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valsTrue", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"valsTrue", "[", "\"\<fwt\>\"", "]"}], ",", 
      RowBox[{"valsTrue", "[", "\"\<fb\>\"", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valsTest", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"valsTest", "[", "\"\<wt2TE\>\"", "]"}], ",", 
      RowBox[{"valsTest", "[", "\"\<b2TE\>\"", "]"}]}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Max", "[", 
   RowBox[{"Abs", "[", 
    RowBox[{"valsTest", "-", "valsTrue"}], "]"}], "]"}], "<", 
  SuperscriptBox["10", 
   RowBox[{"-", "6"}]]}]}], "Input",
 CellChangeTimes->{
  3.827362052819212*^9, {3.8273621800013103`*^9, 3.827362209915407*^9}, {
   3.827362301078045*^9, 3.827362350799667*^9}, {3.827364867632277*^9, 
   3.827364890810457*^9}},
 CellLabel->
  "In[1245]:=",ExpressionUUID->"32aa8ae1-8c41-40ac-b178-ad7ff84661b5"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"fwt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.4164633030334524`"}], ",", 
        RowBox[{"-", "0.3590590417496743`"}], ",", "0.6034404375343578`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.1278659199618806`"}], ",", "0.43779328943860696`", 
        ",", 
        RowBox[{"-", "0.32405672054646356`"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"fb\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.0565210477277454`"}], ",", 
      RowBox[{"-", "0.6954798348380484`"}], ",", "0.35056879714746103`"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"fsig2\"\>", "\[Rule]", "0.20524224781916534`"}], ",", 
   RowBox[{"\<\"fmuh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ",", 
   RowBox[{"\<\"fvarh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.827362351089827*^9, 3.8273648928867207`*^9},
 CellLabel->
  "Out[1253]=",ExpressionUUID->"985f7af6-7721-449a-b3f6-58f4b59e8583"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"b2TE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "1.0565210580825806`"}], ",", 
      RowBox[{"-", "0.6954798698425293`"}], ",", "0.3505687713623047`"}], 
     "}"}]}], ",", 
   RowBox[{"\<\"wt2TE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.41646334528923035`"}], ",", 
        RowBox[{"-", "0.35905903577804565`"}], ",", "0.6034404635429382`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1.1278659105300903`"}], ",", "0.4377932846546173`", ",", 
        RowBox[{"-", "0.3240567147731781`"}]}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.827362351089827*^9, 3.827364893196883*^9},
 CellLabel->
  "Out[1255]=",ExpressionUUID->"6696e7fc-0b7b-4e89-83ff-b8a0d224d168"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.827362351089827*^9, 3.827364893199581*^9},
 CellLabel->
  "Out[1258]=",ExpressionUUID->"f941614d-6464-4f2b-8594-aa13064dd2f5"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "nhTest", ",", "nvTest", ",", "params1TEtest", ",", "muh2test", ",", 
   "params1test", ",", "varh2test", ",", "fmuh2test", ",", "fvarh2test", ",", 
   "valsTrue", ",", "valsTest"}], "]"}]], "Input",
 CellChangeTimes->{{3.8273648937180643`*^9, 3.827364931150354*^9}},
 CellLabel->
  "In[1261]:=",ExpressionUUID->"d612051a-c0dd-4807-ba4b-b9b56606eb3a"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Convert NMomentsTE to ParamsTE", "Title",
 CellChangeTimes->{{3.82588190277271*^9, 3.825881908409477*^9}, {
  3.826032445149764*^9, 
  3.826032445807981*^9}},ExpressionUUID->"2b5c0ae5-9a25-49d7-bab4-\
530c7ebb452e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeConvertNMomentsTEtoParams0TE", "[", 
   RowBox[{"nv_", ",", "nh_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<convertNMomentsToMomentsTE\>\"", "->", 
         RowBox[{"makeConvertNMomentsTEtoMomentsTE", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertMomentsTEtoParamMomentsTE\>\"", "->", 
         RowBox[{"makeConvertMomentsTEtoParamMomentsTE", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertParamMomentsToParamsTE\>\"", "\[Rule]", 
         RowBox[{"makeConvertParamMomentsTEtoParamsTE", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", "->", 
         RowBox[{"makeConvertParamsTEtoParams0TE", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertNMomentsToMomentsTE\>\"", ",", "\"\<varTE\>\""}], "]"}],
          "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", "\"\<varTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertNMomentsToMomentsTE\>\"", ",", "\"\<muTEout\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", "\"\<muTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", 
           "\"\<varvhTE\>\""}], "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<varvhTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", 
           "\"\<varvbarTE\>\""}], "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<varvbarTE\>\""}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", "\"\<varhTE\>\""}],
           "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<varhTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", "\"\<muvTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<muvTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertMomentsTEtoParamMomentsTE\>\"", ",", "\"\<muhTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<muhTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<wt\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<wt1\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<varh\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<varh1\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<muh\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<muh1\>\""}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<wtTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<fwt1\>\""}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<varhTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<fvarh1\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<muhTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<fmuh1\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamMomentsToParamsTE\>\"", ",", "\"\<bTE\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<fb1\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<wt2TE\>\""}], "]"}],
          "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<wtTE\>\"", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsTEtoParams0TE\>\"", ",", "\"\<b2TE\>\""}],
           "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", "\"\<bTE\>\"", "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825881917948443*^9, 3.825882112977564*^9}, {
  3.8258821631211777`*^9, 3.825882192063698*^9}, {3.825882233007422*^9, 
  3.825882262566679*^9}, {3.8260328181922817`*^9, 3.8260328333495617`*^9}, {
  3.826032890401095*^9, 3.826033050379689*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"2f61d3be-008b-4fc5-9873-db08138b0481"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.827362368097684*^9, 
  3.827362368351617*^9}},ExpressionUUID->"74ce8ff1-fd59-4ede-ab84-\
d7ab00c5457d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nvTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhTest", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeConvertNMomentsTEtoParams0TE", "[", 
   RowBox[{"nvTest", ",", "nhTest"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.8258819961449747`*^9, 3.825882000177561*^9}, 
   3.826032846251297*^9, {3.8273649364187737`*^9, 3.827364943292513*^9}, 
   3.830798589299593*^9},ExpressionUUID->"134e6634-9a76-40f7-82e0-\
fb2f47e0da82"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nvTest", ",", "nhTest"}], "]"}]], "Input",
 CellChangeTimes->{{3.8273649443126583`*^9, 3.827364948873044*^9}},
 CellLabel->
  "In[1265]:=",ExpressionUUID->"7f22c180-d36b-43c5-a052-25141eb7c3cd"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Rxns", "Title",
 CellChangeTimes->{{3.825882774107902*^9, 
  3.825882774567284*^9}},ExpressionUUID->"75c1fcef-1813-4085-8502-\
bba2286b70fb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeRxnParams0TE", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "rxnSpec_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "layerDefns", ",", "layerConn", ",", "iHunter", ",", "iPrey", ",", 
      "iSp"}], "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<convertNMomentsTEtoParams0TE\>\"", "->", 
         RowBox[{"makeConvertNMomentsTEtoParams0TE", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<convertParamsToNMoments\>\"", "->", 
         RowBox[{"makeGraphConvertParamsToNMoments", "[", 
          RowBox[{"nv", ",", "nh"}], "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<muTE\>\"", "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertNMomentsTEtoParams0TE\>\"", ",", "\"\<muTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<nvarTE\>\"", "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertNMomentsTEtoParams0TE\>\"", ",", "\"\<nvarTE\>\""}], 
          "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<nvar\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<nvarTE\>\"", ",", "\"\<nvar\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<mu\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<nvarTE\>\"", ",", "\"\<mu\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<mu\>\""}], 
          "]"}], "->", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertNMomentsTEtoParams0TE\>\"", ",", "\"\<mu\>\""}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<varvh\>\""}], 
          "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{
          "\"\<convertNMomentsTEtoParams0TE\>\"", ",", "\"\<varvh\>\""}], 
          "]"}]}]}], "\[IndentingNewLine]", "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Reaction", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rxnSpec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<eat\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iHunter", "=", 
         RowBox[{"rxnSpec", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"iPrey", "=", 
         RowBox[{"rxnSpec", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<muTE\>\"", "]"}], "=", 
         RowBox[{"makeEatMeans", "[", 
          RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<nvarTE\>\"", "]"}], "=", 
         RowBox[{"makeEatNVar", "[", 
          RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerConn", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<nvar\>\""}], 
            "]"}], "\[Rule]", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<muTE\>\"", ",", "\"\<nvar\>\""}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rxnSpec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<ann\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iHunter", "=", 
         RowBox[{"rxnSpec", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"iPrey", "=", 
         RowBox[{"rxnSpec", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<muTE\>\"", "]"}], "=", 
         RowBox[{"makeAnnMeans", "[", 
          RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<nvarTE\>\"", "]"}], "=", 
         RowBox[{"makeAnnNVar", "[", 
          RowBox[{"nv", ",", "nh", ",", "iHunter", ",", "iPrey"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerConn", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<nvar\>\""}], 
            "]"}], "\[Rule]", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<muTE\>\"", ",", "\"\<nvar\>\""}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rxnSpec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<birth\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iSp", "=", 
         RowBox[{"rxnSpec", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<muTE\>\"", "]"}], "=", 
         RowBox[{"makeBirthMeans", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<nvarTE\>\"", "]"}], "=", 
         RowBox[{"makeBirthNVar", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerConn", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<mu\>\""}], 
            "]"}], "\[Rule]", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<muTE\>\"", ",", "\"\<mu\>\""}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rxnSpec", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<death\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iSp", "=", 
         RowBox[{"rxnSpec", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<muTE\>\"", "]"}], "=", 
         RowBox[{"makeDeathMeans", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"layerDefns", "[", "\"\<nvarTE\>\"", "]"}], "=", 
         RowBox[{"makeDeathNVar", "[", 
          RowBox[{"nv", ",", "nh", ",", "iSp"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"layerConn", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<convertParamsToNMoments\>\"", ",", "\"\<mu\>\""}], 
            "]"}], "\[Rule]", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<muTE\>\"", ",", "\"\<mu\>\""}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825882778970386*^9, 3.825882912891568*^9}, {
   3.825883208353478*^9, 3.825883226992317*^9}, {3.825883330093791*^9, 
   3.825883491215111*^9}, {3.8258835291753902`*^9, 3.8258835359165382`*^9}, {
   3.825884399395914*^9, 3.825884404861558*^9}, {3.825884630999447*^9, 
   3.8258846347893143`*^9}, {3.825884841030748*^9, 3.82588484979032*^9}, {
   3.825886253849203*^9, 3.825886447492128*^9}, {3.8258864777681704`*^9, 
   3.8258864900087433`*^9}, {3.8258865686446867`*^9, 3.825886584746963*^9}, {
   3.826033233026527*^9, 3.826033266830673*^9}, {3.826033331617299*^9, 
   3.826033331829741*^9}, 3.8260339129642277`*^9, {3.828034187605991*^9, 
   3.8280342527602882`*^9}, {3.828748283094617*^9, 3.828748295873685*^9}, {
   3.828748787359844*^9, 3.8287487966960773`*^9}},
 CellLabel->"In[84]:=",ExpressionUUID->"72575f29-5d55-4420-b812-1b2d85d139ce"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.825883832934595*^9, 
  3.82588383486835*^9}},ExpressionUUID->"f5dd0ba6-ceba-4982-8f86-\
5beaf01b3ed4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nvTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhTest", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nTest", "=", 
   RowBox[{"nvTest", "+", "nhTest"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"muTest", "=", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"100", ",", "500"}], "}"}], ",", "nTest"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varvTest", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"100", ",", "200"}], "}"}], ",", "nvTest"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varvTest", "+=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nvTest", ",", "nvTest"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varvTest", "+=", 
   RowBox[{"Transpose", "[", "varvTest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varvTest", "*=", "0.5"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varhTest", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"RandomReal", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"100", ",", "200"}], "}"}], ",", "nhTest"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varvhTest", "=", 
   RowBox[{"RandomReal", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"5", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"nvTest", ",", "nhTest"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varTest", "=", 
   RowBox[{"ArrayFlatten", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"varvTest", ",", "varvhTest"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Transpose", "[", "varvhTest", "]"}], ",", "varhTest"}], 
       "}"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"SymmetricMatrixQ", "[", "varTest", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositiveDefiniteMatrixQ", "[", "varTest", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momentsTest", "=", 
   RowBox[{
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<mu\>\"", "\[Rule]", "muTest"}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<var\>\"", "\[Rule]", "varTest"}]}], "\[IndentingNewLine]", 
     "|>"}], "//", "N"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.827362611161553*^9, 3.8273626601914587`*^9}, {
  3.827362690806387*^9, 3.827362828593943*^9}, {3.827364203752038*^9, 
  3.827364204332651*^9}},
 CellLabel->
  "In[1266]:=",ExpressionUUID->"f975c66e-37aa-4e47-abb1-e981277aa6ec"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "117.15797120663125`", ",", "8.219230027438929`", ",", 
     "7.09689093688042`", ",", "5.13681054150363`", ",", 
     "7.031836598985608`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "8.219230027438929`", ",", "186.2288225812401`", ",", 
     "5.5804408783131825`", ",", "7.28054166110174`", ",", 
     "7.315303128167244`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "7.09689093688042`", ",", "5.5804408783131825`", ",", 
     "127.90897652328545`", ",", "8.392293083166386`", ",", 
     "8.845155040236806`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5.13681054150363`", ",", "7.28054166110174`", ",", "8.392293083166386`", 
     ",", "108.93793519634659`", ",", "0.`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "7.031836598985608`", ",", "7.315303128167244`", ",", 
     "8.845155040236806`", ",", "0.`", ",", "105.81934931329589`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.827362656463777*^9, 3.8273627564888363`*^9, {3.827362804881218*^9, 
   3.827362828862934*^9}, 3.827364204823475*^9, 3.827364955594841*^9},
 CellLabel->
  "Out[1276]=",ExpressionUUID->"86ac4d25-eaf5-471e-abbd-afc68af33596"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.827362656463777*^9, 3.8273627564888363`*^9, {3.827362804881218*^9, 
   3.827362828862934*^9}, 3.827364204823475*^9, 3.827364955597699*^9},
 CellLabel->
  "Out[1277]=",ExpressionUUID->"466ac483-a7da-4535-8ba9-8d4e26d39a12"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.827362656463777*^9, 3.8273627564888363`*^9, {3.827362804881218*^9, 
   3.827362828862934*^9}, 3.827364204823475*^9, 3.82736495560069*^9},
 CellLabel->
  "Out[1278]=",ExpressionUUID->"968e57d7-ca7d-4312-a4be-ba200ab008cb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"paramsTest", "=", 
  RowBox[{"convertMomentsToParams", "[", 
   RowBox[{"momentsTest", ",", "nvTest"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momentsTest", "=", 
   RowBox[{"convertParamsToMoments", "[", "paramsTest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
   RowBox[{"momentsTest", "[", "\"\<var\>\"", "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramMomentsTest", "=", 
   RowBox[{"convertParamsToParamMoments", "[", "paramsTest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nMomentsTest", "=", 
   RowBox[{"convertParamsToNMoments", "[", "paramsTest", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nMoments3Test", "=", 
   RowBox[{"convertParamsToNMoments3", "[", "paramsTest", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.82588459315692*^9, 3.825884593815929*^9}, {
  3.825884968931785*^9, 3.825884973498159*^9}, {3.82736283478651*^9, 
  3.82736283890088*^9}, {3.8273629044347343`*^9, 3.827362904628099*^9}, {
  3.827363077096932*^9, 3.8273630781129227`*^9}, {3.8273642004545307`*^9, 
  3.827364201604114*^9}},ExpressionUUID->"13dead12-4a1e-416c-9bea-\
e56414428bd8"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"sig2\"\>", "\[Rule]", "159.48291203310595`"}], ",", 
   RowBox[{"\<\"muh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"267.6757325730691`", ",", "390.1825949549202`"}], "}"}]}], ",", 
   
   RowBox[{"\<\"varh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"105.90607155167888`", ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.`", ",", "183.05613283694768`"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"wt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "0.0566475658622389`", ",", "0.058518931528107845`", ",", 
        "0.0622336442852112`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.043118879666782454`", ",", "0.039235790856573534`", ",", 
        "0.03883033055980964`"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"b\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "180.20437515763277`", ",", "123.97345580579906`", ",", 
      "73.36458816989585`"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.825884594137239*^9, 3.8258849738188257`*^9, 
  3.826033284136819*^9, 3.826033334868601*^9, 3.827362372470128*^9, 
  3.827362839510461*^9, 3.8273629057418137`*^9, 3.827363078896131*^9},
 CellLabel->
  "Out[805]=",ExpressionUUID->"90312b00-e226-4e33-9478-05013fc69c7c"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.825884594137239*^9, 3.8258849738188257`*^9, 
  3.826033284136819*^9, 3.826033334868601*^9, 3.827362372470128*^9, 
  3.827362839510461*^9, 3.8273629057418137`*^9, 3.827363078898741*^9},
 CellLabel->
  "Out[807]=",ExpressionUUID->"031e670c-c44b-4548-b158-684bdbb6886c"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"makeParams1TEtest", "[", "rxnParamsTEtest_", "]"}], ":=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<fb\>\"", "->", 
      RowBox[{"rxnParamsTEtest", "[", "\"\<bTE\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fwt\>\"", "->", 
      RowBox[{"rxnParamsTEtest", "[", "\"\<wtTE\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fmuh\>\"", "->", 
      RowBox[{"rxnParamsTEtest", "[", "\"\<muhTE\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fvarh\>\"", "->", 
      RowBox[{"rxnParamsTEtest", "[", "\"\<varhTE\>\"", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<fsig2\>\"", "->", 
      RowBox[{"rxnParamsTEtest", "[", "\"\<sig2TE\>\"", "]"}]}]}], 
    "\[IndentingNewLine]", "|>"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8260337264935102`*^9, 3.826033740772251*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"aea80708-cd03-42bd-ba41-6f69eced8442"],

Cell[BoxData[
 RowBox[{
  RowBox[{"validateParams0TE", "[", 
   RowBox[{
   "momentsTest_", ",", "paramsTest_", ",", "paramMomentsTest_", ",", 
    "valsCheck_", ",", "rxnNMomentsTEtest_", ",", "nhTest_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "rxnMomentsTEtest", ",", "rxnParamMomentsTEtest", ",", "rxnParamsTEtest",
       ",", "params1TEtest", ",", "muh2Test", ",", "varh2Test", ",", 
      "fmuh2Test", ",", "err", ",", "fvarh2Test", ",", "valsTrue"}], "}"}], 
    "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"rxnMomentsTEtest", "=", 
      RowBox[{"convertNMomentsTEtoMomentsTE", "[", 
       RowBox[{"momentsTest", ",", "rxnNMomentsTEtest"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rxnParamMomentsTEtest", "=", 
      RowBox[{"convertMomentsTEtoParamMomentsTE", "[", 
       RowBox[{"paramsTest", ",", "rxnMomentsTEtest"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rxnParamsTEtest", "=", 
      RowBox[{"convertParamMomentsTEtoParamsTE", "[", 
       RowBox[{"paramMomentsTest", ",", "rxnParamMomentsTEtest"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"params1TEtest", "=", 
      RowBox[{"makeParams1TEtest", "[", "rxnParamsTEtest", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"muh2Test", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "nhTest"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"varh2Test", "=", 
      RowBox[{"IdentityMatrix", "[", "nhTest", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fmuh2Test", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", "nhTest"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"fvarh2Test", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"nhTest", ",", "nhTest"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"valsTrue", "=", 
      RowBox[{"convertParamsTELatentSpace", "[", 
       RowBox[{
       "paramsTest", ",", "params1TEtest", ",", "muh2Test", ",", "varh2Test", 
        ",", "fmuh2Test", ",", "fvarh2Test"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "valsTrue", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "valsCheck", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"On", "[", "Assert", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"valsCheck", "[", "\"\<sig2TE\>\"", "]"}], "-", 
          RowBox[{"valsTrue", "[", "\"\<fsig2\>\"", "]"}]}], "]"}], "]"}], 
       "<", 
       SuperscriptBox["10", "0"]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"valsCheck", "[", "\"\<wtTE\>\"", "]"}], "-", 
          RowBox[{"valsTrue", "[", "\"\<fwt\>\"", "]"}]}], "]"}], "]"}], "<", 
       
       SuperscriptBox["10", "0"]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Assert", "[", 
      RowBox[{
       RowBox[{"Max", "[", 
        RowBox[{"Abs", "[", 
         RowBox[{
          RowBox[{"valsCheck", "[", "\"\<bTE\>\"", "]"}], "-", 
          RowBox[{"valsTrue", "[", "\"\<fb\>\"", "]"}]}], "]"}], "]"}], "<", 
       SuperscriptBox["10", "0"]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Off", "[", "Assert", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "True", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.827363200664433*^9, 3.82736331582443*^9}, {
  3.8273633559627047`*^9, 3.827363357250373*^9}, {3.8273634048279057`*^9, 
  3.8273634648152237`*^9}, {3.827363496893811*^9, 3.827363601895577*^9}, {
  3.8273637306402483`*^9, 3.827363730880981*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"e3edd804-3c66-4550-8d26-6b154296d02a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeRxnParams0TE", "[", 
    RowBox[{"nvTest", ",", "nhTest", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<eat\>\"", ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"valsCheck", "=", 
   RowBox[{"lyr", "[", "paramsTest", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnNMomentsTEtest", "=", 
   RowBox[{"makeRxnEatNMomentsTE", "[", 
    RowBox[{"nMomentsTest", ",", "nMoments3Test", ",", "1", ",", "2"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"validateParams0TE", "[", 
  RowBox[{
  "momentsTest", ",", "paramsTest", ",", "paramMomentsTest", ",", "valsCheck",
    ",", "rxnNMomentsTEtest", ",", "nhTest"}], "]"}]}], "Input",
 CellChangeTimes->{{3.82588394626366*^9, 3.825884055658846*^9}, {
   3.825884316020462*^9, 3.825884317796029*^9}, {3.8258845797219067`*^9, 
   3.8258846153562717`*^9}, {3.825886514633265*^9, 3.8258865220341997`*^9}, {
   3.826033367467607*^9, 3.826033481128817*^9}, {3.826033746110404*^9, 
   3.826033755390357*^9}, 3.826033916547402*^9, {3.827362386392337*^9, 
   3.827362476856616*^9}, {3.827362842877496*^9, 3.827362872931323*^9}, {
   3.827363239675668*^9, 3.82736324812825*^9}, {3.827363298832632*^9, 
   3.827363341586725*^9}, {3.8273634683655043`*^9, 3.827363468582781*^9}},
 CellLabel->
  "In[897]:=",ExpressionUUID->"0a8e73e6-57f3-4b84-b586-5e8aab091a5f"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"sig2TE\"\>", "\[Rule]", "15833.0205078125`"}], ",", 
   RowBox[{"\<\"wtTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"218.34471130371094`", ",", 
        RowBox[{"-", "218.34471130371094`"}], ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"203.1807861328125`", ",", 
        RowBox[{"-", "203.1807861328125`"}], ",", "0.`"}], "}"}]}], "}"}]}], 
   ",", 
   RowBox[{"\<\"bTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"32879.0703125`", ",", 
      RowBox[{"-", "32879.0703125`"}], ",", "0.`"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.825883979082314*^9, 3.825884055838586*^9}, 
   3.825884318076721*^9, 3.825884411048772*^9, 3.825884619574787*^9, 
   3.825884978990459*^9, 3.825886526222816*^9, 3.825886607278985*^9, 
   3.826033289278319*^9, 3.826033339414671*^9, 3.8260334854052973`*^9, {
   3.826033753583449*^9, 3.826033760179208*^9}, 3.826033921435418*^9, 
   3.827362381412201*^9, {3.827362455250553*^9, 3.827362470107834*^9}, 
   3.827362511812272*^9, {3.827362851320828*^9, 3.827362878264805*^9}, 
   3.827363090386671*^9, {3.8273633372254343`*^9, 3.8273633467785807`*^9}, {
   3.8273634586113243`*^9, 3.827363473822755*^9}, 3.8273635094023027`*^9, {
   3.827363557319378*^9, 3.827363607125979*^9}},
 CellLabel->
  "Out[898]=",ExpressionUUID->"c1518141-77a4-4efb-b980-04280d524e5e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"fwt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"218.1149462676371`", ",", 
        RowBox[{"-", "218.1149462676371`"}], ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"203.03719268757618`", ",", 
        RowBox[{"-", "203.03719268757618`"}], ",", "0.`"}], "}"}]}], "}"}]}], 
   ",", 
   RowBox[{"\<\"fb\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"32879.07341322841`", ",", 
      RowBox[{"-", "32879.07341322841`"}], ",", "0.`"}], "}"}]}], ",", 
   RowBox[{"\<\"fsig2\"\>", "\[Rule]", "15832.970638403953`"}], ",", 
   RowBox[{"\<\"fmuh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ",", 
   RowBox[{"\<\"fvarh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{
  3.827363509405661*^9, {3.8273635573225613`*^9, 3.82736360712868*^9}},
 CellLabel->
  "During evaluation of \
In[897]:=",ExpressionUUID->"fe5128b8-4405-4ab9-85ea-b2223ae3ba8a"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"sig2TE\"\>", "\[Rule]", "15833.0205078125`"}], ",", 
   RowBox[{"\<\"wtTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"218.34471130371094`", ",", 
        RowBox[{"-", "218.34471130371094`"}], ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"203.1807861328125`", ",", 
        RowBox[{"-", "203.1807861328125`"}], ",", "0.`"}], "}"}]}], "}"}]}], 
   ",", 
   RowBox[{"\<\"bTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"32879.0703125`", ",", 
      RowBox[{"-", "32879.0703125`"}], ",", "0.`"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{
  3.827363509405661*^9, {3.8273635573225613`*^9, 3.82736360713107*^9}},
 CellLabel->
  "During evaluation of \
In[897]:=",ExpressionUUID->"84660aa3-e55d-44b2-bcbd-53bec30779e0"]
}, Open  ]],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825883979082314*^9, 3.825884055838586*^9}, 
   3.825884318076721*^9, 3.825884411048772*^9, 3.825884619574787*^9, 
   3.825884978990459*^9, 3.825886526222816*^9, 3.825886607278985*^9, 
   3.826033289278319*^9, 3.826033339414671*^9, 3.8260334854052973`*^9, {
   3.826033753583449*^9, 3.826033760179208*^9}, 3.826033921435418*^9, 
   3.827362381412201*^9, {3.827362455250553*^9, 3.827362470107834*^9}, 
   3.827362511812272*^9, {3.827362851320828*^9, 3.827362878264805*^9}, 
   3.827363090386671*^9, {3.8273633372254343`*^9, 3.8273633467785807`*^9}, {
   3.8273634586113243`*^9, 3.827363473822755*^9}, 3.8273635094023027`*^9, {
   3.827363557319378*^9, 3.827363607134527*^9}},
 CellLabel->
  "Out[900]=",ExpressionUUID->"c4e29255-561a-48c3-b7d0-abf11030203f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeRxnParams0TE", "[", 
    RowBox[{"nvTest", ",", "nhTest", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<birth\>\"", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"valsCheck", "=", 
    RowBox[{"lyr", "[", "paramsTest", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnNMomentsTEtest", "=", 
   RowBox[{"makeRxnBirthNMomentsTE", "[", 
    RowBox[{"nMomentsTest", ",", "nMoments3Test", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"validateParams0TE", "[", 
  RowBox[{
  "momentsTest", ",", "paramsTest", ",", "paramMomentsTest", ",", "valsCheck",
    ",", "rxnNMomentsTEtest", ",", "nhTest"}], "]"}]}], "Input",
 CellChangeTimes->{{3.82588394626366*^9, 3.825884055658846*^9}, {
   3.825884316020462*^9, 3.825884317796029*^9}, {3.8258845797219067`*^9, 
   3.825884624816319*^9}, {3.825884777319624*^9, 3.825884785286561*^9}, {
   3.825886532888534*^9, 3.8258865359484797`*^9}, 3.826033773795958*^9, 
   3.826033919104891*^9, {3.8273631066714373`*^9, 3.82736313614858*^9}, {
   3.8273637022125063`*^9, 3.82736372617975*^9}},
 CellLabel->
  "In[905]:=",ExpressionUUID->"7c8a5487-8e9d-4149-9cc3-07d93af22a38"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"fwt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.5829639274727756`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.583390845584656`", ",", "0.`", ",", "0.`"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"\<\"fb\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"212.19179020822287`", ",", "0.`", ",", "0.`"}], "}"}]}], ",", 
   RowBox[{"\<\"fsig2\"\>", "\[Rule]", "177.05253809147726`"}], ",", 
   RowBox[{"\<\"fmuh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ",", 
   RowBox[{"\<\"fvarh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{{3.827363711656893*^9, 3.82736372880772*^9}},
 CellLabel->
  "During evaluation of \
In[905]:=",ExpressionUUID->"b71d52df-d069-4e31-9862-3289cbcbb35f"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"sig2TE\"\>", "\[Rule]", "177.0543975830078`"}], ",", 
   RowBox[{"\<\"wtTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.5830299258232117`", ",", "0.`", ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.5832023620605469`", ",", "0.`", ",", "0.`"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"\<\"bTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"212.19178771972656`", ",", "0.`", ",", "0.`"}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{{3.827363711656893*^9, 3.8273637288122683`*^9}},
 CellLabel->
  "During evaluation of \
In[905]:=",ExpressionUUID->"c9574065-0480-4898-b26d-c2e396f31917"]
}, Open  ]],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.825884783139916*^9, 3.825884787116908*^9}, 
   3.825884906765724*^9, 3.82588653782237*^9, 3.8258865937945538`*^9, 
   3.826033776798118*^9, 3.826033923812048*^9, 3.8273631410913887`*^9, {
   3.8273637115914087`*^9, 3.827363728815167*^9}},
 CellLabel->
  "Out[908]=",ExpressionUUID->"a2e85ed2-e7da-4514-94da-bf9231316de8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lyr", "=", 
   RowBox[{"makeRxnParams0TE", "[", 
    RowBox[{"nvTest", ",", "nhTest", ",", 
     RowBox[{"{", 
      RowBox[{"\"\<death\>\"", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"valsCheck", "=", 
    RowBox[{"lyr", "[", "paramsTest", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rxnNMomentsTEtest", "=", 
   RowBox[{"makeRxnDeathNMomentsTE", "[", 
    RowBox[{"nMomentsTest", ",", "nMoments3Test", ",", "1"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"validateParams0TE", "[", 
  RowBox[{
  "momentsTest", ",", "paramsTest", ",", "paramMomentsTest", ",", "valsCheck",
    ",", "rxnNMomentsTEtest", ",", "nhTest"}], "]"}]}], "Input",
 CellChangeTimes->{{3.825884925193521*^9, 3.8258849290455112`*^9}, {
   3.825886599741466*^9, 3.825886601111903*^9}, 3.8260337769556303`*^9, 
   3.8260339215102654`*^9, {3.8273631417716303`*^9, 3.827363155332712*^9}, {
   3.8273637432053947`*^9, 3.827363747471702*^9}},
 CellLabel->
  "In[915]:=",ExpressionUUID->"ee297440-6eb3-4e26-bd63-ca7a21275eb0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"fwt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5829639274727756`"}], ",", "0.`", ",", "0.`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.583390845584656`"}], ",", "0.`", ",", "0.`"}], 
       "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"fb\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "212.19179020822287`"}], ",", "0.`", ",", "0.`"}], "}"}]}],
    ",", 
   RowBox[{"\<\"fsig2\"\>", "\[Rule]", 
    RowBox[{"-", "35.591344619330286`"}]}], ",", 
   RowBox[{"\<\"fmuh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}], ",", 
   RowBox[{"\<\"fvarh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{3.8273637504925632`*^9},
 CellLabel->
  "During evaluation of \
In[915]:=",ExpressionUUID->"eda6a64f-c851-4019-b585-fd0a72f4079b"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"sig2TE\"\>", "\[Rule]", 
    RowBox[{"-", "35.590858459472656`"}]}], ",", 
   RowBox[{"\<\"wtTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5830299258232117`"}], ",", "0.`", ",", "0.`"}], "}"}],
       ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.5832023620605469`"}], ",", "0.`", ",", "0.`"}], 
       "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"bTE\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "212.19178771972656`"}], ",", "0.`", ",", "0.`"}], 
     "}"}]}]}], "\[RightAssociation]"}]], "Print",
 CellChangeTimes->{3.827363750495223*^9},
 CellLabel->
  "During evaluation of \
In[915]:=",ExpressionUUID->"f4af52b0-06c4-400c-8daf-8989be4e525f"]
}, Open  ]],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.825884931579575*^9, 3.8258866033953743`*^9, 
  3.8260337800780993`*^9, 3.826033926364039*^9, 3.8273631581723022`*^9, 
  3.827363750498678*^9},
 CellLabel->
  "Out[918]=",ExpressionUUID->"fe5302c9-dc06-4701-a211-a0aa0a27cf7e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "nvTest", ",", "nhTest", ",", "nTest", ",", "muTest", ",", "varvTest", ",", 
   "varhTest", ",", "varvhTest", ",", "varTest", ",", "momentsTest", ",", 
   "valsCheck", ",", "rxnNMomentsTEtest", ",", "paramsTest", ",", 
   "paramMomentsTest", ",", "nMomentsTest", ",", "nMoments3Test"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.827364989419146*^9, 3.827365011228428*^9}},
 CellLabel->
  "In[1282]:=",ExpressionUUID->"53945ad6-6995-4ca3-850a-67c73d32a127"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Flatten outputs", "Chapter",
 CellChangeTimes->{{3.825885540845749*^9, 
  3.825885542317395*^9}},ExpressionUUID->"54ac089f-a600-476d-9ce4-\
7ad6776bcabd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"layerDefnsFlat", "=", 
   RowBox[{"<|", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<wtFlat\>\"", "\[Rule]", 
      RowBox[{"FlattenLayer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<varhFlat\>\"", "\[Rule]", 
      RowBox[{"FlattenLayer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<sig2Arr\>\"", "\[Rule]", 
      RowBox[{"ReshapeLayer", "[", 
       RowBox[{"{", "1", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<cat\>\"", "\[Rule]", 
      RowBox[{"CatenateLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
    "|>"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.82588599279974*^9, 3.825886004356789*^9}, 
   3.825886059198228*^9},
 CellLabel->"In[49]:=",ExpressionUUID->"7291f700-9d87-42cd-8c4c-cd5ad9cb1538"],

Cell[BoxData[
 RowBox[{
  RowBox[{"layerConnFlat", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"NetPort", "[", 
       RowBox[{"\"\<lyr\>\"", ",", "\"\<sig2TE\>\""}], "]"}], "\[Rule]", 
      "\"\<sig2Arr\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NetPort", "[", 
       RowBox[{"\"\<lyr\>\"", ",", "\"\<wtTE\>\""}], "]"}], "\[Rule]", 
      "\"\<wtFlat\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"NetPort", "[", 
       RowBox[{"\"\<lyr\>\"", ",", "\"\<varhTE\>\""}], "]"}], "\[Rule]", 
      "\"\<varhFlat\>\""}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<wtFlat\>\"", ",", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<lyr\>\"", ",", "\"\<bTE\>\""}], "]"}], ",", 
        "\"\<sig2Arr\>\"", ",", 
        RowBox[{"NetPort", "[", 
         RowBox[{"\"\<lyr\>\"", ",", "\"\<muhTE\>\""}], "]"}], ",", 
        "\"\<varhFlat\>\""}], "}"}], "\[Rule]", "\"\<cat\>\""}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825886061420533*^9, 3.825886070073381*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"4505359f-8d53-423a-b444-003220688794"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeRxnParams0TEflat", "[", 
   RowBox[{"nv_", ",", "nh_", ",", "rxnSpec_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layerDefns", ",", "layerConn"}], "}"}], "\[IndentingNewLine]", 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<wtFlat\>\"", "\[Rule]", 
         RowBox[{"FlattenLayer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<sig2Arr\>\"", "\[Rule]", 
         RowBox[{"ReshapeLayer", "[", 
          RowBox[{"{", "1", "}"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<cat\>\"", "\[Rule]", 
         RowBox[{"CatenateLayer", "[", "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<lyr\>\"", "->", 
         RowBox[{"makeRxnParams0TE", "[", 
          RowBox[{"nv", ",", "nh", ",", "rxnSpec"}], "]"}]}]}], 
       "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<lyr\>\"", ",", "\"\<sig2TE\>\""}], "]"}], "\[Rule]", 
         "\"\<sig2Arr\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<lyr\>\"", ",", "\"\<wtTE\>\""}], "]"}], "\[Rule]", 
         "\"\<wtFlat\>\""}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\"\<wtFlat\>\"", ",", 
           RowBox[{"NetPort", "[", 
            RowBox[{"\"\<lyr\>\"", ",", "\"\<bTE\>\""}], "]"}], ",", 
           "\"\<sig2Arr\>\""}], "}"}], "\[Rule]", "\"\<cat\>\""}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.825885523782955*^9, 3.8258855553523817`*^9}, {
  3.8258857837380457`*^9, 3.8258859813194103`*^9}, {3.825886074141818*^9, 
  3.82588609389566*^9}, {3.825886628827965*^9, 3.825886672880559*^9}, {
  3.826033925156805*^9, 3.8260339274195642`*^9}, {3.8260339993488197`*^9, 
  3.826034034750005*^9}, {3.828035269193844*^9, 3.828035278785993*^9}, {
  3.828748262896975*^9, 3.828748265385928*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"01d9586b-2ca0-453e-8019-fd5622a5a67b"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8273637594830103`*^9, 
  3.827363759730708*^9}},ExpressionUUID->"43816a05-c782-4619-aa7a-\
1ffe6d1c5097"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nvTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhTest", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeRxnParams0TEflat", "[", 
   RowBox[{"nvTest", ",", "nhTest", ",", 
    RowBox[{"{", 
     RowBox[{"\"\<eat\>\"", ",", "2", ",", "1"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.825885818439949*^9, 3.8258858237838984`*^9}, {
   3.8258866818319607`*^9, 3.825886688582415*^9}, 3.826033943365218*^9, {
   3.827363764369441*^9, 3.8273637719526157`*^9}, 
   3.830798597123167*^9},ExpressionUUID->"ccb1df33-787b-4c80-bed6-\
c5ba040009f3"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nvTest", ",", "nhTest"}], "]"}]], "Input",
 CellChangeTimes->{{3.827365018462031*^9, 3.827365021447373*^9}},
 CellLabel->
  "In[1283]:=",ExpressionUUID->"fb4f7a2c-9480-43ca-beba-c30143ac1953"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Import package for tests", "Title",
 CellChangeTimes->{{3.825883769607966*^9, 3.8258837715440702`*^9}, {
  3.825897757113186*^9, 
  3.82589775841055*^9}},ExpressionUUID->"365eb2a4-c2ef-4c3f-9202-\
fa061a5b00a3"],

Cell[BoxData[{
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<../../funcs_rxns_moms.m\>\"", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8258837730534678`*^9, 3.825883819050502*^9}, {
  3.827352939656767*^9, 3.827352940070969*^9}, {3.8307986098409147`*^9, 
  3.830798612846264*^9}},ExpressionUUID->"9c286fac-fee4-4aa7-9840-\
dc12e032e358"]
}, Closed]],

Cell[CellGroupData[{

Cell["Make graph for inputs", "Title",
 CellChangeTimes->{{3.825943042388685*^9, 
  3.825943046608261*^9}},ExpressionUUID->"e9f5b843-b032-4204-8f80-\
f0079616cd07"],

Cell[BoxData[
 RowBox[{
  RowBox[{"makeGraphInputsWOSTD", "[", 
   RowBox[{
   "nv_", ",", "nh_", ",", "freqs_", ",", "muhCosCoeffsInit_", ",", 
    "muhSinCoeffsInit_", ",", "varhCosCoeffsInit_", ",", "varhSinCoeffsInit_",
     ",", "rxnSpecs_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "layerDefns", ",", "layerConn", ",", "graph", ",", "rxnName", ",", 
      "idx"}], "}"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"layerDefns", "=", 
      RowBox[{"<|", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\"\<convert0\>\"", "->", 
         RowBox[{"makeConvertParams0ToParamsLayer", "[", 
          RowBox[{
          "nv", ",", "nh", ",", "freqs", ",", "muhCosCoeffsInit", ",", 
           "muhSinCoeffsInit", ",", "varhCosCoeffsInit", ",", 
           "varhSinCoeffsInit"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<rxnsCatenate\>\"", "\[Rule]", 
         RowBox[{"CatenateLayer", "[", "]"}]}]}], "\[IndentingNewLine]", 
       "|>"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"layerConn", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<wt\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convert0\>\"", ",", "\"\<wt1\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"NetPort", "[", "\"\<b\>\"", "]"}], "\[Rule]", 
         RowBox[{"NetPort", "[", 
          RowBox[{"\"\<convert0\>\"", ",", "\"\<b1\>\""}], "]"}]}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Reactions", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"idx", "=", "1"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"rxnName", "=", 
            RowBox[{"\"\<rxn\>\"", "<>", 
             RowBox[{"ToString", "[", "idx", "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"idx", "+=", "1"}], ";", "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"layerDefns", "[", "rxnName", "]"}], "=", 
            RowBox[{"makeRxnParams0TEflat", "[", 
             RowBox[{"nv", ",", "nh", ",", "rxnSpec"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"layerConn", "=", 
            RowBox[{"Join", "[", 
             RowBox[{"layerConn", ",", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{
                 RowBox[{"NetPort", "[", 
                  RowBox[{"\"\<convert0\>\"", ",", "\"\<wt2\>\""}], "]"}], "->", 
                 RowBox[{"NetPort", "[", 
                  RowBox[{"rxnName", ",", "\"\<wt\>\""}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"NetPort", "[", 
                  RowBox[{"\"\<convert0\>\"", ",", "\"\<b2\>\""}], "]"}], "->", 
                 RowBox[{"NetPort", "[", 
                  RowBox[{"rxnName", ",", "\"\<b\>\""}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"NetPort", "[", 
                  RowBox[{"\"\<convert0\>\"", ",", "\"\<sig2\>\""}], "]"}], "->", 
                 RowBox[{"NetPort", "[", 
                  RowBox[{"rxnName", ",", "\"\<sig2\>\""}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"NetPort", "[", 
                  RowBox[{"\"\<convert0\>\"", ",", "\"\<muh2\>\""}], "]"}], "->", 
                 RowBox[{"NetPort", "[", 
                  RowBox[{"rxnName", ",", "\"\<muh\>\""}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"NetPort", "[", 
                  RowBox[{"\"\<convert0\>\"", ",", "\"\<varh2\>\""}], "]"}], "->", 
                 RowBox[{"NetPort", "[", 
                  RowBox[{"rxnName", ",", "\"\<varh\>\""}], "]"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"rxnName", "\[Rule]", "\"\<rxnsCatenate\>\""}]}], 
               "\[IndentingNewLine]", "}"}]}], "]"}]}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"rxnSpec", ",", "rxnSpecs"}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"ProgressIndicator", "[", 
        RowBox[{"idx", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{"Length", "[", "rxnSpecs", "]"}]}], "}"}]}], "]"}]}], 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"NetGraph", "[", 
       RowBox[{"layerDefns", ",", "layerConn"}], "]"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8259430470235*^9, 3.825943110705764*^9}, {
   3.825943224194178*^9, 3.825943226806053*^9}, {3.825943564010388*^9, 
   3.825943568311454*^9}, 3.8260339490454617`*^9, {3.8260355047373962`*^9, 
   3.8260355061303883`*^9}, {3.826043887458156*^9, 3.8260439184339943`*^9}, {
   3.8260444659249487`*^9, 3.826044479651421*^9}, {3.826118048090307*^9, 
   3.826118068461138*^9}, 3.826736452814392*^9, {3.827001791734169*^9, 
   3.827001792394417*^9}, {3.828035286799425*^9, 3.828035296920537*^9}, {
   3.8287482490296907`*^9, 3.8287482518244877`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"d575d9ea-7910-41a1-8e6c-80fbc2946d3b"],

Cell[CellGroupData[{

Cell["Test", "Section",
 CellChangeTimes->{{3.8273637919320583`*^9, 
  3.827363792265574*^9}},ExpressionUUID->"b59fef07-4110-4a70-af17-\
ee434f836542"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nvTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"momentsTest", "=", 
   RowBox[{
    RowBox[{"<|", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\"\<mu\>\"", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"3", ",", "2", ",", "6", ",", "8", ",", "7"}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"\"\<var\>\"", "\[Rule]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"9.0", ",", "0.2", ",", "0.1", ",", "0.08", ",", "0.07"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0.2", ",", "3.0", ",", "0.1", ",", "0.08", ",", "0.07"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0.1", ",", "0.1", ",", "6.0", ",", "0.08", ",", "0.07"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0.08", ",", "0.08", ",", "0.1", ",", "8.0", ",", "0.0"}], 
          "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"0.07", ",", "0.07", ",", "0.07", ",", "0.0", ",", "9.0"}], 
          "}"}]}], "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
     "|>"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
   RowBox[{"momentsTest", "[", "\"\<var\>\"", "]"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"paramsTest", "=", 
  RowBox[{"convertMomentsToParams", "[", 
   RowBox[{"momentsTest", ",", "nvTest"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"momentsTest", "=", 
  RowBox[{
  "convertParamsToMoments", "[", "paramsTest", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"PositiveSemidefiniteMatrixQ", "[", 
  RowBox[{"momentsTest", "[", "\"\<var\>\"", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.825897199989624*^9, 3.825897235735756*^9}, {
  3.827001810667441*^9, 3.827001970229278*^9}, {3.8273638814971533`*^9, 
  3.827363891462393*^9}},
 CellLabel->
  "In[1018]:=",ExpressionUUID->"3df4e0f6-53f9-4529-b7ca-67dbe37335e5"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8258972243264*^9, 3.825897236095263*^9}, {
   3.8259431268719597`*^9, 3.8259431380483227`*^9}, 3.826033954880127*^9, 
   3.8260355206455193`*^9, 3.826043924941992*^9, 3.8270019712643557`*^9, {
   3.827363795177651*^9, 3.827363839833962*^9}, 3.827363891749378*^9},
 CellLabel->
  "Out[1020]=",ExpressionUUID->"165b0144-3469-42cf-a256-f1d8367c1850"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"sig2\"\>", "\[Rule]", "8.998655555555555`"}], ",", 
   RowBox[{"\<\"muh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"8.`", ",", "7.`"}], "}"}]}], ",", 
   RowBox[{"\<\"varh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"8.`", ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.`", ",", "9.`"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"wt\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.01`", ",", "0.01`", ",", "0.0125`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.007777777777777778`", ",", "0.007777777777777778`", ",", 
        "0.007777777777777778`"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"b\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "2.8655555555555554`", ",", "1.8655555555555556`", ",", 
      "5.845555555555555`"}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.8258972243264*^9, 3.825897236095263*^9}, {
   3.8259431268719597`*^9, 3.8259431380483227`*^9}, 3.826033954880127*^9, 
   3.8260355206455193`*^9, 3.826043924941992*^9, 3.8270019712643557`*^9, {
   3.827363795177651*^9, 3.827363839833962*^9}, 3.827363891752692*^9},
 CellLabel->
  "Out[1021]=",ExpressionUUID->"71dd130c-7fec-465c-b74c-21bb179efe10"],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"\<\"muv\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"3.`", ",", "2.`", ",", "6.`"}], "}"}]}], ",", 
   RowBox[{"\<\"muh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"8.`", ",", "7.`"}], "}"}]}], ",", 
   RowBox[{"\<\"varv\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "9.`", ",", "0.0013444444444444445`", ",", "0.0015444444444444446`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.0013444444444444445`", ",", "9.`", ",", "0.0015444444444444446`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.0015444444444444446`", ",", "0.0015444444444444446`", ",", 
        "9.000449999999999`"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"varvh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0.08`", ",", "0.08`", ",", "0.1`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.07`", ",", "0.07`", ",", "0.07`"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"varh\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"8.`", ",", "0.`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.`", ",", "9.`"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"\<\"mu\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"3.`", ",", "2.`", ",", "6.`", ",", "8.`", ",", "7.`"}], "}"}]}],
    ",", 
   RowBox[{"\<\"var\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "9.`", ",", "0.0013444444444444445`", ",", "0.0015444444444444446`", 
        ",", "0.08`", ",", "0.07`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.0013444444444444445`", ",", "9.`", ",", "0.0015444444444444446`", 
        ",", "0.08`", ",", "0.07`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0.0015444444444444446`", ",", "0.0015444444444444446`", ",", 
        "9.000449999999999`", ",", "0.1`", ",", "0.07`"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.08`", ",", "0.08`", ",", "0.1`", ",", "8.`", ",", "0.`"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.07`", ",", "0.07`", ",", "0.07`", ",", "0.`", ",", "9.`"}], 
       "}"}]}], "}"}]}]}], "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{{3.8258972243264*^9, 3.825897236095263*^9}, {
   3.8259431268719597`*^9, 3.8259431380483227`*^9}, 3.826033954880127*^9, 
   3.8260355206455193`*^9, 3.826043924941992*^9, 3.8270019712643557`*^9, {
   3.827363795177651*^9, 3.827363839833962*^9}, 3.8273638917557373`*^9},
 CellLabel->
  "Out[1022]=",ExpressionUUID->"08c7f5eb-1743-4911-b915-2281c5dd95eb"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.8258972243264*^9, 3.825897236095263*^9}, {
   3.8259431268719597`*^9, 3.8259431380483227`*^9}, 3.826033954880127*^9, 
   3.8260355206455193`*^9, 3.826043924941992*^9, 3.8270019712643557`*^9, {
   3.827363795177651*^9, 3.827363839833962*^9}, 3.82736389175858*^9},
 CellLabel->
  "Out[1023]=",ExpressionUUID->"47f5b596-819b-4924-934d-9de3137c066f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nvTest", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nhTest", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"rxnSpecs", "=", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<eat\>\"", ",", "2", ",", "1"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\"\<birth\>\"", ",", "2"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"\"\<death\>\"", ",", "1"}], "}"}]}], "\[IndentingNewLine]", 
   "}"}]}], "\n", 
 RowBox[{
  RowBox[{"freqsTest", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"muhCosCoeffsInit", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "4"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"muhSinCoeffsInit", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"varhCosCoeffsInit", "=", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{"0", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varhSinCoeffsInit", "=", 
    RowBox[{"ConstantArray", "[", 
     RowBox[{"0", ",", "4"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"makeGraphInputsWOSTD", "[", 
   RowBox[{
   "nvTest", ",", "nhTest", ",", "freqsTest", ",", "muhCosCoeffsInit", ",", 
    "muhSinCoeffsInit", ",", "varhCosCoeffsInit", ",", "varhSinCoeffsInit", 
    ",", "rxnSpecs"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.825887424826394*^9, 3.825887438432991*^9}, {
   3.8258970365415792`*^9, 3.8258970442021713`*^9}, {3.826035535806492*^9, 
   3.8260355397358837`*^9}, {3.826043929360838*^9, 3.826043937034128*^9}, {
   3.8261180854868507`*^9, 3.8261180860031567`*^9}, {3.827001996336423*^9, 
   3.82700199916092*^9}, {3.8270025795228157`*^9, 3.827002579743844*^9}, {
   3.8273638953851547`*^9, 3.8273639562069187`*^9}, 
   3.830798619734954*^9},ExpressionUUID->"7c8cd943-584a-4c2f-832d-\
0815b213fef4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"eat\"\>", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"birth\"\>", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"death\"\>", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.825943237303995*^9, 3.825943580738405*^9, 3.8260339696484756`*^9, 
   3.826034069255864*^9, 3.826035540290409*^9, 3.826043937365882*^9, {
   3.8270019792205267`*^9, 3.827001999373719*^9}, {3.827002553546445*^9, 
   3.827002580185104*^9}, 3.827363956501876*^9},
 CellLabel->
  "Out[1026]=",ExpressionUUID->"8ae3957a-4d6d-4c7d-830a-c253ac75dde8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{
  "nvTest", ",", "nhTest", ",", "rxnSpecs", ",", "muhCosCoeffsInit", ",", 
   "muhSinCoeffsInit", ",", "varhCosCoeffsInit", ",", "varhSinCoeffsInit", 
   ",", "paramsTest", ",", "momentsTest"}], "]"}]], "Input",
 CellChangeTimes->{{3.8273650315831537`*^9, 3.8273650555373774`*^9}},
 CellLabel->
  "In[1285]:=",ExpressionUUID->"d6a71509-edf0-4abd-b9fd-f1d7a6399b95"]
}, Open  ]]
}, Closed]]
},
AutoGeneratedPackage->None,
WindowSize->{1254, 952},
WindowMargins->{{Automatic, 118}, {0, Automatic}},
FrontEndVersion->"12.2 for Mac OS X x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c74e991d-4e90-4c3a-aed6-562037d4389e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 152, 3, 98, "Title",ExpressionUUID->"2fc3b0a5-ef81-48e0-ad46-2bca4dac5358"],
Cell[735, 27, 8744, 178, 1296, "Input",ExpressionUUID->"32543105-d66a-47bc-a629-e0f4a372c52c",
 InitializationCell->True],
Cell[9482, 207, 723, 20, 46, "Input",ExpressionUUID->"37fb00f8-9dd3-42e3-96b5-c9b0ff2c57e1",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[10230, 231, 151, 3, 67, "Section",ExpressionUUID->"c6042bff-cc26-4f2f-986d-ecc4f93d5a7e"],
Cell[10384, 236, 1597, 38, 136, "Input",ExpressionUUID->"bd9e0421-5680-4e96-9edd-837bebda45bf"],
Cell[CellGroupData[{
Cell[12006, 278, 3960, 92, 262, "Input",ExpressionUUID->"8aaca3fa-4328-40a3-a24d-75c36d828599"],
Cell[15969, 372, 1383, 20, 34, "Output",ExpressionUUID->"1b906659-4b91-4e41-b9d7-56ac089b0858"],
Cell[17355, 394, 7127, 138, 264, "Output",ExpressionUUID->"ceec4374-948b-4ec0-b6e7-fdebe809d7de"]
}, Open  ]],
Cell[24497, 535, 365, 8, 30, "Input",ExpressionUUID->"d81f9a81-fa8d-4acb-adee-4a92484d441b"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[24911, 549, 264, 4, 72, "Title",ExpressionUUID->"46f1c9ea-80e8-46a1-860d-8b88772d3017"],
Cell[CellGroupData[{
Cell[25200, 557, 173, 3, 69, "Chapter",ExpressionUUID->"58c2c622-0ee6-4775-bfcb-7570bd94d2eb"],
Cell[25376, 562, 5008, 117, 624, "Input",ExpressionUUID->"c5ae758e-7d92-49b4-a618-114f1b6a6b90",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[30409, 683, 149, 3, 67, "Section",ExpressionUUID->"f5b0d2e4-3090-4b8b-87ff-e95ae03a18fb"],
Cell[CellGroupData[{
Cell[30583, 690, 740, 19, 115, "Input",ExpressionUUID->"ac7172b7-b440-4bda-932e-fea6f5bc4945"],
Cell[31326, 711, 462, 11, 34, "Output",ExpressionUUID->"a016224d-669b-4a05-acfb-35809088d568"],
Cell[31791, 724, 447, 11, 34, "Output",ExpressionUUID->"947c29f7-b216-4ec3-a079-b3671521936e"]
}, Open  ]],
Cell[32253, 738, 241, 5, 30, "Input",ExpressionUUID->"a27c667e-dd2f-4785-8134-7447b4114b76"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[32555, 750, 165, 3, 72, "Title",ExpressionUUID->"65ddda7d-81a2-477d-b031-9b6318b22c4a"],
Cell[CellGroupData[{
Cell[32745, 757, 154, 3, 69, "Chapter",ExpressionUUID->"234c5c85-9bab-4473-aa2a-1eea602dc55f"],
Cell[32902, 762, 2798, 63, 320, "Input",ExpressionUUID->"2a624d7d-0f44-4d9d-9d11-16d434d00080",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[35725, 829, 149, 3, 67, "Section",ExpressionUUID->"e8aec30b-da52-42b9-bfea-b70c76d3345f"],
Cell[CellGroupData[{
Cell[35899, 836, 2579, 73, 325, "Input",ExpressionUUID->"e00ca8e7-ae7b-4a23-8a05-aa4385e2e04a"],
Cell[38481, 911, 591, 11, 34, "Output",ExpressionUUID->"ea48707d-8a68-41dd-8aee-fc4f0bec15b8"],
Cell[39075, 924, 591, 11, 34, "Output",ExpressionUUID->"cac1c27b-9b4d-49ac-8072-da9ba6ec76fe"]
}, Open  ]],
Cell[39681, 938, 354, 8, 30, "Input",ExpressionUUID->"5b349017-1642-48e9-9321-2f45d789426f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[40084, 952, 159, 3, 69, "Chapter",ExpressionUUID->"7726c12a-ff78-4822-b28d-3b50ccc9f61d"],
Cell[40246, 957, 2534, 55, 299, "Input",ExpressionUUID->"1c05b6a8-f56f-4006-804c-69e86dbf262d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[42805, 1016, 151, 3, 67, "Section",ExpressionUUID->"458d2c7b-32d4-4dd4-a3b7-579e121d3948"],
Cell[CellGroupData[{
Cell[42981, 1023, 1686, 49, 199, "Input",ExpressionUUID->"2baa5183-835a-4ff4-b7b4-45c971cce523"],
Cell[44670, 1074, 589, 16, 34, "Output",ExpressionUUID->"7f5cb75c-85d8-45f1-85a8-4965838e730b"],
Cell[45262, 1092, 589, 16, 34, "Output",ExpressionUUID->"2e77a1a6-29dc-4485-8979-e418d24c132a"]
}, Open  ]],
Cell[45866, 1111, 306, 7, 30, "Input",ExpressionUUID->"2038d826-2b7c-4d11-88d4-53bc6d7474bc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[46221, 1124, 236, 4, 69, "Chapter",ExpressionUUID->"e1d1d40b-6d25-42e1-bd96-0620b2c8a6aa"],
Cell[46460, 1130, 2585, 56, 299, "Input",ExpressionUUID->"150883d2-624d-40c6-a0fa-fc0a2bc65725",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[49070, 1190, 151, 3, 67, "Section",ExpressionUUID->"6e49b6a6-b5bb-4c5c-8c7a-274a515b2056"],
Cell[CellGroupData[{
Cell[49246, 1197, 1782, 50, 262, "Input",ExpressionUUID->"6d98dd5d-7a7b-414c-92ae-22d6a40780a1"],
Cell[51031, 1249, 438, 10, 34, "Output",ExpressionUUID->"e846ae75-2735-4b98-930f-8f77aebfe469"],
Cell[51472, 1261, 127595, 2630, 65, "Output",ExpressionUUID->"3cf9d63f-2166-4a5f-8c85-0e197cf83757"],
Cell[179070, 3893, 439, 10, 34, "Output",ExpressionUUID->"85b653b9-e8ac-42b5-988c-3ec99800cdbf"]
}, Open  ]],
Cell[179524, 3906, 330, 7, 30, "Input",ExpressionUUID->"3d892237-7c21-4df4-91eb-7bc27585da6e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[179903, 3919, 164, 3, 69, "Chapter",ExpressionUUID->"df4c7c01-95d5-4b10-887c-77d05d6958a8"],
Cell[180070, 3924, 2302, 51, 299, "Input",ExpressionUUID->"e9f4b641-fa44-417b-88fa-68419485a24f",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[182397, 3979, 150, 3, 67, "Section",ExpressionUUID->"a16f9d93-1fcd-4c1a-8563-349ebb22c737"],
Cell[CellGroupData[{
Cell[182572, 3986, 1371, 38, 157, "Input",ExpressionUUID->"7939a27f-2799-4215-9720-b1dd12e1897a"],
Cell[183946, 4026, 617, 16, 34, "Output",ExpressionUUID->"b6c24455-01b3-431f-8592-33cf19521e27"],
Cell[184566, 4044, 619, 16, 34, "Output",ExpressionUUID->"27aec40d-d06e-46af-9384-0a9725da63e8"]
}, Open  ]],
Cell[185200, 4063, 282, 6, 30, "Input",ExpressionUUID->"27e9fb05-8b07-49ad-a5c5-3b5942fb8585"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[185543, 4076, 230, 4, 72, "Title",ExpressionUUID->"fedfaf62-4769-4c23-b2f3-e4387ee5439f"],
Cell[CellGroupData[{
Cell[185798, 4084, 168, 3, 69, "Chapter",ExpressionUUID->"26c7ba03-7fb0-4a3d-9df6-2ddf25d21e6c"],
Cell[185969, 4089, 2720, 64, 425, "Input",ExpressionUUID->"aede53a6-cf60-4b68-9224-5c28fdb279e2",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[188714, 4157, 151, 3, 67, "Section",ExpressionUUID->"6c6ad3af-2ff2-4b39-a48c-a369b67bd502"],
Cell[CellGroupData[{
Cell[188890, 4164, 1225, 32, 157, "Input",ExpressionUUID->"096eae42-a05a-41b3-86d9-5b7b62624ba0"],
Cell[190118, 4198, 501, 11, 34, "Output",ExpressionUUID->"297c04c9-40b3-4017-b5ff-96acfb446caf"]
}, Open  ]],
Cell[190634, 4212, 333, 7, 30, "Input",ExpressionUUID->"a4eb4b18-7f3a-49cb-9355-387a07c4eb7f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[191016, 4225, 171, 3, 69, "Chapter",ExpressionUUID->"dca4cd67-10a0-4086-a71b-812d2905a4e9"],
Cell[191190, 4230, 4469, 102, 635, "Input",ExpressionUUID->"3467a33a-6c0e-42f1-9e63-aa031004a145",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[195684, 4336, 151, 3, 67, "Section",ExpressionUUID->"495d655e-5252-445a-8359-f38c2b670d90"],
Cell[CellGroupData[{
Cell[195860, 4343, 1311, 34, 157, "Input",ExpressionUUID->"2a2977e5-93c4-4446-9189-397be85e6776"],
Cell[197174, 4379, 1040, 25, 60, "Output",ExpressionUUID->"c21a5a37-5529-48d6-a849-75a8ae6fda32"]
}, Open  ]],
Cell[198229, 4407, 333, 7, 30, "Input",ExpressionUUID->"16e35519-9804-4b83-be83-33c54491d24f"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[198611, 4420, 173, 3, 69, "Chapter",ExpressionUUID->"56725cc8-e07c-43f9-b3b4-aa3a1f43a5c1"],
Cell[198787, 4425, 4319, 87, 614, "Input",ExpressionUUID->"a365bf21-ecee-4dcf-93cd-95e4ab038d86",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[203131, 4516, 151, 3, 67, "Section",ExpressionUUID->"0fb607a4-0ac0-425e-a7cb-4ce84a0eee7f"],
Cell[203285, 4521, 1031, 27, 157, "Input",ExpressionUUID->"38bacdb5-1c9d-4306-9ac8-b43d11542025"],
Cell[204319, 4550, 739, 13, 52, "Input",ExpressionUUID->"31b5925e-52e5-48c1-8b2c-eda21f54006d"],
Cell[205061, 4565, 390, 8, 30, "Input",ExpressionUUID->"d0735ec9-1fc5-46ee-b3b9-134c970372c2"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[205512, 4580, 213, 4, 72, "Title",ExpressionUUID->"6af74424-f4fe-4f07-827d-58a5ec887ae3"],
Cell[CellGroupData[{
Cell[205750, 4588, 171, 3, 69, "Chapter",ExpressionUUID->"956e8db4-64e5-4101-9cbc-d3223c1a84b3"],
Cell[205924, 4593, 1213, 32, 89, "Input",ExpressionUUID->"322f1acc-b919-4d84-88f7-721b03c9aef7",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[207162, 4629, 149, 3, 67, "Section",ExpressionUUID->"1a636228-fe3e-4056-a400-d50bfde822e8"],
Cell[CellGroupData[{
Cell[207336, 4636, 1860, 58, 262, "Input",ExpressionUUID->"febff9b1-857e-4a05-87b7-e822e6003230"],
Cell[209199, 4696, 1478, 32, 77, "Output",ExpressionUUID->"36ee8eaa-1aae-4ccc-a554-930cc5488663"],
Cell[210680, 4730, 1481, 33, 77, "Output",ExpressionUUID->"b03879de-aae2-43dc-b355-dbec30db6ba1"]
}, Open  ]],
Cell[212176, 4766, 280, 6, 30, "Input",ExpressionUUID->"46cb9a84-63cc-4268-ac1c-5560fb9d4b8e"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[212505, 4778, 170, 3, 69, "Chapter",ExpressionUUID->"299c0f25-55d8-4829-b93a-ecd6d2b00b8d"],
Cell[212678, 4783, 7861, 175, 992, "Input",ExpressionUUID->"e07c8541-1179-4820-b811-9b07e9faf697",
 InitializationCell->True],
Cell[220542, 4960, 489, 11, 73, "Input",ExpressionUUID->"599aaa96-365b-4503-aafe-20aba7d77949"],
Cell[221034, 4973, 241, 5, 30, "Input",ExpressionUUID->"f383a405-9f31-41c4-9ea7-88da6c3e3403"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[221324, 4984, 170, 3, 72, "Title",ExpressionUUID->"c0dd3a22-94d8-4ff8-bb31-e0c16d130d7f"],
Cell[CellGroupData[{
Cell[221519, 4991, 174, 3, 69, "Chapter",ExpressionUUID->"656300c1-b958-476c-92fd-55b749c22e64"],
Cell[221696, 4996, 2558, 60, 404, "Input",ExpressionUUID->"03ec8a4e-fc56-4a54-b74e-c41964bd45c8",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[224279, 5060, 151, 3, 67, "Section",ExpressionUUID->"d80a9052-a75a-40e8-964c-7364990316a3"],
Cell[224433, 5065, 490, 10, 73, "Input",ExpressionUUID->"bd587b45-36b0-4af1-899f-ba028755ef42"],
Cell[224926, 5077, 175, 4, 30, "Input",ExpressionUUID->"77e1a2c5-6625-4f10-b10e-e8d3bbedf020"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[225150, 5087, 171, 3, 69, "Chapter",ExpressionUUID->"a77bdd70-a8a2-4068-8b48-da877a80b91d"],
Cell[225324, 5092, 1959, 44, 341, "Input",ExpressionUUID->"a6d3be3c-8a34-4a91-ba32-0ff75dbe2be1",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[227308, 5140, 148, 3, 67, "Section",ExpressionUUID->"939baf4f-992d-47a5-97f9-1dac7ff961ec"],
Cell[227459, 5145, 488, 11, 73, "Input",ExpressionUUID->"af0af7bb-f129-48a6-927a-9f3a1428346b"],
Cell[227950, 5158, 175, 4, 30, "Input",ExpressionUUID->"7f2c899e-15eb-40cf-bb8b-f7992bc51628"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[228186, 5169, 154, 3, 72, "Title",ExpressionUUID->"4c6ecff3-0666-4b86-ac9f-f1582aa49833"],
Cell[228343, 5174, 1790, 42, 215, "Input",ExpressionUUID->"6020f374-229e-4093-8fdd-4d1cf50728bd",
 InitializationCell->True],
Cell[230136, 5218, 962, 25, 46, "Input",ExpressionUUID->"3e9b3d6e-c4ac-4ed7-93cf-033af5f3451e",
 InitializationCell->True],
Cell[231101, 5245, 1241, 33, 68, "Input",ExpressionUUID->"c6a2eb84-bf4c-444f-a2fc-c5207627e278",
 InitializationCell->True],
Cell[232345, 5280, 2053, 48, 320, "Input",ExpressionUUID->"8c01b497-6d4d-4bc1-a379-921da1e6e19d",
 InitializationCell->True],
Cell[234401, 5330, 1977, 44, 320, "Input",ExpressionUUID->"016f770d-e3aa-4373-a195-a9dfc825e27f",
 InitializationCell->True],
Cell[236381, 5376, 3505, 80, 509, "Input",ExpressionUUID->"1207896e-17be-4e6b-98d3-1eb7faf89c15",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[239911, 5460, 151, 3, 67, "Section",ExpressionUUID->"dcb585f8-9fa8-4c1e-a058-f698a8de46b1"],
Cell[240065, 5465, 3395, 86, 530, "Input",ExpressionUUID->"dcf24204-5757-43bf-8d0f-2518f641618d",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[243485, 5555, 2401, 68, 346, "Input",ExpressionUUID->"2589dfb4-3720-4ddb-bfc0-1492608a07b5"],
Cell[245889, 5625, 326, 6, 34, "Output",ExpressionUUID->"32de460d-aa76-41bf-b8f5-0fb64698e21b"],
Cell[246218, 5633, 332, 6, 34, "Output",ExpressionUUID->"be64a8fa-d9e8-479a-83f7-7119a35a54e2"],
Cell[246553, 5641, 256, 4, 34, "Output",ExpressionUUID->"ea6089f3-8bef-4c80-ae84-59ca54bb4dbd"],
Cell[246812, 5647, 685, 18, 34, "Output",ExpressionUUID->"05ee64ef-b6b7-457f-a7c3-17cbe0cb6a1d"],
Cell[247500, 5667, 691, 18, 34, "Output",ExpressionUUID->"8c4bbfd1-befd-4d14-b63b-555a77c2fbcd"],
Cell[248194, 5687, 256, 4, 34, "Output",ExpressionUUID->"a31c2dde-2e59-4126-8ddd-7ea494be620f"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[248511, 5698, 202, 4, 72, "Title",ExpressionUUID->"42f75383-66ed-4961-a102-78009944226d"],
Cell[248716, 5704, 1729, 41, 215, "Input",ExpressionUUID->"108d6b6e-c497-40cf-8664-5610ffdeba77",
 InitializationCell->True],
Cell[250448, 5747, 2070, 47, 320, "Input",ExpressionUUID->"4a06b9d7-318e-4484-abbc-47cd5f35e0f2",
 InitializationCell->True],
Cell[252521, 5796, 1991, 44, 320, "Input",ExpressionUUID->"ab668816-d09a-476b-8fa8-077b20e21ec8",
 InitializationCell->True],
Cell[254515, 5842, 3581, 81, 509, "Input",ExpressionUUID->"9e65a4f7-c0fe-4e19-ae6e-6919744b62fb",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[258121, 5927, 151, 3, 67, "Section",ExpressionUUID->"16b0cae3-8e63-4cc9-9cd9-303c9a37e741"],
Cell[258275, 5932, 3266, 82, 530, "Input",ExpressionUUID->"8866315e-af8f-4589-a4db-30c989591f35",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[261566, 6018, 2349, 67, 346, "Input",ExpressionUUID->"8a5b8d9b-68ca-46e9-a3f1-34949facc035"],
Cell[263918, 6087, 278, 6, 34, "Output",ExpressionUUID->"6490fec2-cdb6-4e4d-816d-f926c101493d"],
Cell[264199, 6095, 284, 6, 34, "Output",ExpressionUUID->"f5ee5a4d-ec18-4ead-ab16-fd44728f4f28"],
Cell[264486, 6103, 208, 4, 34, "Output",ExpressionUUID->"ff5a8131-60c5-4d7d-a92b-e01629a0ed55"],
Cell[264697, 6109, 572, 15, 34, "Output",ExpressionUUID->"08dfcdd2-9731-4932-a78e-19030bb308cc"],
Cell[265272, 6126, 580, 15, 34, "Output",ExpressionUUID->"82be0e0a-0ed7-42a4-a58c-fb0bfd5f70e1"],
Cell[265855, 6143, 208, 4, 34, "Output",ExpressionUUID->"e2dffdb9-c22a-43fd-a2b3-0d8711122069"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[266124, 6154, 245, 4, 72, "Title",ExpressionUUID->"131d7ff7-98cc-4b34-94f8-aec9dac227ab"],
Cell[266372, 6160, 3111, 73, 257, "Input",ExpressionUUID->"7d75e48d-5c95-4ef6-a45c-f2c411223800",
 InitializationCell->True],
Cell[269486, 6235, 1589, 45, 110, "Input",ExpressionUUID->"9e5ef683-1eab-4a81-a919-674ff23bee7c",
 InitializationCell->True],
Cell[271078, 6282, 2403, 55, 362, "Input",ExpressionUUID->"d5662e30-11c2-40de-b6e8-853fb16f3fcd",
 InitializationCell->True],
Cell[273484, 6339, 2431, 55, 362, "Input",ExpressionUUID->"07ad98d9-c848-430d-81e7-c5511933e15b",
 InitializationCell->True],
Cell[275918, 6396, 2913, 65, 404, "Input",ExpressionUUID->"d1a35e2b-e044-45f6-9112-201694367147",
 InitializationCell->True],
Cell[278834, 6463, 2869, 62, 404, "Input",ExpressionUUID->"7b270728-7b0f-4e47-a8cd-76f128e8ee9a",
 InitializationCell->True],
Cell[281706, 6527, 5576, 121, 845, "Input",ExpressionUUID->"a7baa09f-8f69-4c0e-aad2-0ca9115dcc53",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[287319, 6653, 298, 5, 72, "Title",ExpressionUUID->"e5e7ae61-4c60-4e81-a713-91147b288f8f"],
Cell[287620, 6660, 2459, 54, 236, "Input",ExpressionUUID->"8b6655f6-1a47-4b6e-ba20-ced19af09950",
 InitializationCell->True],
Cell[290082, 6716, 1589, 45, 110, "Input",ExpressionUUID->"1304759c-7001-40c6-b130-22a466fa0147",
 InitializationCell->True],
Cell[291674, 6763, 2456, 56, 362, "Input",ExpressionUUID->"8a903149-4642-40b2-9434-d3bf7b87cd2b",
 InitializationCell->True],
Cell[294133, 6821, 2371, 52, 362, "Input",ExpressionUUID->"f7d6240f-3a77-4ecc-80ea-a2c49f7954c0",
 InitializationCell->True],
Cell[296507, 6875, 2474, 53, 362, "Input",ExpressionUUID->"06e79e30-f493-4d30-acee-2b19f2a34670",
 InitializationCell->True],
Cell[298984, 6930, 4940, 107, 740, "Input",ExpressionUUID->"fb8a877a-16aa-4c23-9514-5f9f0826f593",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[303961, 7042, 176, 3, 72, "Title",ExpressionUUID->"178faf1c-0ac2-49a8-94b0-14611eacc4dd"],
Cell[304140, 7047, 3745, 88, 425, "Input",ExpressionUUID->"7c1402f3-a929-47a5-b264-de2597d7b25a",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[307910, 7139, 149, 3, 67, "Section",ExpressionUUID->"f03fc260-7b30-4aa6-b4aa-714b38677994"],
Cell[308062, 7144, 1542, 35, 257, "Input",ExpressionUUID->"ccc9551b-6206-4375-932c-2a216f895d4b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[309629, 7183, 2244, 65, 262, "Input",ExpressionUUID->"e9489f8e-0ae2-4956-a070-ea18e701ccd9"],
Cell[311876, 7250, 1904, 44, 77, "Output",ExpressionUUID->"bdcac369-ba13-45ae-918f-350bb81fa676"],
Cell[313783, 7296, 1888, 43, 77, "Output",ExpressionUUID->"aceeec20-31dc-4e5e-a0b8-ae03c1ddbf70"],
Cell[315674, 7341, 257, 5, 34, "Output",ExpressionUUID->"42f4ebec-c252-478f-8166-948a0d33ff0c"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[315992, 7353, 180, 3, 72, "Title",ExpressionUUID->"e25058ae-c753-4a1b-9594-796ef13b9b97"],
Cell[316175, 7358, 4355, 100, 509, "Input",ExpressionUUID->"14a8915c-e374-4633-88f8-32f1ae650868",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[320555, 7462, 150, 3, 67, "Section",ExpressionUUID->"16363a14-7208-4304-90b3-3dd4e0854e8d"],
Cell[320708, 7467, 492, 11, 73, "Input",ExpressionUUID->"f4475bfb-7978-45cb-b142-8af779061fb9"],
Cell[321203, 7480, 175, 4, 30, "Input",ExpressionUUID->"dfa9f61b-a8ce-452f-8ffa-b7b84bd66ec0"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[321427, 7490, 179, 3, 72, "Title",ExpressionUUID->"31199eb2-30b4-4f5f-b57e-7408ae0ae079"],
Cell[321609, 7495, 1373, 33, 236, "Input",ExpressionUUID->"f6e3113f-af9b-4d05-9b6a-e7175168b9d7",
 InitializationCell->True],
Cell[322985, 7530, 7197, 161, 698, "Input",ExpressionUUID->"7cf64145-d658-4858-a529-49c39d07fdd8",
 InitializationCell->True],
Cell[330185, 7693, 280, 6, 30, "Input",ExpressionUUID->"d9fcec03-07db-46a2-a77a-3eb675b7290d"]
}, Closed]],
Cell[CellGroupData[{
Cell[330502, 7704, 172, 3, 72, "Title",ExpressionUUID->"bb547e74-d166-4564-93f4-e6628f3a91dd"],
Cell[330677, 7709, 4299, 96, 446, "Input",ExpressionUUID->"5841f285-3080-4ef1-8e11-652fe0a21fb4",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[335001, 7809, 149, 3, 67, "Section",ExpressionUUID->"8dccf02d-0f17-4355-9331-8d93182f1320"],
Cell[335153, 7814, 4070, 98, 471, "Input",ExpressionUUID->"6edff6a5-6791-4af3-b9ed-d8c2d884a2a3",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[339248, 7916, 6277, 174, 808, "Input",ExpressionUUID->"32aa8ae1-8c41-40ac-b178-ad7ff84661b5"],
Cell[345528, 8092, 1296, 36, 60, "Output",ExpressionUUID->"985f7af6-7721-449a-b3f6-58f4b59e8583"],
Cell[346827, 8130, 902, 24, 37, "Output",ExpressionUUID->"6696e7fc-0b7b-4e89-83ff-b8a0d224d168"],
Cell[347732, 8156, 179, 3, 34, "Output",ExpressionUUID->"f941614d-6464-4f2b-8594-aa13064dd2f5"]
}, Open  ]],
Cell[347926, 8162, 402, 8, 30, "Input",ExpressionUUID->"d612051a-c0dd-4807-ba4b-b9b56606eb3a"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[348377, 8176, 221, 4, 72, "Title",ExpressionUUID->"2b5c0ae5-9a25-49d7-bab4-530c7ebb452e"],
Cell[348601, 8182, 7185, 165, 740, "Input",ExpressionUUID->"2f61d3be-008b-4fc5-9873-db08138b0481",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[355811, 8351, 149, 3, 67, "Section",ExpressionUUID->"74ce8ff1-fd59-4ede-ab84-d7ab00c5457d"],
Cell[355963, 8356, 510, 11, 73, "Input",ExpressionUUID->"134e6634-9a76-40f7-82e0-fb2f47e0da82"],
Cell[356476, 8369, 243, 5, 30, "Input",ExpressionUUID->"7f22c180-d36b-43c5-a052-25141eb7c3cd"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[356768, 8380, 147, 3, 72, "Title",ExpressionUUID->"75c1fcef-1813-4085-8502-bba2286b70fb"],
Cell[356918, 8385, 9659, 211, 1454, "Input",ExpressionUUID->"72575f29-5d55-4420-b812-1b2d85d139ce",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[366602, 8600, 148, 3, 67, "Section",ExpressionUUID->"f5dd0ba6-ceba-4982-8f86-5beaf01b3ed4"],
Cell[CellGroupData[{
Cell[366775, 8607, 2902, 86, 451, "Input",ExpressionUUID->"f975c66e-37aa-4e47-abb1-e981277aa6ec"],
Cell[369680, 8695, 1216, 31, 56, "Output",ExpressionUUID->"86ac4d25-eaf5-471e-abbd-afc68af33596"],
Cell[370899, 8728, 278, 5, 34, "Output",ExpressionUUID->"466ac483-a7da-4535-8ba9-8d4e26d39a12"],
Cell[371180, 8735, 277, 5, 34, "Output",ExpressionUUID->"968e57d7-ca7d-4312-a4be-ba200ab008cb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[371494, 8745, 1261, 29, 157, "Input",ExpressionUUID->"13dead12-4a1e-416c-9bea-e56414428bd8"],
Cell[372758, 8776, 1391, 35, 60, "Output",ExpressionUUID->"90312b00-e226-4e33-9478-05013fc69c7c"],
Cell[374152, 8813, 320, 5, 34, "Output",ExpressionUUID->"031e670c-c44b-4548-b158-684bdbb6886c"]
}, Open  ]],
Cell[374487, 8821, 1028, 23, 173, "Input",ExpressionUUID->"aea80708-cd03-42bd-ba41-6f69eced8442",
 InitializationCell->True],
Cell[375518, 8846, 4102, 90, 540, "Input",ExpressionUUID->"e3edd804-3c66-4550-8d26-6b154296d02a",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[379645, 8940, 1447, 30, 115, "Input",ExpressionUUID->"0a8e73e6-57f3-4b84-b586-5e8aab091a5f"],
Cell[381095, 8972, 1458, 30, 37, "Output",ExpressionUUID->"c1518141-77a4-4efb-b980-04280d524e5e"],
Cell[CellGroupData[{
Cell[382578, 9006, 1198, 33, 26, "Print",ExpressionUUID->"fe5128b8-4405-4ab9-85ea-b2223ae3ba8a"],
Cell[383779, 9041, 876, 23, 26, "Print",ExpressionUUID->"84660aa3-e55d-44b2-bcbd-53bec30779e0"]
}, Open  ]],
Cell[384670, 9067, 810, 12, 34, "Output",ExpressionUUID->"c4e29255-561a-48c3-b7d0-abf11030203f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[385517, 9084, 1278, 29, 115, "Input",ExpressionUUID->"7c8a5487-8e9d-4149-9cc3-07d93af22a38"],
Cell[CellGroupData[{
Cell[386820, 9117, 1058, 29, 26, "Print",ExpressionUUID->"b71d52df-d069-4e31-9862-3289cbcbb35f"],
Cell[387881, 9148, 749, 19, 26, "Print",ExpressionUUID->"c9574065-0480-4898-b26d-c2e396f31917"]
}, Open  ]],
Cell[388645, 9170, 375, 6, 34, "Output",ExpressionUUID->"a2e85ed2-e7da-4514-94da-bf9231316de8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[389057, 9181, 1137, 27, 115, "Input",ExpressionUUID->"ee297440-6eb3-4e26-bd63-ca7a21275eb0"],
Cell[CellGroupData[{
Cell[390219, 9212, 1140, 35, 26, "Print",ExpressionUUID->"eda6a64f-c851-4019-b585-fd0a72f4079b"],
Cell[391362, 9249, 826, 24, 26, "Print",ExpressionUUID->"f4af52b0-06c4-400c-8daf-8989be4e525f"]
}, Open  ]],
Cell[392203, 9276, 278, 5, 34, "Output",ExpressionUUID->"fe5302c9-dc06-4701-a211-a0aa0a27cf7e"]
}, Open  ]],
Cell[392496, 9284, 507, 10, 52, "Input",ExpressionUUID->"53945ad6-6995-4ca3-850a-67c73d32a127"]
}, Open  ]],
Cell[CellGroupData[{
Cell[393040, 9299, 160, 3, 69, "Chapter",ExpressionUUID->"54ac089f-a600-476d-9ce4-7ad6776bcabd"],
Cell[393203, 9304, 834, 18, 152, "Input",ExpressionUUID->"7291f700-9d87-42cd-8c4c-cd5ad9cb1538",
 InitializationCell->True],
Cell[394040, 9324, 1233, 29, 152, "Input",ExpressionUUID->"4505359f-8d53-423a-b444-003220688794",
 InitializationCell->True],
Cell[395276, 9355, 2581, 55, 404, "Input",ExpressionUUID->"01d9586b-2ca0-453e-8019-fd5622a5a67b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[397882, 9414, 151, 3, 67, "Section",ExpressionUUID->"43816a05-c782-4619-aa7a-1ffe6d1c5097"],
Cell[398036, 9419, 634, 15, 73, "Input",ExpressionUUID->"ccb1df33-787b-4c80-bed6-c5ba040009f3"],
Cell[398673, 9436, 241, 5, 30, "Input",ExpressionUUID->"fb4f7a2c-9480-43ca-beba-c30143ac1953"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[398975, 9448, 217, 4, 72, "Title",ExpressionUUID->"365eb2a4-c2ef-4c3f-9202-fa061a5b00a3"],
Cell[399195, 9454, 466, 10, 68, "Input",ExpressionUUID->"9c286fac-fee4-4aa7-9840-dc12e032e358",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[399698, 9469, 164, 3, 72, "Title",ExpressionUUID->"e9f5b843-b032-4204-8f80-f0079616cd07"],
Cell[399865, 9474, 5712, 119, 761, "Input",ExpressionUUID->"d575d9ea-7910-41a1-8e6c-80fbc2946d3b",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[405602, 9597, 151, 3, 67, "Section",ExpressionUUID->"b59fef07-4110-4a70-af17-ee434f836542"],
Cell[CellGroupData[{
Cell[405778, 9604, 2096, 47, 346, "Input",ExpressionUUID->"3df4e0f6-53f9-4529-b7ca-67dbe37335e5"],
Cell[407877, 9653, 401, 6, 34, "Output",ExpressionUUID->"165b0144-3469-42cf-a256-f1d8367c1850"],
Cell[408281, 9661, 1347, 33, 60, "Output",ExpressionUUID->"71dd130c-7fec-465c-b74c-21bb179efe10"],
Cell[409631, 9696, 2629, 68, 101, "Output",ExpressionUUID->"08c7f5eb-1743-4911-b915-2281c5dd95eb"],
Cell[412263, 9766, 400, 6, 34, "Output",ExpressionUUID->"47f5b596-819b-4924-934d-9de3137c066f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[412700, 9777, 2096, 52, 304, "Input",ExpressionUUID->"7c8cd943-584a-4c2f-832d-0815b213fef4"],
Cell[414799, 9831, 643, 15, 34, "Output",ExpressionUUID->"8ae3957a-4d6d-4c7d-830a-c253ac75dde8"]
}, Open  ]],
Cell[415457, 9849, 414, 8, 30, "Input",ExpressionUUID->"d6a71509-edf0-4abd-b9fd-f1d7a6399b95"]
}, Open  ]]
}, Closed]]
}
]
*)

